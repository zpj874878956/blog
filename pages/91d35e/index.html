<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>centos7安装kvm虚拟机 | 章工运维</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <script language="javascript" type="text/javascript" src="/js/pgmanor-self.js"></script>
    <link rel="alternate" type="application/rss+xml" href="https://blog.zzppjj.top/rss.xml" title="章工运维 RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.zzppjj.top/feed.atom" title="章工运维 Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.zzppjj.top/feed.json" title="章工运维 JSON Feed">
    <meta name="description" content="业精于勤，荒于嬉">
    <meta name="twitter:title" content="centos7安装kvm虚拟机">
    <meta name="twitter:description" content="">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:url" content="https://blog.zzppjj.top/04.%E8%BF%90%E7%BB%B4/09.%E7%B3%BB%E7%BB%9F/13.kvm/01.centos7%E5%AE%89%E8%A3%85kvm%E8%99%9A%E6%8B%9F%E6%9C%BA.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="centos7安装kvm虚拟机">
    <meta property="og:description" content="">
    <meta property="og:url" content="https://blog.zzppjj.top/04.%E8%BF%90%E7%BB%B4/09.%E7%B3%BB%E7%BB%9F/13.kvm/01.centos7%E5%AE%89%E8%A3%85kvm%E8%99%9A%E6%8B%9F%E6%9C%BA.html">
    <meta property="og:site_name" content="zpj">
    <meta property="article:published_time" content="2023-08-20T12:12:13.000Z">
    <meta property="article:tag" content="null">
    <meta itemprop="name" content="centos7安装kvm虚拟机">
    <meta itemprop="description" content="">
    <meta name="keywords" content="分享生活,分享技术,zpj,jenkins,ansible,k8s,监控">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/assets/css/0.styles.2357ed77.css" as="style"><link rel="preload" href="/assets/js/app.73676f20.js" as="script"><link rel="preload" href="/assets/js/4.23144ec8.js" as="script"><link rel="preload" href="/assets/js/1.09d67b9a.js" as="script"><link rel="preload" href="/assets/js/3.fc5194e0.js" as="script"><link rel="preload" href="/assets/js/320.a5c03bfc.js" as="script"><link rel="preload" href="/assets/js/38.33c96ce4.js" as="script"><link rel="preload" href="/assets/js/21.2c073392.js" as="script"><link rel="prefetch" href="/assets/js/10.a3e162c2.js"><link rel="prefetch" href="/assets/js/100.75d0bcb8.js"><link rel="prefetch" href="/assets/js/101.ecd83997.js"><link rel="prefetch" href="/assets/js/102.ecfd6207.js"><link rel="prefetch" href="/assets/js/103.332844d2.js"><link rel="prefetch" href="/assets/js/104.db0bde22.js"><link rel="prefetch" href="/assets/js/105.cbd4753c.js"><link rel="prefetch" href="/assets/js/106.7a5d313e.js"><link rel="prefetch" href="/assets/js/107.f3dec78b.js"><link rel="prefetch" href="/assets/js/108.52a0f936.js"><link rel="prefetch" href="/assets/js/109.27477c80.js"><link rel="prefetch" href="/assets/js/11.1f9a8151.js"><link rel="prefetch" href="/assets/js/110.bebbe66e.js"><link rel="prefetch" href="/assets/js/111.42ef7c19.js"><link rel="prefetch" href="/assets/js/112.6fe9d090.js"><link rel="prefetch" href="/assets/js/113.c9a86711.js"><link rel="prefetch" href="/assets/js/114.3503a4c3.js"><link rel="prefetch" href="/assets/js/115.14ffeec7.js"><link rel="prefetch" href="/assets/js/116.e4425551.js"><link rel="prefetch" href="/assets/js/117.bc8fd7d3.js"><link rel="prefetch" href="/assets/js/118.ca53cac0.js"><link rel="prefetch" href="/assets/js/119.b7d83b66.js"><link rel="prefetch" href="/assets/js/12.ff601b7f.js"><link rel="prefetch" href="/assets/js/120.87624e26.js"><link rel="prefetch" href="/assets/js/121.1cbece42.js"><link rel="prefetch" href="/assets/js/122.fca02497.js"><link rel="prefetch" href="/assets/js/123.20f89d6e.js"><link rel="prefetch" href="/assets/js/124.5d36a6d6.js"><link rel="prefetch" href="/assets/js/125.011309fb.js"><link rel="prefetch" href="/assets/js/126.b4637b65.js"><link rel="prefetch" href="/assets/js/127.9042b697.js"><link rel="prefetch" href="/assets/js/128.472aa291.js"><link rel="prefetch" href="/assets/js/129.c208b435.js"><link rel="prefetch" href="/assets/js/13.e19f2a21.js"><link rel="prefetch" href="/assets/js/130.de5f9c8d.js"><link rel="prefetch" href="/assets/js/131.1da85aa7.js"><link rel="prefetch" href="/assets/js/132.542a0148.js"><link rel="prefetch" href="/assets/js/133.2a6f2a0a.js"><link rel="prefetch" href="/assets/js/134.d5fa07b6.js"><link rel="prefetch" href="/assets/js/135.75648017.js"><link rel="prefetch" href="/assets/js/136.a9384568.js"><link rel="prefetch" href="/assets/js/137.f5552d23.js"><link rel="prefetch" href="/assets/js/138.eda82db2.js"><link rel="prefetch" href="/assets/js/139.be711e4c.js"><link rel="prefetch" href="/assets/js/14.a223b1b9.js"><link rel="prefetch" href="/assets/js/140.708a3fbc.js"><link rel="prefetch" href="/assets/js/141.b0b86d18.js"><link rel="prefetch" href="/assets/js/142.55bb66aa.js"><link rel="prefetch" href="/assets/js/143.2b9a4434.js"><link rel="prefetch" href="/assets/js/144.b65e75b4.js"><link rel="prefetch" href="/assets/js/145.e1c6fca8.js"><link rel="prefetch" href="/assets/js/146.d7352f00.js"><link rel="prefetch" href="/assets/js/147.e73840d8.js"><link rel="prefetch" href="/assets/js/148.e4f50f91.js"><link rel="prefetch" href="/assets/js/149.3374e168.js"><link rel="prefetch" href="/assets/js/15.403e911f.js"><link rel="prefetch" href="/assets/js/150.1b638875.js"><link rel="prefetch" href="/assets/js/151.ab5d0425.js"><link rel="prefetch" href="/assets/js/152.23993ff3.js"><link rel="prefetch" href="/assets/js/153.d1668a0e.js"><link rel="prefetch" href="/assets/js/154.4b749d4b.js"><link rel="prefetch" href="/assets/js/155.26c4c260.js"><link rel="prefetch" href="/assets/js/156.c8e6b701.js"><link rel="prefetch" href="/assets/js/157.373856e9.js"><link rel="prefetch" href="/assets/js/158.66344055.js"><link rel="prefetch" href="/assets/js/159.a69fd44e.js"><link rel="prefetch" href="/assets/js/16.6eb3aab7.js"><link rel="prefetch" href="/assets/js/160.eb9992c2.js"><link rel="prefetch" href="/assets/js/161.c5b7c124.js"><link rel="prefetch" href="/assets/js/162.c03e3856.js"><link rel="prefetch" href="/assets/js/163.72619e7f.js"><link rel="prefetch" href="/assets/js/164.5e15702b.js"><link rel="prefetch" href="/assets/js/165.33c3df23.js"><link rel="prefetch" href="/assets/js/166.4a808932.js"><link rel="prefetch" href="/assets/js/167.1a771a9e.js"><link rel="prefetch" href="/assets/js/168.807fafc8.js"><link rel="prefetch" href="/assets/js/169.44315b3f.js"><link rel="prefetch" href="/assets/js/17.bbb7c9f2.js"><link rel="prefetch" href="/assets/js/170.5c0c8eb9.js"><link rel="prefetch" href="/assets/js/171.1cbb4415.js"><link rel="prefetch" href="/assets/js/172.735a4c1a.js"><link rel="prefetch" href="/assets/js/173.86f02e67.js"><link rel="prefetch" href="/assets/js/174.4993a291.js"><link rel="prefetch" href="/assets/js/175.195bd521.js"><link rel="prefetch" href="/assets/js/176.751bd9c0.js"><link rel="prefetch" href="/assets/js/177.d1974b60.js"><link rel="prefetch" href="/assets/js/178.fc5d303d.js"><link rel="prefetch" href="/assets/js/179.9975997c.js"><link rel="prefetch" href="/assets/js/18.fca5fd29.js"><link rel="prefetch" href="/assets/js/180.f94992e7.js"><link rel="prefetch" href="/assets/js/181.340cf666.js"><link rel="prefetch" href="/assets/js/182.417bc80c.js"><link rel="prefetch" href="/assets/js/183.632e104d.js"><link rel="prefetch" href="/assets/js/184.c8ef5d1a.js"><link rel="prefetch" href="/assets/js/185.296e5bbb.js"><link rel="prefetch" href="/assets/js/186.000557d1.js"><link rel="prefetch" href="/assets/js/187.197aff5f.js"><link rel="prefetch" href="/assets/js/188.ecae5f09.js"><link rel="prefetch" href="/assets/js/189.ebfded89.js"><link rel="prefetch" href="/assets/js/19.8792dbf3.js"><link rel="prefetch" href="/assets/js/190.a710d6b1.js"><link rel="prefetch" href="/assets/js/191.a84f2ed3.js"><link rel="prefetch" href="/assets/js/192.c203907e.js"><link rel="prefetch" href="/assets/js/193.852373e5.js"><link rel="prefetch" href="/assets/js/194.db2975db.js"><link rel="prefetch" href="/assets/js/195.6c7373e8.js"><link rel="prefetch" href="/assets/js/196.45d29e92.js"><link rel="prefetch" href="/assets/js/197.ee208995.js"><link rel="prefetch" href="/assets/js/198.76c918d3.js"><link rel="prefetch" href="/assets/js/199.f05f7bdc.js"><link rel="prefetch" href="/assets/js/2.3389b8bc.js"><link rel="prefetch" href="/assets/js/20.15ba8d27.js"><link rel="prefetch" href="/assets/js/200.bf07e380.js"><link rel="prefetch" href="/assets/js/201.35bb3033.js"><link rel="prefetch" href="/assets/js/202.e14ce853.js"><link rel="prefetch" href="/assets/js/203.7f07fe7f.js"><link rel="prefetch" href="/assets/js/204.95ffddd8.js"><link rel="prefetch" href="/assets/js/205.f487b7d0.js"><link rel="prefetch" href="/assets/js/206.2b3e5a91.js"><link rel="prefetch" href="/assets/js/207.7886e90d.js"><link rel="prefetch" href="/assets/js/208.98c314e0.js"><link rel="prefetch" href="/assets/js/209.9d37ba2d.js"><link rel="prefetch" href="/assets/js/210.6e7d41e6.js"><link rel="prefetch" href="/assets/js/211.0344832b.js"><link rel="prefetch" href="/assets/js/212.8e2c9c7f.js"><link rel="prefetch" href="/assets/js/213.84efa494.js"><link rel="prefetch" href="/assets/js/214.fdcd5348.js"><link rel="prefetch" href="/assets/js/215.190febcd.js"><link rel="prefetch" href="/assets/js/216.1b0ecbf6.js"><link rel="prefetch" href="/assets/js/217.94e4a648.js"><link rel="prefetch" href="/assets/js/218.15bb6f17.js"><link rel="prefetch" href="/assets/js/219.4d86a677.js"><link rel="prefetch" href="/assets/js/22.797a9a59.js"><link rel="prefetch" href="/assets/js/220.b30cd93b.js"><link rel="prefetch" href="/assets/js/221.dc967206.js"><link rel="prefetch" href="/assets/js/222.5424cc4c.js"><link rel="prefetch" href="/assets/js/223.d35ee4d9.js"><link rel="prefetch" href="/assets/js/224.97fc8dca.js"><link rel="prefetch" href="/assets/js/225.d1d60d3d.js"><link rel="prefetch" href="/assets/js/226.71cd887d.js"><link rel="prefetch" href="/assets/js/227.7cc9c57c.js"><link rel="prefetch" href="/assets/js/228.6381caa6.js"><link rel="prefetch" href="/assets/js/229.560474e6.js"><link rel="prefetch" href="/assets/js/23.30bb92f4.js"><link rel="prefetch" href="/assets/js/230.49126632.js"><link rel="prefetch" href="/assets/js/231.591150fc.js"><link rel="prefetch" href="/assets/js/232.60ba75d5.js"><link rel="prefetch" href="/assets/js/233.0ed6ef0d.js"><link rel="prefetch" href="/assets/js/234.7d2aa21f.js"><link rel="prefetch" href="/assets/js/235.0d13696d.js"><link rel="prefetch" href="/assets/js/236.3fef4d3c.js"><link rel="prefetch" href="/assets/js/237.95e3cf9c.js"><link rel="prefetch" href="/assets/js/238.0993135b.js"><link rel="prefetch" href="/assets/js/239.27177392.js"><link rel="prefetch" href="/assets/js/24.7240c649.js"><link rel="prefetch" href="/assets/js/240.23100c38.js"><link rel="prefetch" href="/assets/js/241.805a6f9f.js"><link rel="prefetch" href="/assets/js/242.8d15a365.js"><link rel="prefetch" href="/assets/js/243.e69346ee.js"><link rel="prefetch" href="/assets/js/244.8c1aa986.js"><link rel="prefetch" href="/assets/js/245.6f55369d.js"><link rel="prefetch" href="/assets/js/246.10a3da46.js"><link rel="prefetch" href="/assets/js/247.65f2f428.js"><link rel="prefetch" href="/assets/js/248.49375e99.js"><link rel="prefetch" href="/assets/js/249.1e9d53e7.js"><link rel="prefetch" href="/assets/js/25.9b40180a.js"><link rel="prefetch" href="/assets/js/250.01f8cd00.js"><link rel="prefetch" href="/assets/js/251.ff9464cb.js"><link rel="prefetch" href="/assets/js/252.f89f8487.js"><link rel="prefetch" href="/assets/js/253.e3891186.js"><link rel="prefetch" href="/assets/js/254.9012046f.js"><link rel="prefetch" href="/assets/js/255.fde63767.js"><link rel="prefetch" href="/assets/js/256.4888bec3.js"><link rel="prefetch" href="/assets/js/257.22289df7.js"><link rel="prefetch" href="/assets/js/258.f5e12a6c.js"><link rel="prefetch" href="/assets/js/259.f227bf91.js"><link rel="prefetch" href="/assets/js/26.5fef45bc.js"><link rel="prefetch" href="/assets/js/260.7c204404.js"><link rel="prefetch" href="/assets/js/261.29e85166.js"><link rel="prefetch" href="/assets/js/262.2c9def6c.js"><link rel="prefetch" href="/assets/js/263.98afd182.js"><link rel="prefetch" href="/assets/js/264.20a44127.js"><link rel="prefetch" href="/assets/js/265.deaca7c2.js"><link rel="prefetch" href="/assets/js/266.4d0f5c1e.js"><link rel="prefetch" href="/assets/js/267.30b05762.js"><link rel="prefetch" href="/assets/js/268.2238b76d.js"><link rel="prefetch" href="/assets/js/269.9bc35400.js"><link rel="prefetch" href="/assets/js/27.83995618.js"><link rel="prefetch" href="/assets/js/270.2cf931ea.js"><link rel="prefetch" href="/assets/js/271.33bb2a38.js"><link rel="prefetch" href="/assets/js/272.5ea99ff5.js"><link rel="prefetch" href="/assets/js/273.b6aeae60.js"><link rel="prefetch" href="/assets/js/274.02c41281.js"><link rel="prefetch" href="/assets/js/275.c03bf74d.js"><link rel="prefetch" href="/assets/js/276.8bb13531.js"><link rel="prefetch" href="/assets/js/277.e835c526.js"><link rel="prefetch" href="/assets/js/278.8db0ac89.js"><link rel="prefetch" href="/assets/js/279.b01f6f0b.js"><link rel="prefetch" href="/assets/js/28.5539ac79.js"><link rel="prefetch" href="/assets/js/280.58bf36ea.js"><link rel="prefetch" href="/assets/js/281.b093e33b.js"><link rel="prefetch" href="/assets/js/282.0afb811a.js"><link rel="prefetch" href="/assets/js/283.57d16abf.js"><link rel="prefetch" href="/assets/js/284.fed63bdb.js"><link rel="prefetch" href="/assets/js/285.3e281284.js"><link rel="prefetch" href="/assets/js/286.5fd82441.js"><link rel="prefetch" href="/assets/js/287.576684d7.js"><link rel="prefetch" href="/assets/js/288.5e1ddc82.js"><link rel="prefetch" href="/assets/js/289.c9665bb4.js"><link rel="prefetch" href="/assets/js/29.b7aeafd2.js"><link rel="prefetch" href="/assets/js/290.fea19ce6.js"><link rel="prefetch" href="/assets/js/291.7d306a45.js"><link rel="prefetch" href="/assets/js/292.d16a085d.js"><link rel="prefetch" href="/assets/js/293.a2ba2f0f.js"><link rel="prefetch" href="/assets/js/294.d855cbd9.js"><link rel="prefetch" href="/assets/js/295.0100374c.js"><link rel="prefetch" href="/assets/js/296.7be2d9ee.js"><link rel="prefetch" href="/assets/js/297.a4c0465d.js"><link rel="prefetch" href="/assets/js/298.1db5d5c2.js"><link rel="prefetch" href="/assets/js/299.38d8457c.js"><link rel="prefetch" href="/assets/js/30.fc6b86f2.js"><link rel="prefetch" href="/assets/js/300.1ba015d8.js"><link rel="prefetch" href="/assets/js/301.35b2e6ba.js"><link rel="prefetch" href="/assets/js/302.429cb0ec.js"><link rel="prefetch" href="/assets/js/303.8c006780.js"><link rel="prefetch" href="/assets/js/304.ca3d5644.js"><link rel="prefetch" href="/assets/js/305.84329278.js"><link rel="prefetch" href="/assets/js/306.45b281a2.js"><link rel="prefetch" href="/assets/js/307.be05fe98.js"><link rel="prefetch" href="/assets/js/308.80655fac.js"><link rel="prefetch" href="/assets/js/309.d0bca0f4.js"><link rel="prefetch" href="/assets/js/31.4b15d755.js"><link rel="prefetch" href="/assets/js/310.9674b6bd.js"><link rel="prefetch" href="/assets/js/311.6804abea.js"><link rel="prefetch" href="/assets/js/312.ab5a2f8b.js"><link rel="prefetch" href="/assets/js/313.b2fea146.js"><link rel="prefetch" href="/assets/js/314.a4369eb5.js"><link rel="prefetch" href="/assets/js/315.b3b11ac9.js"><link rel="prefetch" href="/assets/js/316.8785a926.js"><link rel="prefetch" href="/assets/js/317.a6abd001.js"><link rel="prefetch" href="/assets/js/318.5089ee03.js"><link rel="prefetch" href="/assets/js/319.fa74b2cc.js"><link rel="prefetch" href="/assets/js/32.d80ffae2.js"><link rel="prefetch" href="/assets/js/321.5e4dcfe8.js"><link rel="prefetch" href="/assets/js/322.23c23832.js"><link rel="prefetch" href="/assets/js/323.4ac1fe2e.js"><link rel="prefetch" href="/assets/js/324.301c9e00.js"><link rel="prefetch" href="/assets/js/325.82fff4a0.js"><link rel="prefetch" href="/assets/js/326.d653ce14.js"><link rel="prefetch" href="/assets/js/327.9d4e295a.js"><link rel="prefetch" href="/assets/js/328.aff8c1bd.js"><link rel="prefetch" href="/assets/js/329.dce67ef0.js"><link rel="prefetch" href="/assets/js/33.0a4b28c8.js"><link rel="prefetch" href="/assets/js/330.8ee58260.js"><link rel="prefetch" href="/assets/js/331.766ca988.js"><link rel="prefetch" href="/assets/js/332.2cef316c.js"><link rel="prefetch" href="/assets/js/333.5c1e99cd.js"><link rel="prefetch" href="/assets/js/334.8ef63e12.js"><link rel="prefetch" href="/assets/js/335.2a615cdf.js"><link rel="prefetch" href="/assets/js/336.b255636f.js"><link rel="prefetch" href="/assets/js/337.aeddf147.js"><link rel="prefetch" href="/assets/js/338.cf24395e.js"><link rel="prefetch" href="/assets/js/339.ae7ee883.js"><link rel="prefetch" href="/assets/js/34.bb8cbe99.js"><link rel="prefetch" href="/assets/js/340.f5e5e10b.js"><link rel="prefetch" href="/assets/js/341.60065767.js"><link rel="prefetch" href="/assets/js/342.880f2c51.js"><link rel="prefetch" href="/assets/js/343.47928836.js"><link rel="prefetch" href="/assets/js/344.317ead2b.js"><link rel="prefetch" href="/assets/js/345.a922de9a.js"><link rel="prefetch" href="/assets/js/346.b0e6bbb0.js"><link rel="prefetch" href="/assets/js/347.23210924.js"><link rel="prefetch" href="/assets/js/348.4cbe7dfd.js"><link rel="prefetch" href="/assets/js/349.bc36d23d.js"><link rel="prefetch" href="/assets/js/35.13e5c204.js"><link rel="prefetch" href="/assets/js/350.78ff49df.js"><link rel="prefetch" href="/assets/js/351.98baa8d7.js"><link rel="prefetch" href="/assets/js/352.dafe3072.js"><link rel="prefetch" href="/assets/js/353.3a6adbb4.js"><link rel="prefetch" href="/assets/js/354.00d0f928.js"><link rel="prefetch" href="/assets/js/355.934b4c3e.js"><link rel="prefetch" href="/assets/js/356.67857703.js"><link rel="prefetch" href="/assets/js/357.8ab62a9b.js"><link rel="prefetch" href="/assets/js/358.e06b5e02.js"><link rel="prefetch" href="/assets/js/359.5ca9d976.js"><link rel="prefetch" href="/assets/js/36.3ae18163.js"><link rel="prefetch" href="/assets/js/360.38cf065b.js"><link rel="prefetch" href="/assets/js/361.84c5e0ca.js"><link rel="prefetch" href="/assets/js/362.dbf28682.js"><link rel="prefetch" href="/assets/js/363.9d7bac1a.js"><link rel="prefetch" href="/assets/js/364.6f9aaa6c.js"><link rel="prefetch" href="/assets/js/365.76e0b937.js"><link rel="prefetch" href="/assets/js/366.958065e0.js"><link rel="prefetch" href="/assets/js/367.62fe05e9.js"><link rel="prefetch" href="/assets/js/368.52e42cf5.js"><link rel="prefetch" href="/assets/js/369.be5a8e9d.js"><link rel="prefetch" href="/assets/js/37.efb2744c.js"><link rel="prefetch" href="/assets/js/370.4926d8c5.js"><link rel="prefetch" href="/assets/js/371.2aadb305.js"><link rel="prefetch" href="/assets/js/372.dcb47317.js"><link rel="prefetch" href="/assets/js/373.99d87a09.js"><link rel="prefetch" href="/assets/js/374.1d37ebf9.js"><link rel="prefetch" href="/assets/js/375.040f7228.js"><link rel="prefetch" href="/assets/js/376.4e06867e.js"><link rel="prefetch" href="/assets/js/377.27d9e275.js"><link rel="prefetch" href="/assets/js/378.8d3c34d7.js"><link rel="prefetch" href="/assets/js/379.67dba2a0.js"><link rel="prefetch" href="/assets/js/380.c1836db3.js"><link rel="prefetch" href="/assets/js/381.3497ba24.js"><link rel="prefetch" href="/assets/js/382.d041ea4d.js"><link rel="prefetch" href="/assets/js/39.031f1004.js"><link rel="prefetch" href="/assets/js/40.7376f5a0.js"><link rel="prefetch" href="/assets/js/41.d0e792da.js"><link rel="prefetch" href="/assets/js/42.246f9e60.js"><link rel="prefetch" href="/assets/js/43.95799058.js"><link rel="prefetch" href="/assets/js/44.ad27a9ff.js"><link rel="prefetch" href="/assets/js/45.0b4092a6.js"><link rel="prefetch" href="/assets/js/46.0012a2ef.js"><link rel="prefetch" href="/assets/js/47.e4b364de.js"><link rel="prefetch" href="/assets/js/48.40886536.js"><link rel="prefetch" href="/assets/js/49.cb7bc92d.js"><link rel="prefetch" href="/assets/js/5.d7fd577a.js"><link rel="prefetch" href="/assets/js/50.6c993145.js"><link rel="prefetch" href="/assets/js/51.fd053414.js"><link rel="prefetch" href="/assets/js/52.3dd8f9c6.js"><link rel="prefetch" href="/assets/js/53.81b89f42.js"><link rel="prefetch" href="/assets/js/54.a7a1880d.js"><link rel="prefetch" href="/assets/js/55.4cf210c4.js"><link rel="prefetch" href="/assets/js/56.c0ed7408.js"><link rel="prefetch" href="/assets/js/57.2a7659d5.js"><link rel="prefetch" href="/assets/js/58.c322ef28.js"><link rel="prefetch" href="/assets/js/59.4544e7b8.js"><link rel="prefetch" href="/assets/js/6.45776bb3.js"><link rel="prefetch" href="/assets/js/60.919fca3f.js"><link rel="prefetch" href="/assets/js/61.faddc5df.js"><link rel="prefetch" href="/assets/js/62.29428be6.js"><link rel="prefetch" href="/assets/js/63.f496aeee.js"><link rel="prefetch" href="/assets/js/64.d6826e8b.js"><link rel="prefetch" href="/assets/js/65.b4163fb2.js"><link rel="prefetch" href="/assets/js/66.58d152d7.js"><link rel="prefetch" href="/assets/js/67.a6dac763.js"><link rel="prefetch" href="/assets/js/68.90c252f7.js"><link rel="prefetch" href="/assets/js/69.d041ba69.js"><link rel="prefetch" href="/assets/js/7.831c92c6.js"><link rel="prefetch" href="/assets/js/70.b1b69cc5.js"><link rel="prefetch" href="/assets/js/71.b99b548a.js"><link rel="prefetch" href="/assets/js/72.b6cd4d2e.js"><link rel="prefetch" href="/assets/js/73.615eba63.js"><link rel="prefetch" href="/assets/js/74.444d9de5.js"><link rel="prefetch" href="/assets/js/75.ffd9da23.js"><link rel="prefetch" href="/assets/js/76.84d4fa46.js"><link rel="prefetch" href="/assets/js/77.eedc1376.js"><link rel="prefetch" href="/assets/js/78.7095885b.js"><link rel="prefetch" href="/assets/js/79.48c95cb9.js"><link rel="prefetch" href="/assets/js/80.8f42ea9f.js"><link rel="prefetch" href="/assets/js/81.521ca7da.js"><link rel="prefetch" href="/assets/js/82.ecb175b7.js"><link rel="prefetch" href="/assets/js/83.e121013d.js"><link rel="prefetch" href="/assets/js/84.1c1a3c28.js"><link rel="prefetch" href="/assets/js/85.7e914dee.js"><link rel="prefetch" href="/assets/js/86.9585ccde.js"><link rel="prefetch" href="/assets/js/87.36363a25.js"><link rel="prefetch" href="/assets/js/88.db15b19f.js"><link rel="prefetch" href="/assets/js/89.20df314c.js"><link rel="prefetch" href="/assets/js/90.8df91573.js"><link rel="prefetch" href="/assets/js/91.5a7d83c5.js"><link rel="prefetch" href="/assets/js/92.9b428b1a.js"><link rel="prefetch" href="/assets/js/93.c50f82ea.js"><link rel="prefetch" href="/assets/js/94.6813fd20.js"><link rel="prefetch" href="/assets/js/95.942ec555.js"><link rel="prefetch" href="/assets/js/96.53a215ae.js"><link rel="prefetch" href="/assets/js/97.0c2c5e6a.js"><link rel="prefetch" href="/assets/js/98.88fccd9a.js"><link rel="prefetch" href="/assets/js/99.a61ea740.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.26b542fc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2357ed77.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="http://pic.zzppjj.top/LightPicture/2023/03/c818c3c19bf7c336.png" alt="章工运维" class="logo"> <span class="site-name can-hide">章工运维</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/ops/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/windows/" class="nav-link">windows</a></li><li class="dropdown-item"><!----> <a href="/middleware/" class="nav-link">中间件</a></li><li class="dropdown-item"><!----> <a href="/monitor/" class="nav-link">监控</a></li><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/storage/" class="nav-link">存储</a></li><li class="dropdown-item"><!----> <a href="/safety/" class="nav-link">安全</a></li><li class="dropdown-item"><!----> <a href="/firewalld/" class="nav-link">防火墙</a></li><li class="dropdown-item"><!----> <a href="/db/" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/sys/" class="nav-link">系统</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">运维工具</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">other</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专题" class="dropdown-title"><a href="/topic/" class="link-title">专题</a> <span class="title" style="display:none;">专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/elk/" class="nav-link">elk</a></li><li class="dropdown-item"><!----> <a href="/k8s/" class="nav-link">K8S</a></li><li class="dropdown-item"><!----> <a href="/ansible/" class="nav-link">ansible</a></li><li class="dropdown-item"><!----> <a href="/jenkins/" class="nav-link">Jenkins</a></li><li class="dropdown-item"><!----> <a href="/gitlabci/" class="nav-link">GitLabCI_CD</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><a href="/life/" class="link-title">生活</a> <span class="title" style="display:none;">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/suibi/" class="nav-link">随笔</a></li><li class="dropdown-item"><!----> <a href="/mianshi/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/gongju/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/favorites/" class="nav-link">收藏夹</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><a href="/code/" class="link-title">编程</a> <span class="title" style="display:none;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/shell/" class="nav-link">Shell</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">golang</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/nav/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://pic.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图床
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://artalk.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  评论
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.zzppjj.top/download/light/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  下载站点
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zpj874878956" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="http://pic.zzppjj.top/LightPicture/2023/02/c7ac9de8fb6cfb17.jpg"> <div class="blogger-info"><h3>章工运维</h3> <span>业精于勤，荒于嬉</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/ops/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/windows/" class="nav-link">windows</a></li><li class="dropdown-item"><!----> <a href="/middleware/" class="nav-link">中间件</a></li><li class="dropdown-item"><!----> <a href="/monitor/" class="nav-link">监控</a></li><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/storage/" class="nav-link">存储</a></li><li class="dropdown-item"><!----> <a href="/safety/" class="nav-link">安全</a></li><li class="dropdown-item"><!----> <a href="/firewalld/" class="nav-link">防火墙</a></li><li class="dropdown-item"><!----> <a href="/db/" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/sys/" class="nav-link">系统</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">运维工具</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">other</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专题" class="dropdown-title"><a href="/topic/" class="link-title">专题</a> <span class="title" style="display:none;">专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/elk/" class="nav-link">elk</a></li><li class="dropdown-item"><!----> <a href="/k8s/" class="nav-link">K8S</a></li><li class="dropdown-item"><!----> <a href="/ansible/" class="nav-link">ansible</a></li><li class="dropdown-item"><!----> <a href="/jenkins/" class="nav-link">Jenkins</a></li><li class="dropdown-item"><!----> <a href="/gitlabci/" class="nav-link">GitLabCI_CD</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><a href="/life/" class="link-title">生活</a> <span class="title" style="display:none;">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/suibi/" class="nav-link">随笔</a></li><li class="dropdown-item"><!----> <a href="/mianshi/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/gongju/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/favorites/" class="nav-link">收藏夹</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><a href="/code/" class="link-title">编程</a> <span class="title" style="display:none;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/shell/" class="nav-link">Shell</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">golang</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/nav/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://pic.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图床
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://artalk.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  评论
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.zzppjj.top/download/light/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  下载站点
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zpj874878956" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>linux</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>windows</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>中间件</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>网络</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>安全</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>存储</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>防火墙</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>数据库</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>系统</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>vmware</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>ftp</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>nexus</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>harbor</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>confluence&amp;jira</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>loki</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>sonarqube</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>svn</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>other</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>openldap</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>influxdb</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>wordpress</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading open"><span>kvm</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/91d35e/" aria-current="page" class="active sidebar-link">centos7安装kvm虚拟机</a><ul class="sidebar-sub-headers"></ul></li></ul></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>argocd</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>jfrog</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>nextcloud</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable is-sub-group depth-1"><p class="sidebar-heading"><span>RustDesk</span> <span class="arrow right"></span></p> <!----></section></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>docker</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>other</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>监控</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/ops/#运维" data-v-06225672>运维</a></li><li data-v-06225672><a href="/ops/#系统" data-v-06225672>系统</a></li><li data-v-06225672><a href="/ops/#kvm" data-v-06225672>kvm</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/zpj874878956" target="_blank" title="作者" class="beLink" data-v-06225672>章工运维</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2023-08-20</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABH1JREFUSA3tVl1oHFUUPmdmd2ltklqbpJDiNnXFmgbFktho7YMPNiJSSZM0+CAYSkUELVhM6YuwIPpgoOKDqOBDC0XE2CQoNtQXBUFTTcCi+Wlh1V2TQExsUzcltd3M9Tt3ZjZzZ2fT+OJTL8yeM+eee757fmeJbq//KQL8X3DUSFOcfr7cRsRtxNQMWueeVzOkaITIGqQHNg5y8+jNW9ldM7A6nTpAjuolUikAwq7CE3WcM2RRDz+XGVgN3FptU/aUSlvq9Pa3iZ1+sgAqJyyAFqkipd9dqiwHF3P65YycLWc/6sqGrvoEoIp6DOFaX5h6+dnfjkWprwqsPk0dUGq5vySwDImC10KxFHgGL1SWoc92O3eVht09qdXNH11I2SsTsJYqMWzihqGMi+A+Garf3BAuuLI5oGlULyNfyB/HYNujwktOfRrMr5t77NmevqaUopx0grnKAyvVpmwUDB4x6FPXuGvYLTDwWsejwgtgkYKPqRJg8SV6xaiZ3ZTppGneS4yfH5/66fZSDHv+QZci/+h5c5UHtpy67JUqGppM0sh0Nc1dW6/N1W5Yoqat8/TU/VnadmdeW2PLLSyh0cvxBs3KbqTmwYPpxN4do/mzE8nEpvX/UMu2Wbp74zUAK5q6WkHns7V0eWkdPbPzd3rxkTGybadYySumVzhcaJFbs5UrEkQ/+CK8gF5dnh/6ciIZ73gwQ927L1IitoxKLXYP3SjYdOrHHfTZhRRlFyrorafPk20B3HPD1y2G3qKZME5Jcf3t/HUC13/8tSd++vqFveMUTwAUxSUFI1QekR1+bIze3D9MF2aq6cPvG72CgnldWCFqyRw3lwH8ZMerjTD9ElRO7Gv44wNpC90aASqGfVlz/Rx17srQ57/UU26hkhQqUB7dBR71WmzQhHUnblGmVOEw0jhbV1n9OlXUDCIRGaNV5Jp43N516fN7JmnTHdfp7Hgy0luO4aMhtkLL8Bi3bUWYvzh5Mn1dTxrL6QmGuRhGL/TiTTxRoEdTszSaq9GR0NGA3KdkOz3hqSV3MIDhQ5IVX/Ivx3umBti2es2h4eZby7x8br1rkf7Mo90AqC8aQ3sJeNzqFRu+vSANAQe3PL7l0HGOAdwDCeZYvNKeoZp1Qfs6Aipndh86HmFRi0LAnEO47wsqM6cdfjh3jBPUzhZy7nvlUfFsamED1VQt6aISHVymXZ/B2aCtIG8AI8xfobj2d3en1wWVhOeHELKmLQ1s211s88comkv4UCwWyF787mJdYXtNfhKAXVqnKTq8QZvGAGGOfaTo5pGZ/PwbUCr5+DPr/1J92JNHr9aOl/F3iI5+O1nfybsGxoimvZ3ViWSluDITw3P37mypheDIPY0tw7+O/5ApbkYw+zpfaUVu32Pi98+defdUhEpZkRFq0aqyNh9FuL9hpYbEm6iwi0z2REd09ZmyENEbuhjDWzKvZXTqKYaBIr3tt5kuPtQBZFvEUwHt60vfCNu41XsksH9Ij1BMMz1Y0OOunHNShFIP5868g5zeXmuLwL9T4b6Q2+KejgAAAABJRU5ErkJggg==">centos7安装kvm虚拟机<!----></h1>  <div class="theme-vdoing-content content__default"><h3 id="_1、概述"><a href="#_1、概述" class="header-anchor">#</a> 1、概述</h3> <blockquote><p>虚拟化在现实中越来越普遍，如今设备的配置越来越高，如何高效方便的尽可能利用设备的能力是一个很值得研究的探讨的，虚拟化应运而生，伴随着云计算的普及，虚拟化的应用又上了一个新的高度。</p> <p>虚拟化这个概念最早在1959年被提出，20世界60年代首次出现了虚拟内存和虚拟机，经过一段时期的发展，1998年Vmware公司成立，并在次年推出了基于X86平台的商业虚拟化软件，从此虚拟机进入了一个新的发展阶段。</p> <p>2003年 xen面世，同一年微软收购了xen获得了虚拟化技术。</p> <p>随后oracle，redhat，思科，惠普大厂商都在虚拟化领域有自己的产品，虚拟化领域百家齐放。</p> <p>虚拟化发展经历过数十年的时间，出现过各种各样虚拟化的实现方式，目前主流的大概分为两种:</p> <ul><li>VMM直接运行在硬件平台上，控制所有硬件并管理客户操作系统。</li> <li>VMM运行在一个传统的操作系统中，而客户机操作系统运行在传统的操作系统中，KVM就是这种实现方式。</li></ul> <p>根据虚拟化的程度和实现方式，又可以分为完全虚拟化、半虚拟化等等，这里我们不深入探讨这些问题。</p> <p>KVM诞生于2006年，由以色列的 Qumranet 组织开发，并且将源代码贡献给了开源社区。2007年linux内核第一次包含了KVM，2008年红帽收购了Qumranet并接手了KVM，2009年在红帽5.4版本中添加了KVM，此后从Linux 2.6.20 起就作为一模块被包含在 Linux 内核中。</p> <p>KVM 全称是基于内核的虚拟机（Kernel-based Virtual Machine）KVM 是基于虚拟化扩展（Intel VT 或者 AMD-V）的 X86 硬件的开源的 Linux 原生的全虚拟化解决方案。KVM 中，虚拟机被实现为常规的 Linux 进程，由标准 Linux 调度程序进行调度；虚机的每个虚拟 CPU 被实现为一个常规的 Linux 进程。这使得 KMV 能够使用 Linux 内核的已有功能。但是，KVM 本身不执行任何硬件模拟，需要客户空间程序通过 /dev/kvm 接口设置一个客户机虚拟服务器的地址空间，向它提供模拟的 I/O，并将它的视频显示映射回宿主的显示屏。目前这个应用程序是 QEMU。</p> <p>实际上KVM仅仅是内核中的一个叫kvm.ko用于管理虚拟CPU和内存的模块，而其他诸如磁盘IO的虚拟化则交由其他软件实现，QEMU就负责硬件虚拟化，在早期QEMU是独立发展的，后面因为各种原因分离出了一个版本专用于KVM，被称为qemu-kvm一直发展至今。</p> <p>早期虚拟化管理是一个非常复杂的过程，为了解决管理上的问题，redhat公司开发了一个叫Libvirt的虚拟机管理工具，并且也贡献给了开源社区，Libvirt提供了一个通用、稳定、安全、高效的管理工具，并且支持了远程操作，也提供不同语言的SDK。事实上Libvirt不仅仅能管理KVM，也能管理其他的虚拟机，详细可以查看官网的文档。</p> <p>KVM在虚拟机领域是一个比较新的成员，如今遇上了云计算的潮流，目前主流的云计算厂商例如AWS、阿里云等都采用了KVM的虚拟机方案，基于云计算的概念也发展出了诸如OpenStack的开源的云计算方案。</p></blockquote> <p><strong>环境信息</strong></p> <table><thead><tr><th>系统</th> <th>cpu</th> <th>内存</th> <th>硬盘</th></tr></thead> <tbody><tr><td>centos7.6</td> <td>8C</td> <td>8G</td> <td>500G</td></tr></tbody></table> <h3 id="_2、环境检测"><a href="#_2、环境检测" class="header-anchor">#</a> 2、环境检测</h3> <p>KVM基于X86虚拟化扩展技术的虚拟机软件，所以需要CPU支持 Intel VT 或者 AMD-V</p> <p>cat /proc/cpuinfo | egrep 'vmx|svm'</p> <p>如果有返回信息，这说明当前CPU支持并且开启了虚拟化扩展</p> <h3 id="_3、kvm环境安装"><a href="#_3、kvm环境安装" class="header-anchor">#</a> 3、kvm环境安装</h3> <p>一套完成的KVM虚拟机大致包含如下软件:</p> <ul><li>qemu-kvm 主要的KVM程序包</li> <li>libvirt C语言工具包，提供libvirt服务</li> <li>virt-install 基于libvirt服务的虚拟机创建命令</li> <li>bridge-utils 创建和管理桥接设备的工具</li> <li>python36-libvirt python3客户端</li> <li>virt-manager GUI虚拟机管理工具</li> <li>virt-top 虚拟机统计命令</li> <li>virt-viewer GUI连接程序，连接到已配置好的虚拟机</li> <li>libvirt-client 为虚拟客户机提供的C语言工具包</li></ul> <p>其中qemu-kvm、libvirt、virt-install、bridge-utils这四个软件我们必须安装。其他的按需安装。</p> <p>因为我们的宿主机是centos7.6最小化安装的，所以就不安装GUI管理工具了</p> <p>yum install -y qemu-kvm libvirt virt-install bridge-utils # 安装 systemctl start libvirtd # 启动libvirtd systemctl enable libvirtd # 设置开机自启动libvirtd</p> <p>执行以上操作之后虚拟机环境就安装完成了。建议安装完成之后重启服务器，并且在重启之后检查是否正确加载了内核模块</p> <p>[root@localhost ~]# lsmod | grep kvm kvm_intel 183621 0 kvm 586948 1 kvm_intel
irqbypass 13503 1 kvm</p> <p>如上，说明正确加载了内核模块</p> <p>建议使用阿里云的repo仓库。虚拟机安装也建议使用yum安装，如果需要编译安装可以参考官方文档</p> <h3 id="_4、虚拟机网络配置"><a href="#_4、虚拟机网络配置" class="header-anchor">#</a> 4、虚拟机网络配置</h3> <h4 id="_4-1、虚拟机网络模式"><a href="#_4-1、虚拟机网络模式" class="header-anchor">#</a> 4.1、虚拟机网络模式</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>安装好kvm之后，默认会创建一个default的网络，设备名称为virbr0，我们先看一下这个网络的信息
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-list --all</span>
 Name                 State      Autostart     Persistent
----------------------------------------------------------
 default              active     <span class="token function">yes</span>           <span class="token function">yes</span>
如上virsh net-list --all命令会列出所有的网络，如果不加--all参数只会列出active状态的网络。
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-dumpxml default</span>
<span class="token operator">&lt;</span>network<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>default<span class="token operator">&lt;</span>/name<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>uuid<span class="token operator">&gt;</span>3eaed894-4b0a-4de1-9177-7b56bff63c8<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/uuid<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>forward <span class="token assign-left variable">mode</span><span class="token operator">=</span><span class="token string">'nat'</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>nat<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>port <span class="token assign-left variable">start</span><span class="token operator">=</span><span class="token string">'1024'</span> <span class="token assign-left variable">end</span><span class="token operator">=</span><span class="token string">'65535'</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/nat<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/forward<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>bridge <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">'virbr0'</span> <span class="token assign-left variable">stp</span><span class="token operator">=</span><span class="token string">'on'</span> <span class="token assign-left variable">delay</span><span class="token operator">=</span><span class="token string">'0'</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>mac <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">'52:54:00:f5:32:49'</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>ip <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">'192.168.122.1'</span> <span class="token assign-left variable">netmask</span><span class="token operator">=</span><span class="token string">'255.255.255.0'</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>dhcp<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>range <span class="token assign-left variable">start</span><span class="token operator">=</span><span class="token string">'192.168.122.2'</span> <span class="token assign-left variable">end</span><span class="token operator">=</span><span class="token string">'192.168.122.254'</span>/<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>/dhcp<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/ip<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/network<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p>virsh net-dumpxml default 命令dump出default的xml的配置信息，在kvm中各种配置信息都是使用xml来定义的。从dump出来的<forward mode="nat">信息中我们看到这个网络类型为nat，并且定义了网段信息，dhcp可用IP范围等信息。</forward></p> <p>在kvm中，可以定义不同的网络，主流的是nat和bridge，kvm常用的网络类型大致有如下几种:</p> <ul><li>nat模式:在nat模式中，KVM虚拟机之间需要配置与nat对应网段的信息，挂载到同一个设备下的kvm虚拟机完全可以通讯，KVM和虚拟机可以通讯，但是如果想要将kvm虚拟机的服务发布出去，则需要宿主机做DNAT端口映射到对应的虚拟机。nat模式也是KVM默认的模式</li> <li>bridge桥接模式:在桥接模式中，kvm可以和宿主机在同一个网段，虚拟机网卡配置和宿主机同网段的IP信息，在同一个网桥下的虚拟机可以互相通讯。网桥是二层设备，通过mac地址通讯，所以不允许配置IP，这个概念在往后的跨物理机的KVM互通配置中非常重要。</li> <li>路由模式:路由模式中虚拟交换机连接到主机的物理网络，可以在不适用NAT的情况下传输流量。虚拟交换机检查所有的流量，通过网络包做出路由决策，在此模式中所有的虚拟机都位于自己的子网中，通过交换机进行路由。</li> <li>隔离模式:在隔离模式中，连接到虚拟交换机中的虚拟机可以互相通讯，也可以和宿主机通讯，但是不会传到宿主机以外的物理机上，也无法从物理机外部获取流量，被完全隔离在虚拟网络中。</li></ul> <p>网络也是一个比较复杂的东西，如果想要了解更多的信息，可以查阅libvirt的官网关于网络定义的说明，https://libvirt.org/formatnetwork.html</p> <p>在我的实际的使用中，最常用的就是路由模式了。</p> <p>在很多的教程中，都使用了手动编辑网桥的配置文件来创建一个linux网桥。</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># cat /etc/sysconfig/network-scripts/ifcfg-br0 </span>
<span class="token assign-left variable">TYPE</span><span class="token operator">=</span>Bridge
<span class="token assign-left variable">BOOTPROTO</span><span class="token operator">=</span>dhcp
<span class="token assign-left variable">DEFROUTE</span><span class="token operator">=</span>yes
<span class="token assign-left variable">PEERDNS</span><span class="token operator">=</span>yes
<span class="token assign-left variable">PEERROUTES</span><span class="token operator">=</span>yes
<span class="token assign-left variable">IPV4_FAILURE_FATAL</span><span class="token operator">=</span>no
<span class="token assign-left variable">NAME</span><span class="token operator">=</span>br0
<span class="token assign-left variable">DEVICE</span><span class="token operator">=</span>br0
<span class="token assign-left variable">ONBOOT</span><span class="token operator">=</span>yes
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>如上，通过手动创建一个br0网桥，然后在物理接口配置文件里将物理机接口挂到这个虚拟网桥中</p> <p>[root@KVM-01 ~]# cat /etc/sysconfig/network-scripts/ifcfg-enp4s0f0 TYPE=Ethernet
BOOTPROTO=dhcp
DEFROUTE=yes
PEERDNS=yes
PEERROUTES=yes
IPV4_FAILURE_FATAL=no
NAME=enp4s0f0
UUID=ee1e24a8-a5fd-44f4-bb7a-159c84da9447
DEVICE=enp4s0f0
ONBOOT=yes
BRIDGE=br0</p> <p>如上的物理网卡配置中BRIDGE=br0配置了将这个物理接口挂载到了br0网桥下，并且通过DHCP获取IP地址。</p> <p>最终的结果</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@KVM-01 ~<span class="token punctuation">]</span><span class="token comment"># ip a</span>
<span class="token number">1</span>: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN qlen <span class="token number">1</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo
       valid_lft forever preferred_lft forever
<span class="token number">2</span>: enp4s0f0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast master br0 state UP qlen <span class="token number">1000</span>
    link/ether <span class="token number">80</span>:c1:6e:74:f1:78 brd ff:ff:ff:ff:ff:ff
<span class="token number">3</span>: enp4s0f1: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state DOWN qlen <span class="token number">1000</span>
    link/ether <span class="token number">80</span>:c1:6e:74:f1:79 brd ff:ff:ff:ff:ff:ff
<span class="token number">4</span>: enp4s0f2: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state DOWN qlen <span class="token number">1000</span>
    link/ether <span class="token number">80</span>:c1:6e:74:f1:7a brd ff:ff:ff:ff:ff:ff
<span class="token number">5</span>: enp4s0f3: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state DOWN qlen <span class="token number">1000</span>
    link/ether <span class="token number">80</span>:c1:6e:74:f1:7b brd ff:ff:ff:ff:ff:ff
<span class="token number">6</span>: br0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state UP qlen <span class="token number">1000</span>
    link/ether <span class="token number">80</span>:c1:6e:74:f1:78 brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">172.16</span>.8.111/16 brd <span class="token number">172.16</span>.255.255 scope global dynamic br0
       valid_lft 215588sec preferred_lft 215588sec
<span class="token number">7</span>: virbr0: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state DOWN qlen <span class="token number">1000</span>
    link/ether <span class="token number">52</span>:54:00:a3:1c:78 brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">192.168</span>.122.1/24 brd <span class="token number">192.168</span>.122.255 scope global virbr0
       valid_lft forever preferred_lft forever

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><p>我们可以看到，br0设备获取到了IP地址172.16.8.111，并且enp4s0f0 的master为br0，state为UP。</p> <p>这种方式的配置好像是对的，但是..在实际的使用中会发现一个问题:</p> <p>在如上这种手动配置的网桥中，如果重启了宿主机的网络之后，虚拟机的网络会中断，无法和其他设备通讯，并且需要通过virsh shutdown 和virsh start命令重启虚拟机之后才会恢复。</p> <p>这肯定不是我们想要的，我们需要重启宿主机网络之后并不影响KVM虚拟机的网络。</p> <p>在KVM中已经提供了网络管理工具，通过KVM提供的工具就可以解决这个问题。</p> <h4 id="_4-2、创建xml"><a href="#_4-2、创建xml" class="header-anchor">#</a> 4.2、创建xml</h4> <p>我们以创建一个route模式的bro为例创建一个虚拟网络。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token operator">&lt;</span>network<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>br<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/name<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>bridge <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">&quot;br0&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>forward <span class="token assign-left variable">mode</span><span class="token operator">=</span><span class="token string">&quot;route&quot;</span> /<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>ip <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">&quot;192.168.8.1&quot;</span> <span class="token assign-left variable">netmask</span><span class="token operator">=</span><span class="token string">&quot;255.255.255.0&quot;</span>/<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/network<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>如上的xml文件中，我们配置了名称为br0并且设备名称也为br0网络</p> <ul><li><name>br0</name> 配置kvm的网络名称</li> <li><bridge name="br0"></bridge> 配置了网络设备的名称</li> <li><forward mode="route"></forward> 指定为route模式</li> <li><ip address="192.168.8.1" netmask="255.255.255.0"></ip> 给这个br0设备配置一个出口的IP</li></ul> <p>在路由模式中，必须而且仅有一个出口的IP信息，可以认为是虚拟网络的出口网关，通过这个IP可以和宿主通讯。同时这个IP也属于宿主机，也就是说通过这个IP可以直接访问到宿主机本身，这个概念对我们以后的跨物理机管理也非常重要。</p> <p>在上面的xml我们并没有定义mac地址等，这些信息kvm会自动补上，无需当心，手动定义可能还会出现mac地址冲突等问题。</p> <h4 id="_4-3、定义网络"><a href="#_4-3、定义网络" class="header-anchor">#</a> 4.3、定义网络</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-define net.xml  # 从xml文件定义网络br0</span>
Network br0 defined from net.xml
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-list --all  # 查看所有的网络</span>
 Name                 State      Autostart     Persistent
----------------------------------------------------------
 br0                  inactive   no            <span class="token function">yes</span>
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-start  br0 # 启动网络br0</span>
Network br0 started
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-autostart  br0 # 开机自启动br0</span>
Network br0 marked as autostarted
<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh net-dumpxml  br0 # 查看br0的详细配置</span>
<span class="token operator">&lt;</span>network<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>br<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>/name<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>uuid<span class="token operator">&gt;</span>3dcfb28b-d434-4293-992e-c8adba739d1a<span class="token operator">&lt;</span>/uuid<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>forward <span class="token assign-left variable">mode</span><span class="token operator">=</span><span class="token string">'route'</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>bridge <span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token string">'br0'</span> <span class="token assign-left variable">stp</span><span class="token operator">=</span><span class="token string">'on'</span> <span class="token assign-left variable">delay</span><span class="token operator">=</span><span class="token string">'0'</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>mac <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">'52:54:00:65:75:1e'</span>/<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>ip <span class="token assign-left variable">address</span><span class="token operator">=</span><span class="token string">'192.168.8.1'</span> <span class="token assign-left variable">netmask</span><span class="token operator">=</span><span class="token string">'255.255.255.0'</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>/ip<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/network<span class="token operator">&gt;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>上面的一系列操作中，我们定义并且启动了br0网络，在xml的文件中我们并没有配置mac地址信息，在dump出来的xml有了mac地址的信息，这个是libvirt自动帮我们加上去的。</p> <p>我们看看系统的网络设备信息</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># ip a</span>
<span class="token number">1</span>: lo: <span class="token operator">&lt;</span>LOOPBACK,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">65536</span> qdisc noqueue state UNKNOWN group default qlen <span class="token number">1000</span>
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet <span class="token number">127.0</span>.0.1/8 scope <span class="token function">host</span> lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope <span class="token function">host</span> 
       valid_lft forever preferred_lft forever
<span class="token number">2</span>: enp3s0: <span class="token operator">&lt;</span>BROADCAST,MULTICAST,UP,LOWER_UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state UP group default qlen <span class="token number">1000</span>
    link/ether 00:e0:81:d3:57:ad brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">172.16</span>.8.189/16 brd <span class="token number">172.16</span>.255.255 scope global noprefixroute dynamic enp3s0
       valid_lft 172633sec preferred_lft 172633sec
    inet6 fe80::3398:7712:b754:1d3b/64 scope <span class="token function">link</span> noprefixroute 
       valid_lft forever preferred_lft forever
<span class="token number">3</span>: enp2s0: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast state DOWN group default qlen <span class="token number">1000</span>
    link/ether 00:e0:81:d3:57:ac brd ff:ff:ff:ff:ff:ff
<span class="token number">6</span>: br0: <span class="token operator">&lt;</span>NO-CARRIER,BROADCAST,MULTICAST,UP<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc noqueue state DOWN group default qlen <span class="token number">1000</span>
    link/ether <span class="token number">52</span>:54:00:65:75:1e brd ff:ff:ff:ff:ff:ff
    inet <span class="token number">192.168</span>.8.1/24 brd <span class="token number">192.168</span>.8.255 scope global br0
       valid_lft forever preferred_lft forever
<span class="token number">7</span>: br0-nic: <span class="token operator">&lt;</span>BROADCAST,MULTICAST<span class="token operator">&gt;</span> mtu <span class="token number">1500</span> qdisc pfifo_fast master br0 state DOWN group default qlen <span class="token number">1000</span>
    link/ether <span class="token number">52</span>:54:00:65:75:1e brd ff:ff:ff:ff:ff:ff
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>从上面信息中我们看到了br0已经启动了，并且配置了192.168.8.1的IP地址。</p> <p>我们再来查看一下系统的路由信息</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># route -n</span>
Kernel IP routing table
Destination     Gateway         Genmask         Flags Metric Ref    Use Iface
<span class="token number">0.0</span>.0.0         <span class="token number">172.16</span>.0.8      <span class="token number">0.0</span>.0.0         UG    <span class="token number">100</span>    <span class="token number">0</span>        <span class="token number">0</span> enp3s0
<span class="token number">172.16</span>.0.0      <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.0.0     U     <span class="token number">100</span>    <span class="token number">0</span>        <span class="token number">0</span> enp3s0
<span class="token number">192.168</span>.8.0     <span class="token number">0.0</span>.0.0         <span class="token number">255.255</span>.255.0   U     <span class="token number">0</span>      <span class="token number">0</span>        <span class="token number">0</span> br0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>系统自动为我们加上了一条到192.168.8.0/24网段的路由信息，这个网段的流量发送到接口br0上。</p> <p>我们再来说说这个br0配置的192.168.8.1这个IP，我们创建了一台虚拟机，并且将虚拟机加入到br0的网络中，虚拟机只要配置192.168.8.0/24网段的IP就能与外界通讯。</p> <p>外部流量到达宿主机，宿主机通过路由表选择将流量发到br0中，br0是网桥，在网桥内部通过mac地址将数据包发送给指定的KVM虚拟机，而对于虚拟机来说，此时的出口就应该需要指定到192.168.8.1 即可将流量发到br0上，然后再由宿主机路由表选择将包发到对应的接口，完成整个通讯的过程。</p> <p>因为192.168.8.1这个IP属于宿主机，所以外部能到达192.168.8.1就能直接访问到宿主机本机。</p> <h4 id="_4-4、跨宿主机kvm互通"><a href="#_4-4、跨宿主机kvm互通" class="header-anchor">#</a> 4.4、跨宿主机KVM互通</h4> <p>同一个宿主机内的kvm可以通讯了，那么跨宿主机的KVM如何通讯呢？</p> <p>br0是一个二层的设备，靠mac地址通讯，所以只能br0能学习到mac就可以通讯。那么怎么学习到跨宿主机的KVM的mac地址呢？</p> <p>在我实际的经验中，我通常借助内网物理交换机。服务器上有多个网口，将其中一个物理网口加入到br0网络，然后再将这个网口通过网线接入到物理交换机中，每一台宿主机都这样配置，就可以将br0通过物理交换机级联起来，从而打造了一个跨宿主机的二层交换环境，这样所有的kvm虚拟机就可以互通有无了。</p> <p>kvm的网络是建立在linux的虚拟网桥上，如果想要更多的功能可以使用Open vSwitch构建一个更强大的虚拟网络。</p> <h3 id="_5、安装虚拟机"><a href="#_5、安装虚拟机" class="header-anchor">#</a> 5、安装虚拟机</h3> <p>解决了网络问题之后我们开始安装虚拟机，这里我们演示centos 7.6和windows 2012 R2的安装。</p> <p>安装前要设置环境语言为英文LANG=&quot;en_US.UTF-8&quot;，如果是中文的话某些版本可能会报错。CentOS 7 请修改/etc/locale.conf。</p> <h4 id="_5-1、linux虚拟机安装"><a href="#_5-1、linux虚拟机安装" class="header-anchor">#</a> 5.1、linux虚拟机安装</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token punctuation">[</span>root@localhost centos7<span class="token punctuation">]</span><span class="token comment"># virt-install --virt-type=kvm --os-type=linux --os-variant=centos7.0 --name=centos7  --vcpus=2 --ram 4096 \</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--disk</span> <span class="token assign-left variable">path</span><span class="token operator">=</span>/vm/disk/centos7/vda.qcow2,bus<span class="token operator">=</span>virtio,cache<span class="token operator">=</span>none,size<span class="token operator">=</span><span class="token number">40</span>  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--cdrom</span> /vm/iso/CentOS-7.6-x86_64-Minimal-1810.iso  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--network</span> <span class="token assign-left variable">bridge</span><span class="token operator">=</span>br0,model<span class="token operator">=</span>virtio <span class="token parameter variable">--noautoconsole</span>  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--vnc</span> <span class="token parameter variable">--vncport</span><span class="token operator">=</span><span class="token number">5901</span> <span class="token parameter variable">--vnclisten</span><span class="token operator">=</span><span class="token number">0.0</span>.0.0

Starting install<span class="token punctuation">..</span>.
Allocating <span class="token string">'vda.qcow2'</span>                                                       <span class="token number">40</span> GB  00:00:00
Domain installation still <span class="token keyword">in</span> progress. You can reconnect to 
the console to complete the installation process.


</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>如上，安装了一个centos系统，在安装的参数中:</p> <ul><li>--virt-type:指定虚拟机的类型，上文中我们说到libvirt不仅能管理kvm，还能管理其他的虚拟机。</li> <li>--os-type:指定安装的系统类型linux或者windows</li> <li>--os-variant:针对不同的操作系统进一步优化虚拟机的配置，这个参数是可选的，而且不一定需要和--os-type一起使用。具体的选值可以通过osinfo-query os查看。</li> <li>--name:指定一个名称方便虚拟机管理，这个名称要全局唯一。</li> <li>--vcpus:配置虚拟机的虚拟CPU数量</li> <li>--ram:配置虚拟机的虚拟内存，单位为:M</li> <li>--disk:指定虚拟磁盘，其中:path:指定磁盘的路径，需要绝对路径。bus:配置总线类型为virtio。cache:配置缓存模式。size:指定虚拟磁盘大小，单位为:G。</li> <li>--cdrom:指定光驱文件，系统从光驱读取安装。</li> <li>--vnc:配置使用VNC</li> <li>--vncport:配置VNC的端口</li> <li>--vnclisten:配置VNC监听的IP</li> <li>--network:配置网络设备，其中:bridge:指定挂载到哪个网桥设备中。model:网卡模式。</li> <li>--noautoconsole:不自动试图连接到客户机控制台</li></ul> <p>创建好了虚拟机之后，可以通过VNC客户端链接到宿主机IP:vncport进行正常的系统安装。</p> <p>在安装完成之后点击REBOOT按钮之后并不会重启虚拟机，而是会直接关闭虚拟机，需要到宿主机中启动虚拟机。</p> <p>当然，如果你不想使用VNC图形化安装系统，你可以删除VNC的相关参数并且修改cdrom为location，添加--graphics none --extra-args='console=ttyS0' --force参数就可以使用文字界面安装系统。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost centos7<span class="token punctuation">]</span><span class="token comment"># virt-install --virt-type=kvm --os-type=linux --os-variant=centos7.0 --name=centos7  --vcpus=2 --ram 4096 \</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--disk</span> <span class="token assign-left variable">path</span><span class="token operator">=</span>/vm/disk/centos7/vda.qcow2,bus<span class="token operator">=</span>virtio,cache<span class="token operator">=</span>none,size<span class="token operator">=</span><span class="token number">40</span>  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--location</span> /vm/iso/CentOS-7.6-x86_64-Minimal-1810.iso  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--network</span> <span class="token assign-left variable">bridge</span><span class="token operator">=</span>br0,model<span class="token operator">=</span>virtio <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--graphics</span> none --extra-args<span class="token operator">=</span><span class="token string">'console=ttyS0'</span> <span class="token parameter variable">--force</span>

Starting install<span class="token punctuation">..</span>.
Retrieving <span class="token function">file</span> .treeinfo<span class="token punctuation">..</span>.                                                       <span class="token operator">|</span>  <span class="token number">354</span> B  00:00:00
Retrieving <span class="token function">file</span> vmlinuz<span class="token punctuation">..</span>.                                                         <span class="token operator">|</span> <span class="token number">6.3</span> MB  00:00:00
Retrieving <span class="token function">file</span> initrd.img<span class="token punctuation">..</span>.                                                      <span class="token operator">|</span>  <span class="token number">50</span> MB  00:00:00
Allocating <span class="token string">'vda.qcow2'</span>                                                             <span class="token operator">|</span>  <span class="token number">40</span> GB  00:00:00
Connected to domain centos7

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>安装完成之后配置好网络信息即可。</p> <h4 id="_5-2、windows虚拟机安装"><a href="#_5-2、windows虚拟机安装" class="header-anchor">#</a> 5.2、windows虚拟机安装</h4> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost iso<span class="token punctuation">]</span><span class="token comment"># virt-install --virt-type=kvm --os-type=windows \</span>
<span class="token operator">&gt;</span> --os-variant<span class="token operator">=</span>win2k12r2 <span class="token parameter variable">--name</span><span class="token operator">=</span>windows2012r2 <span class="token parameter variable">--vcpus</span><span class="token operator">=</span><span class="token number">4</span> <span class="token parameter variable">--ram</span> <span class="token number">4096</span>  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--disk</span> <span class="token assign-left variable">path</span><span class="token operator">=</span>/vm/disk/windows2012r2/c.qcow2,format<span class="token operator">=</span>qcow2,bus<span class="token operator">=</span>virtio,cache<span class="token operator">=</span>none,size<span class="token operator">=</span><span class="token number">40</span> <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--cdrom</span> /vm/iso/cn_windows_server_2012_r2_vl_x64_dvd_2979220.iso <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--disk</span> <span class="token assign-left variable">path</span><span class="token operator">=</span>/vm/iso/virtio-win-0.1.173_amd64.vfd,device<span class="token operator">=</span>floppy  <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--vnc</span> <span class="token parameter variable">--vncport</span><span class="token operator">=</span><span class="token number">5902</span> <span class="token parameter variable">--vnclisten</span><span class="token operator">=</span><span class="token number">0.0</span>.0.0 <span class="token punctuation">\</span>
<span class="token operator">&gt;</span> <span class="token parameter variable">--network</span> <span class="token assign-left variable">bridge</span><span class="token operator">=</span>br0,model<span class="token operator">=</span>virtio <span class="token parameter variable">--noautoconsole</span>

Starting install<span class="token punctuation">..</span>.
Allocating <span class="token string">'c.qcow2'</span>                                                          <span class="token operator">|</span>  <span class="token number">40</span> GB  00:00:02     
Domain installation still <span class="token keyword">in</span> progress. You can reconnect to 
the console to complete the installation process.

</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>windows安装参数和linux的差不多，在windows中，我们多加了一个--disk path=/vm/iso/virtio-win-0.1.173_amd64.vfd,device=floppy，此参数加载了一个软盘，指定了一个vfd软盘镜像。</p> <p>和linux安装一样，我们使用了virtio，在linux中自带了virtio的驱动，所以我们并不需要额外在安装驱动，而windows镜像是不带virtio驱动的，如果没有加载virtio驱动，那么在windows的安装程序中是无法识别磁盘的。在此处加载了一个virtio驱动软驱，然后在安装程序中磁盘分区页面搜索加载磁盘驱动即可。</p> <p>特别说明的是，不仅仅要准备virtio的软驱镜像，还需要下载一个完整的virtio的iso光驱镜像，系统安装好之后需要挂载到系统中安装virtio驱动，否则网卡和一些主板的驱动将无法识别。</p> <p>Virtio是一种半虚拟化的解决方案，能够大幅提高虚拟机的I/O性能。<a href="https://fedorapeople.org/groups/virt/virtio-win/direct-downloads/archive-virtio/" target="_blank" rel="noopener noreferrer">virtio驱动下载页面<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h3 id="_6、虚拟机管理命令"><a href="#_6、虚拟机管理命令" class="header-anchor">#</a> 6、虚拟机管理命令</h3> <p>libvirt提供了一个命令行的管理客户端virsh，通过此客户端工具可以方便的管理kvm虚拟机。</p> <p>可以通过virsh --help 获得帮助信息，帮助信息是我们学习客户端的重要方式。本篇中介绍一些常用的虚拟机管理。</p> <h4 id="_6-1、虚拟机生命周期管理"><a href="#_6-1、虚拟机生命周期管理" class="header-anchor">#</a> 6.1、虚拟机生命周期管理</h4> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code>
<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh list --all # 查看所有虚拟机，如果不加`--all`则查看正在运行中的虚拟机</span>
 Id    Name                           State
----------------------------------------------------
 -     centos7                        shut off

<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh start centos7 # 启动`centos7`虚拟机</span>
Domain centos7 started

<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh shutdown centos7 # 关闭`centos7`虚拟机</span>
Domain centos7 is being <span class="token function">shutdown</span>

<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh shutdown centos7 # 关闭`centos7`虚拟机</span>
Domain centos7 is being <span class="token function">shutdown</span>

<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh destroy centos7 # 销毁`centos7`虚拟机，相当于物理机中的强制断电，既然是销毁，就必须要在运行的状态下才能销毁</span>
Domain centos7 destroyed

<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh autostart centos7 # 开机自启动`centos7`，在宿主机重启的时候自动启动虚拟机，前提条件是`libvirtd`也必须设置为开机自启动</span>
Domain centos7 marked as autostarted
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h4 id="_6-2、虚拟机信息管理"><a href="#_6-2、虚拟机信息管理" class="header-anchor">#</a> 6.2、虚拟机信息管理</h4> <p>上面说到，libvirt通过xml来定义虚拟机，我们也可以通过编辑xml来修改虚拟机的信息。</p> <div class="language-sh line-numbers-mode"><pre class="language-sh"><code><span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh define /root/kvm.xml  # 从xml文件定义虚拟机，就相当于创建虚拟机</span>
Domain centos7 defined from /root/kvm.xml

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh undefine centos7 # 取消定义`centos7`虚拟机，必须要在关机的状态下才能undefine</span>
Domain centos7 has been undefined

<span class="token punctuation">[</span>root@localhost ~<span class="token punctuation">]</span><span class="token comment"># virsh define /root/kvm.xml  # 从xml文件定义虚拟机，就相当于创建虚拟机</span>
Domain centos7-base defined from /root/kvm.xml
<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh dumpxml centos7 # 导出 `centos7` 虚拟机的xml信息，可以通过重定向将信息写入到其他文件中</span>
<span class="token operator">&lt;</span>domain <span class="token assign-left variable">type</span><span class="token operator">=</span><span class="token string">'kvm'</span><span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>name<span class="token operator">&gt;</span>centos<span class="token operator"><span class="token file-descriptor important">7</span>&lt;</span>/name<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>uuid<span class="token operator">&gt;</span>34a3f666-c4af-405a-8921-ffc5d928ae9<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>/uuid<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>memory <span class="token assign-left variable">unit</span><span class="token operator">=</span><span class="token string">'KiB'</span><span class="token operator">&gt;</span><span class="token number">419430</span><span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/memory<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>currentMemory <span class="token assign-left variable">unit</span><span class="token operator">=</span><span class="token string">'KiB'</span><span class="token operator">&gt;</span><span class="token number">419430</span><span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span>/currentMemory<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span>vcpu <span class="token assign-left variable">placement</span><span class="token operator">=</span><span class="token string">'static'</span><span class="token operator">&gt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span>/vcpu<span class="token operator">&gt;</span>
    <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.
  <span class="token operator">&lt;</span>/devices<span class="token operator">&gt;</span>
<span class="token operator">&lt;</span>/domain<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>root@localhost disk<span class="token punctuation">]</span><span class="token comment"># virsh edit centos7 # 编辑 `centos7` 虚拟机信息，编辑操作和vim操作一致，有一些唯一值信息比如`uuid`等不允许编辑。</span>
<span class="token comment"># 在保存退出时 libvirt会检查编辑后的xml是不是符合规定，如果不符合将不会被保存</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div></div></div> <div class="page-slot page-slot-bottom"><div class="donation">
  <button>打赏</button>
  <div class="main">
      <div class="pic">
          <img src="http://pic.zzppjj.top/LightPicture/2023/02/cebf13bbcea9264d.jpg" alt="微信">
          <img src="http://pic.zzppjj.top/LightPicture/2023/02/d98d15501306c7c4.jpg" alt="支付宝">
      </div>
  </div>
</div></div> <div class="page-edit"><!----> <!----> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/08/21, 07:41:35</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/pages/627008/" class="prev">wordpress迁移问题总结</a></span> <span class="next"><a href="/pages/5105a7/">argocd部署</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/a3cd2b/"><div>
            pip更换国内源
            <!----></div></a> <span class="date">07-31</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/df6e29/"><div>
            conda安装和镜像源配置
            <!----></div></a> <span class="date">07-31</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/6cb488/"><div>
            awk常用参数和使用示例
            <!----></div></a> <span class="date">07-24</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/zpj874878956" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:874878956@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://blog.zzppjj.top/rss.xml" title="订阅" target="_blank" class="iconfont icon-rss"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>| <a href="https://www.foreverblog.cn/" class="d-inline-block text-muted" target="_blank" rel="external nofollow"><img src="/img/964560013b68c2e4.png" alt="点击查看十年之约" style="width:auto;height:11px;"></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><!----><div></div><div></div><div></div></div></div>
    <script src="/assets/js/app.73676f20.js" defer></script><script src="/assets/js/4.23144ec8.js" defer></script><script src="/assets/js/1.09d67b9a.js" defer></script><script src="/assets/js/3.fc5194e0.js" defer></script><script src="/assets/js/320.a5c03bfc.js" defer></script><script src="/assets/js/38.33c96ce4.js" defer></script><script src="/assets/js/21.2c073392.js" defer></script>
  </body>
</html>
