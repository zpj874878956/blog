<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ansible入门 | 章工运维</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/img/favicon.ico">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <script language="javascript" type="text/javascript" src="/js/pgmanor-self.js"></script>
    <link rel="alternate" type="application/rss+xml" href="https://blog.zzppjj.top/rss.xml" title="章工运维 RSS Feed">
    <link rel="alternate" type="application/atom+xml" href="https://blog.zzppjj.top/feed.atom" title="章工运维 Atom Feed">
    <link rel="alternate" type="application/json" href="https://blog.zzppjj.top/feed.json" title="章工运维 JSON Feed">
    <meta name="description" content="业精于勤，荒于嬉">
    <meta name="image" content="http://pic.zzppjj.top/LightPicture/2023/04/556c50248b5a7784.jpg">
    <meta name="twitter:title" content="ansible入门">
    <meta name="twitter:description" content="">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="http://pic.zzppjj.top/LightPicture/2023/04/556c50248b5a7784.jpg">
    <meta name="twitter:url" content="https://blog.zzppjj.top/01.%E4%B8%93%E9%A2%98/01.ansible%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/01.ansible%E5%85%A5%E9%97%A8.html">
    <meta property="og:type" content="article">
    <meta property="og:title" content="ansible入门">
    <meta property="og:description" content="">
    <meta property="og:image" content="http://pic.zzppjj.top/LightPicture/2023/04/556c50248b5a7784.jpg">
    <meta property="og:url" content="https://blog.zzppjj.top/01.%E4%B8%93%E9%A2%98/01.ansible%E7%B3%BB%E5%88%97%E6%96%87%E7%AB%A0/01.ansible%E5%85%A5%E9%97%A8.html">
    <meta property="og:site_name" content="zpj">
    <meta property="article:published_time" content="2022-07-22T16:22:11.000Z">
    <meta property="article:tag" content="ansible">
    <meta itemprop="name" content="ansible入门">
    <meta itemprop="description" content="">
    <meta itemprop="image" content="http://pic.zzppjj.top/LightPicture/2023/04/556c50248b5a7784.jpg">
    <meta name="keywords" content="分享生活,分享技术,zpj,jenkins,ansible,k8s,监控">
    <meta name="theme-color" content="#11a8cd">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <link rel="preload" href="/assets/css/0.styles.2357ed77.css" as="style"><link rel="preload" href="/assets/js/app.73676f20.js" as="script"><link rel="preload" href="/assets/js/4.23144ec8.js" as="script"><link rel="preload" href="/assets/js/1.09d67b9a.js" as="script"><link rel="preload" href="/assets/js/3.fc5194e0.js" as="script"><link rel="preload" href="/assets/js/72.b6cd4d2e.js" as="script"><link rel="preload" href="/assets/js/38.33c96ce4.js" as="script"><link rel="preload" href="/assets/js/21.2c073392.js" as="script"><link rel="prefetch" href="/assets/js/10.a3e162c2.js"><link rel="prefetch" href="/assets/js/100.75d0bcb8.js"><link rel="prefetch" href="/assets/js/101.ecd83997.js"><link rel="prefetch" href="/assets/js/102.ecfd6207.js"><link rel="prefetch" href="/assets/js/103.332844d2.js"><link rel="prefetch" href="/assets/js/104.db0bde22.js"><link rel="prefetch" href="/assets/js/105.cbd4753c.js"><link rel="prefetch" href="/assets/js/106.7a5d313e.js"><link rel="prefetch" href="/assets/js/107.f3dec78b.js"><link rel="prefetch" href="/assets/js/108.52a0f936.js"><link rel="prefetch" href="/assets/js/109.27477c80.js"><link rel="prefetch" href="/assets/js/11.1f9a8151.js"><link rel="prefetch" href="/assets/js/110.bebbe66e.js"><link rel="prefetch" href="/assets/js/111.42ef7c19.js"><link rel="prefetch" href="/assets/js/112.6fe9d090.js"><link rel="prefetch" href="/assets/js/113.c9a86711.js"><link rel="prefetch" href="/assets/js/114.3503a4c3.js"><link rel="prefetch" href="/assets/js/115.14ffeec7.js"><link rel="prefetch" href="/assets/js/116.e4425551.js"><link rel="prefetch" href="/assets/js/117.bc8fd7d3.js"><link rel="prefetch" href="/assets/js/118.ca53cac0.js"><link rel="prefetch" href="/assets/js/119.b7d83b66.js"><link rel="prefetch" href="/assets/js/12.ff601b7f.js"><link rel="prefetch" href="/assets/js/120.87624e26.js"><link rel="prefetch" href="/assets/js/121.1cbece42.js"><link rel="prefetch" href="/assets/js/122.fca02497.js"><link rel="prefetch" href="/assets/js/123.20f89d6e.js"><link rel="prefetch" href="/assets/js/124.5d36a6d6.js"><link rel="prefetch" href="/assets/js/125.011309fb.js"><link rel="prefetch" href="/assets/js/126.b4637b65.js"><link rel="prefetch" href="/assets/js/127.9042b697.js"><link rel="prefetch" href="/assets/js/128.472aa291.js"><link rel="prefetch" href="/assets/js/129.c208b435.js"><link rel="prefetch" href="/assets/js/13.e19f2a21.js"><link rel="prefetch" href="/assets/js/130.de5f9c8d.js"><link rel="prefetch" href="/assets/js/131.1da85aa7.js"><link rel="prefetch" href="/assets/js/132.542a0148.js"><link rel="prefetch" href="/assets/js/133.2a6f2a0a.js"><link rel="prefetch" href="/assets/js/134.d5fa07b6.js"><link rel="prefetch" href="/assets/js/135.75648017.js"><link rel="prefetch" href="/assets/js/136.a9384568.js"><link rel="prefetch" href="/assets/js/137.f5552d23.js"><link rel="prefetch" href="/assets/js/138.eda82db2.js"><link rel="prefetch" href="/assets/js/139.be711e4c.js"><link rel="prefetch" href="/assets/js/14.a223b1b9.js"><link rel="prefetch" href="/assets/js/140.708a3fbc.js"><link rel="prefetch" href="/assets/js/141.b0b86d18.js"><link rel="prefetch" href="/assets/js/142.55bb66aa.js"><link rel="prefetch" href="/assets/js/143.2b9a4434.js"><link rel="prefetch" href="/assets/js/144.b65e75b4.js"><link rel="prefetch" href="/assets/js/145.e1c6fca8.js"><link rel="prefetch" href="/assets/js/146.d7352f00.js"><link rel="prefetch" href="/assets/js/147.e73840d8.js"><link rel="prefetch" href="/assets/js/148.e4f50f91.js"><link rel="prefetch" href="/assets/js/149.3374e168.js"><link rel="prefetch" href="/assets/js/15.403e911f.js"><link rel="prefetch" href="/assets/js/150.1b638875.js"><link rel="prefetch" href="/assets/js/151.ab5d0425.js"><link rel="prefetch" href="/assets/js/152.23993ff3.js"><link rel="prefetch" href="/assets/js/153.d1668a0e.js"><link rel="prefetch" href="/assets/js/154.4b749d4b.js"><link rel="prefetch" href="/assets/js/155.26c4c260.js"><link rel="prefetch" href="/assets/js/156.c8e6b701.js"><link rel="prefetch" href="/assets/js/157.373856e9.js"><link rel="prefetch" href="/assets/js/158.66344055.js"><link rel="prefetch" href="/assets/js/159.a69fd44e.js"><link rel="prefetch" href="/assets/js/16.6eb3aab7.js"><link rel="prefetch" href="/assets/js/160.eb9992c2.js"><link rel="prefetch" href="/assets/js/161.c5b7c124.js"><link rel="prefetch" href="/assets/js/162.c03e3856.js"><link rel="prefetch" href="/assets/js/163.72619e7f.js"><link rel="prefetch" href="/assets/js/164.5e15702b.js"><link rel="prefetch" href="/assets/js/165.33c3df23.js"><link rel="prefetch" href="/assets/js/166.4a808932.js"><link rel="prefetch" href="/assets/js/167.1a771a9e.js"><link rel="prefetch" href="/assets/js/168.807fafc8.js"><link rel="prefetch" href="/assets/js/169.44315b3f.js"><link rel="prefetch" href="/assets/js/17.bbb7c9f2.js"><link rel="prefetch" href="/assets/js/170.5c0c8eb9.js"><link rel="prefetch" href="/assets/js/171.1cbb4415.js"><link rel="prefetch" href="/assets/js/172.735a4c1a.js"><link rel="prefetch" href="/assets/js/173.86f02e67.js"><link rel="prefetch" href="/assets/js/174.4993a291.js"><link rel="prefetch" href="/assets/js/175.195bd521.js"><link rel="prefetch" href="/assets/js/176.751bd9c0.js"><link rel="prefetch" href="/assets/js/177.d1974b60.js"><link rel="prefetch" href="/assets/js/178.fc5d303d.js"><link rel="prefetch" href="/assets/js/179.9975997c.js"><link rel="prefetch" href="/assets/js/18.fca5fd29.js"><link rel="prefetch" href="/assets/js/180.f94992e7.js"><link rel="prefetch" href="/assets/js/181.340cf666.js"><link rel="prefetch" href="/assets/js/182.417bc80c.js"><link rel="prefetch" href="/assets/js/183.632e104d.js"><link rel="prefetch" href="/assets/js/184.c8ef5d1a.js"><link rel="prefetch" href="/assets/js/185.296e5bbb.js"><link rel="prefetch" href="/assets/js/186.000557d1.js"><link rel="prefetch" href="/assets/js/187.197aff5f.js"><link rel="prefetch" href="/assets/js/188.ecae5f09.js"><link rel="prefetch" href="/assets/js/189.ebfded89.js"><link rel="prefetch" href="/assets/js/19.8792dbf3.js"><link rel="prefetch" href="/assets/js/190.a710d6b1.js"><link rel="prefetch" href="/assets/js/191.a84f2ed3.js"><link rel="prefetch" href="/assets/js/192.c203907e.js"><link rel="prefetch" href="/assets/js/193.852373e5.js"><link rel="prefetch" href="/assets/js/194.db2975db.js"><link rel="prefetch" href="/assets/js/195.6c7373e8.js"><link rel="prefetch" href="/assets/js/196.45d29e92.js"><link rel="prefetch" href="/assets/js/197.ee208995.js"><link rel="prefetch" href="/assets/js/198.76c918d3.js"><link rel="prefetch" href="/assets/js/199.f05f7bdc.js"><link rel="prefetch" href="/assets/js/2.3389b8bc.js"><link rel="prefetch" href="/assets/js/20.15ba8d27.js"><link rel="prefetch" href="/assets/js/200.bf07e380.js"><link rel="prefetch" href="/assets/js/201.35bb3033.js"><link rel="prefetch" href="/assets/js/202.e14ce853.js"><link rel="prefetch" href="/assets/js/203.7f07fe7f.js"><link rel="prefetch" href="/assets/js/204.95ffddd8.js"><link rel="prefetch" href="/assets/js/205.f487b7d0.js"><link rel="prefetch" href="/assets/js/206.2b3e5a91.js"><link rel="prefetch" href="/assets/js/207.7886e90d.js"><link rel="prefetch" href="/assets/js/208.98c314e0.js"><link rel="prefetch" href="/assets/js/209.9d37ba2d.js"><link rel="prefetch" href="/assets/js/210.6e7d41e6.js"><link rel="prefetch" href="/assets/js/211.0344832b.js"><link rel="prefetch" href="/assets/js/212.8e2c9c7f.js"><link rel="prefetch" href="/assets/js/213.84efa494.js"><link rel="prefetch" href="/assets/js/214.fdcd5348.js"><link rel="prefetch" href="/assets/js/215.190febcd.js"><link rel="prefetch" href="/assets/js/216.1b0ecbf6.js"><link rel="prefetch" href="/assets/js/217.94e4a648.js"><link rel="prefetch" href="/assets/js/218.15bb6f17.js"><link rel="prefetch" href="/assets/js/219.4d86a677.js"><link rel="prefetch" href="/assets/js/22.797a9a59.js"><link rel="prefetch" href="/assets/js/220.b30cd93b.js"><link rel="prefetch" href="/assets/js/221.dc967206.js"><link rel="prefetch" href="/assets/js/222.5424cc4c.js"><link rel="prefetch" href="/assets/js/223.d35ee4d9.js"><link rel="prefetch" href="/assets/js/224.97fc8dca.js"><link rel="prefetch" href="/assets/js/225.d1d60d3d.js"><link rel="prefetch" href="/assets/js/226.71cd887d.js"><link rel="prefetch" href="/assets/js/227.7cc9c57c.js"><link rel="prefetch" href="/assets/js/228.6381caa6.js"><link rel="prefetch" href="/assets/js/229.560474e6.js"><link rel="prefetch" href="/assets/js/23.30bb92f4.js"><link rel="prefetch" href="/assets/js/230.49126632.js"><link rel="prefetch" href="/assets/js/231.591150fc.js"><link rel="prefetch" href="/assets/js/232.60ba75d5.js"><link rel="prefetch" href="/assets/js/233.0ed6ef0d.js"><link rel="prefetch" href="/assets/js/234.7d2aa21f.js"><link rel="prefetch" href="/assets/js/235.0d13696d.js"><link rel="prefetch" href="/assets/js/236.3fef4d3c.js"><link rel="prefetch" href="/assets/js/237.95e3cf9c.js"><link rel="prefetch" href="/assets/js/238.0993135b.js"><link rel="prefetch" href="/assets/js/239.27177392.js"><link rel="prefetch" href="/assets/js/24.7240c649.js"><link rel="prefetch" href="/assets/js/240.23100c38.js"><link rel="prefetch" href="/assets/js/241.805a6f9f.js"><link rel="prefetch" href="/assets/js/242.8d15a365.js"><link rel="prefetch" href="/assets/js/243.e69346ee.js"><link rel="prefetch" href="/assets/js/244.8c1aa986.js"><link rel="prefetch" href="/assets/js/245.6f55369d.js"><link rel="prefetch" href="/assets/js/246.10a3da46.js"><link rel="prefetch" href="/assets/js/247.65f2f428.js"><link rel="prefetch" href="/assets/js/248.49375e99.js"><link rel="prefetch" href="/assets/js/249.1e9d53e7.js"><link rel="prefetch" href="/assets/js/25.9b40180a.js"><link rel="prefetch" href="/assets/js/250.01f8cd00.js"><link rel="prefetch" href="/assets/js/251.ff9464cb.js"><link rel="prefetch" href="/assets/js/252.f89f8487.js"><link rel="prefetch" href="/assets/js/253.e3891186.js"><link rel="prefetch" href="/assets/js/254.9012046f.js"><link rel="prefetch" href="/assets/js/255.fde63767.js"><link rel="prefetch" href="/assets/js/256.4888bec3.js"><link rel="prefetch" href="/assets/js/257.22289df7.js"><link rel="prefetch" href="/assets/js/258.f5e12a6c.js"><link rel="prefetch" href="/assets/js/259.f227bf91.js"><link rel="prefetch" href="/assets/js/26.5fef45bc.js"><link rel="prefetch" href="/assets/js/260.7c204404.js"><link rel="prefetch" href="/assets/js/261.29e85166.js"><link rel="prefetch" href="/assets/js/262.2c9def6c.js"><link rel="prefetch" href="/assets/js/263.98afd182.js"><link rel="prefetch" href="/assets/js/264.20a44127.js"><link rel="prefetch" href="/assets/js/265.deaca7c2.js"><link rel="prefetch" href="/assets/js/266.4d0f5c1e.js"><link rel="prefetch" href="/assets/js/267.30b05762.js"><link rel="prefetch" href="/assets/js/268.2238b76d.js"><link rel="prefetch" href="/assets/js/269.9bc35400.js"><link rel="prefetch" href="/assets/js/27.83995618.js"><link rel="prefetch" href="/assets/js/270.2cf931ea.js"><link rel="prefetch" href="/assets/js/271.33bb2a38.js"><link rel="prefetch" href="/assets/js/272.5ea99ff5.js"><link rel="prefetch" href="/assets/js/273.b6aeae60.js"><link rel="prefetch" href="/assets/js/274.02c41281.js"><link rel="prefetch" href="/assets/js/275.c03bf74d.js"><link rel="prefetch" href="/assets/js/276.8bb13531.js"><link rel="prefetch" href="/assets/js/277.e835c526.js"><link rel="prefetch" href="/assets/js/278.8db0ac89.js"><link rel="prefetch" href="/assets/js/279.b01f6f0b.js"><link rel="prefetch" href="/assets/js/28.5539ac79.js"><link rel="prefetch" href="/assets/js/280.58bf36ea.js"><link rel="prefetch" href="/assets/js/281.b093e33b.js"><link rel="prefetch" href="/assets/js/282.0afb811a.js"><link rel="prefetch" href="/assets/js/283.57d16abf.js"><link rel="prefetch" href="/assets/js/284.fed63bdb.js"><link rel="prefetch" href="/assets/js/285.3e281284.js"><link rel="prefetch" href="/assets/js/286.5fd82441.js"><link rel="prefetch" href="/assets/js/287.576684d7.js"><link rel="prefetch" href="/assets/js/288.5e1ddc82.js"><link rel="prefetch" href="/assets/js/289.c9665bb4.js"><link rel="prefetch" href="/assets/js/29.b7aeafd2.js"><link rel="prefetch" href="/assets/js/290.fea19ce6.js"><link rel="prefetch" href="/assets/js/291.7d306a45.js"><link rel="prefetch" href="/assets/js/292.d16a085d.js"><link rel="prefetch" href="/assets/js/293.a2ba2f0f.js"><link rel="prefetch" href="/assets/js/294.d855cbd9.js"><link rel="prefetch" href="/assets/js/295.0100374c.js"><link rel="prefetch" href="/assets/js/296.7be2d9ee.js"><link rel="prefetch" href="/assets/js/297.a4c0465d.js"><link rel="prefetch" href="/assets/js/298.1db5d5c2.js"><link rel="prefetch" href="/assets/js/299.38d8457c.js"><link rel="prefetch" href="/assets/js/30.fc6b86f2.js"><link rel="prefetch" href="/assets/js/300.1ba015d8.js"><link rel="prefetch" href="/assets/js/301.35b2e6ba.js"><link rel="prefetch" href="/assets/js/302.429cb0ec.js"><link rel="prefetch" href="/assets/js/303.8c006780.js"><link rel="prefetch" href="/assets/js/304.ca3d5644.js"><link rel="prefetch" href="/assets/js/305.84329278.js"><link rel="prefetch" href="/assets/js/306.45b281a2.js"><link rel="prefetch" href="/assets/js/307.be05fe98.js"><link rel="prefetch" href="/assets/js/308.80655fac.js"><link rel="prefetch" href="/assets/js/309.d0bca0f4.js"><link rel="prefetch" href="/assets/js/31.4b15d755.js"><link rel="prefetch" href="/assets/js/310.9674b6bd.js"><link rel="prefetch" href="/assets/js/311.6804abea.js"><link rel="prefetch" href="/assets/js/312.ab5a2f8b.js"><link rel="prefetch" href="/assets/js/313.b2fea146.js"><link rel="prefetch" href="/assets/js/314.a4369eb5.js"><link rel="prefetch" href="/assets/js/315.b3b11ac9.js"><link rel="prefetch" href="/assets/js/316.8785a926.js"><link rel="prefetch" href="/assets/js/317.a6abd001.js"><link rel="prefetch" href="/assets/js/318.5089ee03.js"><link rel="prefetch" href="/assets/js/319.fa74b2cc.js"><link rel="prefetch" href="/assets/js/32.d80ffae2.js"><link rel="prefetch" href="/assets/js/320.a5c03bfc.js"><link rel="prefetch" href="/assets/js/321.5e4dcfe8.js"><link rel="prefetch" href="/assets/js/322.23c23832.js"><link rel="prefetch" href="/assets/js/323.4ac1fe2e.js"><link rel="prefetch" href="/assets/js/324.301c9e00.js"><link rel="prefetch" href="/assets/js/325.82fff4a0.js"><link rel="prefetch" href="/assets/js/326.d653ce14.js"><link rel="prefetch" href="/assets/js/327.9d4e295a.js"><link rel="prefetch" href="/assets/js/328.aff8c1bd.js"><link rel="prefetch" href="/assets/js/329.dce67ef0.js"><link rel="prefetch" href="/assets/js/33.0a4b28c8.js"><link rel="prefetch" href="/assets/js/330.8ee58260.js"><link rel="prefetch" href="/assets/js/331.766ca988.js"><link rel="prefetch" href="/assets/js/332.2cef316c.js"><link rel="prefetch" href="/assets/js/333.5c1e99cd.js"><link rel="prefetch" href="/assets/js/334.8ef63e12.js"><link rel="prefetch" href="/assets/js/335.2a615cdf.js"><link rel="prefetch" href="/assets/js/336.b255636f.js"><link rel="prefetch" href="/assets/js/337.aeddf147.js"><link rel="prefetch" href="/assets/js/338.cf24395e.js"><link rel="prefetch" href="/assets/js/339.ae7ee883.js"><link rel="prefetch" href="/assets/js/34.bb8cbe99.js"><link rel="prefetch" href="/assets/js/340.f5e5e10b.js"><link rel="prefetch" href="/assets/js/341.60065767.js"><link rel="prefetch" href="/assets/js/342.880f2c51.js"><link rel="prefetch" href="/assets/js/343.47928836.js"><link rel="prefetch" href="/assets/js/344.317ead2b.js"><link rel="prefetch" href="/assets/js/345.a922de9a.js"><link rel="prefetch" href="/assets/js/346.b0e6bbb0.js"><link rel="prefetch" href="/assets/js/347.23210924.js"><link rel="prefetch" href="/assets/js/348.4cbe7dfd.js"><link rel="prefetch" href="/assets/js/349.bc36d23d.js"><link rel="prefetch" href="/assets/js/35.13e5c204.js"><link rel="prefetch" href="/assets/js/350.78ff49df.js"><link rel="prefetch" href="/assets/js/351.98baa8d7.js"><link rel="prefetch" href="/assets/js/352.dafe3072.js"><link rel="prefetch" href="/assets/js/353.3a6adbb4.js"><link rel="prefetch" href="/assets/js/354.00d0f928.js"><link rel="prefetch" href="/assets/js/355.934b4c3e.js"><link rel="prefetch" href="/assets/js/356.67857703.js"><link rel="prefetch" href="/assets/js/357.8ab62a9b.js"><link rel="prefetch" href="/assets/js/358.e06b5e02.js"><link rel="prefetch" href="/assets/js/359.5ca9d976.js"><link rel="prefetch" href="/assets/js/36.3ae18163.js"><link rel="prefetch" href="/assets/js/360.38cf065b.js"><link rel="prefetch" href="/assets/js/361.84c5e0ca.js"><link rel="prefetch" href="/assets/js/362.dbf28682.js"><link rel="prefetch" href="/assets/js/363.9d7bac1a.js"><link rel="prefetch" href="/assets/js/364.6f9aaa6c.js"><link rel="prefetch" href="/assets/js/365.76e0b937.js"><link rel="prefetch" href="/assets/js/366.958065e0.js"><link rel="prefetch" href="/assets/js/367.62fe05e9.js"><link rel="prefetch" href="/assets/js/368.52e42cf5.js"><link rel="prefetch" href="/assets/js/369.be5a8e9d.js"><link rel="prefetch" href="/assets/js/37.efb2744c.js"><link rel="prefetch" href="/assets/js/370.4926d8c5.js"><link rel="prefetch" href="/assets/js/371.2aadb305.js"><link rel="prefetch" href="/assets/js/372.dcb47317.js"><link rel="prefetch" href="/assets/js/373.99d87a09.js"><link rel="prefetch" href="/assets/js/374.1d37ebf9.js"><link rel="prefetch" href="/assets/js/375.040f7228.js"><link rel="prefetch" href="/assets/js/376.4e06867e.js"><link rel="prefetch" href="/assets/js/377.27d9e275.js"><link rel="prefetch" href="/assets/js/378.8d3c34d7.js"><link rel="prefetch" href="/assets/js/379.67dba2a0.js"><link rel="prefetch" href="/assets/js/380.c1836db3.js"><link rel="prefetch" href="/assets/js/381.3497ba24.js"><link rel="prefetch" href="/assets/js/382.d041ea4d.js"><link rel="prefetch" href="/assets/js/39.031f1004.js"><link rel="prefetch" href="/assets/js/40.7376f5a0.js"><link rel="prefetch" href="/assets/js/41.d0e792da.js"><link rel="prefetch" href="/assets/js/42.246f9e60.js"><link rel="prefetch" href="/assets/js/43.95799058.js"><link rel="prefetch" href="/assets/js/44.ad27a9ff.js"><link rel="prefetch" href="/assets/js/45.0b4092a6.js"><link rel="prefetch" href="/assets/js/46.0012a2ef.js"><link rel="prefetch" href="/assets/js/47.e4b364de.js"><link rel="prefetch" href="/assets/js/48.40886536.js"><link rel="prefetch" href="/assets/js/49.cb7bc92d.js"><link rel="prefetch" href="/assets/js/5.d7fd577a.js"><link rel="prefetch" href="/assets/js/50.6c993145.js"><link rel="prefetch" href="/assets/js/51.fd053414.js"><link rel="prefetch" href="/assets/js/52.3dd8f9c6.js"><link rel="prefetch" href="/assets/js/53.81b89f42.js"><link rel="prefetch" href="/assets/js/54.a7a1880d.js"><link rel="prefetch" href="/assets/js/55.4cf210c4.js"><link rel="prefetch" href="/assets/js/56.c0ed7408.js"><link rel="prefetch" href="/assets/js/57.2a7659d5.js"><link rel="prefetch" href="/assets/js/58.c322ef28.js"><link rel="prefetch" href="/assets/js/59.4544e7b8.js"><link rel="prefetch" href="/assets/js/6.45776bb3.js"><link rel="prefetch" href="/assets/js/60.919fca3f.js"><link rel="prefetch" href="/assets/js/61.faddc5df.js"><link rel="prefetch" href="/assets/js/62.29428be6.js"><link rel="prefetch" href="/assets/js/63.f496aeee.js"><link rel="prefetch" href="/assets/js/64.d6826e8b.js"><link rel="prefetch" href="/assets/js/65.b4163fb2.js"><link rel="prefetch" href="/assets/js/66.58d152d7.js"><link rel="prefetch" href="/assets/js/67.a6dac763.js"><link rel="prefetch" href="/assets/js/68.90c252f7.js"><link rel="prefetch" href="/assets/js/69.d041ba69.js"><link rel="prefetch" href="/assets/js/7.831c92c6.js"><link rel="prefetch" href="/assets/js/70.b1b69cc5.js"><link rel="prefetch" href="/assets/js/71.b99b548a.js"><link rel="prefetch" href="/assets/js/73.615eba63.js"><link rel="prefetch" href="/assets/js/74.444d9de5.js"><link rel="prefetch" href="/assets/js/75.ffd9da23.js"><link rel="prefetch" href="/assets/js/76.84d4fa46.js"><link rel="prefetch" href="/assets/js/77.eedc1376.js"><link rel="prefetch" href="/assets/js/78.7095885b.js"><link rel="prefetch" href="/assets/js/79.48c95cb9.js"><link rel="prefetch" href="/assets/js/80.8f42ea9f.js"><link rel="prefetch" href="/assets/js/81.521ca7da.js"><link rel="prefetch" href="/assets/js/82.ecb175b7.js"><link rel="prefetch" href="/assets/js/83.e121013d.js"><link rel="prefetch" href="/assets/js/84.1c1a3c28.js"><link rel="prefetch" href="/assets/js/85.7e914dee.js"><link rel="prefetch" href="/assets/js/86.9585ccde.js"><link rel="prefetch" href="/assets/js/87.36363a25.js"><link rel="prefetch" href="/assets/js/88.db15b19f.js"><link rel="prefetch" href="/assets/js/89.20df314c.js"><link rel="prefetch" href="/assets/js/90.8df91573.js"><link rel="prefetch" href="/assets/js/91.5a7d83c5.js"><link rel="prefetch" href="/assets/js/92.9b428b1a.js"><link rel="prefetch" href="/assets/js/93.c50f82ea.js"><link rel="prefetch" href="/assets/js/94.6813fd20.js"><link rel="prefetch" href="/assets/js/95.942ec555.js"><link rel="prefetch" href="/assets/js/96.53a215ae.js"><link rel="prefetch" href="/assets/js/97.0c2c5e6a.js"><link rel="prefetch" href="/assets/js/98.88fccd9a.js"><link rel="prefetch" href="/assets/js/99.a61ea740.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.26b542fc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.2357ed77.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="http://pic.zzppjj.top/LightPicture/2023/03/c818c3c19bf7c336.png" alt="章工运维" class="logo"> <span class="site-name can-hide">章工运维</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/ops/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/windows/" class="nav-link">windows</a></li><li class="dropdown-item"><!----> <a href="/middleware/" class="nav-link">中间件</a></li><li class="dropdown-item"><!----> <a href="/monitor/" class="nav-link">监控</a></li><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/storage/" class="nav-link">存储</a></li><li class="dropdown-item"><!----> <a href="/safety/" class="nav-link">安全</a></li><li class="dropdown-item"><!----> <a href="/firewalld/" class="nav-link">防火墙</a></li><li class="dropdown-item"><!----> <a href="/db/" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/sys/" class="nav-link">系统</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">运维工具</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">other</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专题" class="dropdown-title"><a href="/topic/" class="link-title">专题</a> <span class="title" style="display:none;">专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/elk/" class="nav-link">elk</a></li><li class="dropdown-item"><!----> <a href="/k8s/" class="nav-link">K8S</a></li><li class="dropdown-item"><!----> <a href="/ansible/" class="nav-link">ansible</a></li><li class="dropdown-item"><!----> <a href="/jenkins/" class="nav-link">Jenkins</a></li><li class="dropdown-item"><!----> <a href="/gitlabci/" class="nav-link">GitLabCI_CD</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><a href="/life/" class="link-title">生活</a> <span class="title" style="display:none;">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/suibi/" class="nav-link">随笔</a></li><li class="dropdown-item"><!----> <a href="/mianshi/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/gongju/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/favorites/" class="nav-link">收藏夹</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><a href="/code/" class="link-title">编程</a> <span class="title" style="display:none;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/shell/" class="nav-link">Shell</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">golang</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/nav/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://pic.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图床
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://artalk.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  评论
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.zzppjj.top/download/light/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  下载站点
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zpj874878956" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="http://pic.zzppjj.top/LightPicture/2023/02/c7ac9de8fb6cfb17.jpg"> <div class="blogger-info"><h3>章工运维</h3> <span>业精于勤，荒于嬉</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="运维" class="dropdown-title"><a href="/ops/" class="link-title">运维</a> <span class="title" style="display:none;">运维</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/linux/" class="nav-link">linux</a></li><li class="dropdown-item"><!----> <a href="/windows/" class="nav-link">windows</a></li><li class="dropdown-item"><!----> <a href="/middleware/" class="nav-link">中间件</a></li><li class="dropdown-item"><!----> <a href="/monitor/" class="nav-link">监控</a></li><li class="dropdown-item"><!----> <a href="/network/" class="nav-link">网络</a></li><li class="dropdown-item"><!----> <a href="/storage/" class="nav-link">存储</a></li><li class="dropdown-item"><!----> <a href="/safety/" class="nav-link">安全</a></li><li class="dropdown-item"><!----> <a href="/firewalld/" class="nav-link">防火墙</a></li><li class="dropdown-item"><!----> <a href="/db/" class="nav-link">数据库</a></li><li class="dropdown-item"><!----> <a href="/sys/" class="nav-link">系统</a></li><li class="dropdown-item"><!----> <a href="/docker/" class="nav-link">docker</a></li><li class="dropdown-item"><!----> <a href="/tool/" class="nav-link">运维工具</a></li><li class="dropdown-item"><!----> <a href="/other/" class="nav-link">other</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专题" class="dropdown-title"><a href="/topic/" class="link-title">专题</a> <span class="title" style="display:none;">专题</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/elk/" class="nav-link">elk</a></li><li class="dropdown-item"><!----> <a href="/k8s/" class="nav-link">K8S</a></li><li class="dropdown-item"><!----> <a href="/ansible/" class="nav-link">ansible</a></li><li class="dropdown-item"><!----> <a href="/jenkins/" class="nav-link">Jenkins</a></li><li class="dropdown-item"><!----> <a href="/gitlabci/" class="nav-link">GitLabCI_CD</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="生活" class="dropdown-title"><a href="/life/" class="link-title">生活</a> <span class="title" style="display:none;">生活</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/suibi/" class="nav-link">随笔</a></li><li class="dropdown-item"><!----> <a href="/mianshi/" class="nav-link">面试</a></li><li class="dropdown-item"><!----> <a href="/gongju/" class="nav-link">工具</a></li><li class="dropdown-item"><!----> <a href="/favorites/" class="nav-link">收藏夹</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="编程" class="dropdown-title"><a href="/code/" class="link-title">编程</a> <span class="title" style="display:none;">编程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/shell/" class="nav-link">Shell</a></li><li class="dropdown-item"><!----> <a href="/python/" class="nav-link">python</a></li><li class="dropdown-item"><!----> <a href="/go/" class="nav-link">golang</a></li></ul></div></div><div class="nav-item"><a href="/about/" class="nav-link">关于</a></div><div class="nav-item"><a href="/friends/" class="nav-link">友链</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="页面" class="dropdown-title"><a href="/nav/" class="link-title">页面</a> <span class="title" style="display:none;">页面</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>索引</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/categories/" class="nav-link">分类</a></li><li class="dropdown-subitem"><a href="/tags/" class="nav-link">标签</a></li><li class="dropdown-subitem"><a href="/archives/" class="nav-link">归档</a></li></ul></li><li class="dropdown-item"><h4></h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="https://www.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  首页
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://pic.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  图床
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://artalk.zzppjj.top" target="_blank" rel="noopener noreferrer" class="nav-link external">
  评论
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li><li class="dropdown-subitem"><a href="https://www.zzppjj.top/download/light/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  下载站点
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></div></div><div class="nav-item"><a href="https://www.travellings.cn/go.html" target="_blank" rel="noopener noreferrer" class="nav-link external">
  开往
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zpj874878956" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>ansible系列文章</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/pages/12c5da01/" aria-current="page" class="active sidebar-link">ansible入门</a><ul class="sidebar-sub-headers"></ul></li><li><a href="/pages/f8f66c/" class="sidebar-link">anisble批量安装node_exporter</a></li><li><a href="/pages/d740bc/" class="sidebar-link">ansible-playbook中的变量</a></li><li><a href="/pages/a06506/" class="sidebar-link">Ansible性能优化——提升ansible执行效率</a></li><li><a href="/pages/847542/" class="sidebar-link">ansible之roles简单使用</a></li><li><a href="/pages/4189b8/" class="sidebar-link">ansible中template简单使用</a></li><li><a href="/pages/14eda9/" class="sidebar-link">playbook详解</a></li><li><a href="/pages/7eca6b/" class="sidebar-link">ansible-playbook编排使用tips</a></li><li><a href="/pages/4fbba1/" class="sidebar-link">ansible优秀案例</a></li><li><a href="/pages/a97e1b/" class="sidebar-link">如何优雅向chatgpt提问ansible相关问题</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kubernetes笔记</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>elk</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>jenkins</span> <span class="arrow right"></span></p> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>GitLabCI_CD</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/topic/#专题" data-v-06225672>专题</a></li><li data-v-06225672><a href="/topic/#ansible系列文章" data-v-06225672>ansible系列文章</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/zpj874878956" target="_blank" title="作者" class="beLink" data-v-06225672>章工运维</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2022-07-22</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABKFJREFUSA3tVl1oFVcQnrMbrak3QUgkya1akpJYcrUtIqW1JvFBE9LiQ5v6JmJpolbMg32rVrhgoYK0QiMY6i9Y6EMaW5D+xFJaTYItIuK2Kr3+BJNwkxBj05sQY3b3nM6cs2dv9t7NT/vQJw/sndk5M/PNzJkzewGerP+pAmy+ON8lLzUJgA8ZYxYIYZmGYRnctDaWvJJAmTtfP1pvXsBCCPP8QFcCaRkZYACgDZFO4stNIcBCajEOlmmC9XpJ9bAGCaPaPmzPl32dvLSVu3BWCTQs0XQQ6g0DYgwLIoAZbBCdW/i+781o1VVlm/410mw4h06Y7bIPHNyWDyL4FHkX03Q8SrzNhZTZriieckWt7cL6MM85YcLpsi/7O9/iXFT6MswI0DmmpkSaJ0qLxFIm3+i1THHB3zmBH3PYx9CcykcLOeQVVa7QtdxTgQgEleX2AjHYfwA+2ddV77ruGoJUbhGDI09YSNXyMpUt5ylOzxgbUmtOp7NmbNt8v3arjTBfYELmLUV+M+nSawNNAUqpT3ClJWg5I3BLT+cGW/DXNGCa6tx1aakCGEigArTn4TDIPdrXXYKCZNrHLMCOEPvHBlLQ99s9eHB7EB6NTki73CVPQ2F5MSx/uRQixfmq7rK0wYD8w8E905bnPDfwoWs/rfv93NWN/ZfvwsLIU7A09gxECyISeGJkHAau98L97tuw7NXnoPyNF8FcYGLGKsOs0mN3OEyec9esGW/ZEl945dTP34wlR2FZVQWU1q0Cw8Tr7p+hgLLNL0FPxx/Q35mA8aEUrH6nCgwEl0tn7wUiZYJnNRh6DK4UH/k0lfyrsBKdPVv/AriGIQcEDQZ65LBAGe2Rzui9Ybjz7XUppz1/uKBbyVPGkN3ZAeC6hr0x7Nr38N5+EqkoOm17xpoqR9ohQF55ERSvr4Dkr3chNfC3DMzGJlNBElW8w9nsGQvhNGIzDkXzCg8cLK951xHsFBlTJspJNi3ZFIMF2AeDV3q8DNOB+YHi6QTrChDIWDBRi5U5f+ZMfJLu3ccrqxtdxk4SKH336LFxSmkqefwU5T8fhdSdQf9IVKD6aNiwI/hnmcAZ91isYMJIaCUCx9W098+LgruikeTqzqqxKPUwqJyCPJiyemVVZBOijDGjD38Os0jOiSPL1z3SPjXNANbiNPXAdzTfukjjuknNBbyz3nwgTd3AVFqUJ5hpHlq9MveLnWwttUfoygBmvVjuikxND3znrhsELnZk7k+OjIGxeNEkomyLVta0xxn+HZhjBc4YZ/AFjHjz9u3xRZl2BN4aq9nFwWh16IrQ1aHHEd3j1+4/dB9OtH4e29A2H1DyHQRmOSfQZ1Fy7MHBTGB6J/Djq6p3OxyO2cB+4Car7v/o3GXgfAkj23+x9ID1Teoamo/SXcbvSf2PX7Vc8DdCmE1vN9di+32P9/5YR3vLnhCVGUWBjEkr3yh4H8v9CzmsbdhzOKzsJKM90iFdaTMjRPhGVsakRvOaRidljo6H6G7j+ctrJpsP+4COhDIl0La2+FS4+5mlocBaXY5QnGZysIBYoeSsl5qQzrSj/cgNrfuEzlWBfwA+EjrZyWUvpAAAAABJRU5ErkJggg==">ansible入门<!----></h1>  <div class="theme-vdoing-content content__default"><p>原文链接：https://www.cnblogs.com/lvzhenjiang/p/14199445.html</p> <h1 id="ansible入门"><a href="#ansible入门" class="header-anchor">#</a> <a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html" target="_blank" rel="noopener noreferrer">ansible入门<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></h1> <p>目录</p> <ul><li>一、Ansible基础概述
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#11--%E4%BB%80%E4%B9%88%E6%98%AFansible" target="_blank" rel="noopener noreferrer">1.1 什么是Ansible<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#12-ansible-%E5%8F%AF%E4%BB%A5%E5%AE%8C%E6%88%90%E5%93%AA%E4%BA%9B%E5%8A%9F%E8%83%BD" target="_blank" rel="noopener noreferrer">1.2 Ansible 可以完成哪些功能<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#13-ansible%E7%89%B9%E7%82%B9" target="_blank" rel="noopener noreferrer">1.3 Ansible特点<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#14-ansible%E7%9A%84%E6%9E%B6%E6%9E%84%E4%B8%AD%E7%9A%84%E6%8E%A7%E5%88%B6%E8%8A%82%E7%82%B9%E3%80%81%E8%A2%AB%E6%8E%A7%E5%88%B6%E8%8A%82%E7%82%B9%E3%80%81inventory%E3%80%81ad-hoc%E3%80%81playbook%E3%80%81%E8%BF%9E%E6%8E%A5%E5%8D%8F%E8%AE%AE%E8%BF%99%E4%BA%9B%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F" target="_blank" rel="noopener noreferrer">1.4 Ansible的架构中的控制节点、被控制节点、inventory、ad-hoc、playbook、连接协议这些是什么？<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>二、Ansible安装配置
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#21-ansible%E5%AE%89%E8%A3%85" target="_blank" rel="noopener noreferrer">2.1 ansible安装<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>三、Ansible inventory
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#31-%E5%9C%BA%E6%99%AF%E4%B8%80%EF%BC%9A%E5%9F%BA%E4%BA%8E%E5%AF%86%E7%A0%81%E8%BF%9E%E6%8E%A5" target="_blank" rel="noopener noreferrer">3.1 场景一：基于密码连接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#32-%E5%9C%BA%E6%99%AF%E4%BA%8C%EF%BC%9A%E5%9F%BA%E4%BA%8E%E7%A7%98%E9%92%A5%E8%BF%9E%E6%8E%A5" target="_blank" rel="noopener noreferrer">3.2 场景二：基于秘钥连接<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#33-%E5%9C%BA%E6%99%AF%E4%B8%89%EF%BC%9A%E4%B8%BB%E6%9C%BA%E7%BB%84%E4%BD%BF%E7%94%A8%E6%96%B9%E5%BC%8F" target="_blank" rel="noopener noreferrer">3.3 场景三：主机组使用方式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#34-%E5%88%97%E5%87%BA%E6%AF%8F%E4%B8%AA%E4%B8%BB%E6%9C%BA%E7%BB%84%E4%B8%8B%E9%9D%A2%E7%9A%84%E4%B8%BB%E6%9C%BA%E6%83%85%E5%86%B5" target="_blank" rel="noopener noreferrer">3.4 列出每个主机组下面的主机情况<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>四、Ansible ad-hoc
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#41-%E4%BB%80%E4%B9%88%E6%98%AFad-hoc" target="_blank" rel="noopener noreferrer">4.1 什么是ad-hoc<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#42-ad-hocm%E6%A8%A1%E5%BC%8F%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF" target="_blank" rel="noopener noreferrer">4.2 ad-hocm模式的使用场景<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#43-ad-hoc%E6%A8%A1%E5%BC%8F%E7%9A%84%E5%91%BD%E4%BB%A4%E4%BD%BF%E7%94%A8" target="_blank" rel="noopener noreferrer">4.3 ad-hoc模式的命令使用<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#44-%E4%BD%BF%E7%94%A8ad-doc%E6%8C%87%E5%AE%9A%E4%B8%80%E6%AC%A1%E8%BF%9C%E7%A8%8B%E5%91%BD%E4%BB%A4%EF%BC%8C%E6%B3%A8%E6%84%8F%E8%A7%82%E5%AF%9F%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C%E7%9A%84%E9%A2%9C%E8%89%B2" target="_blank" rel="noopener noreferrer">4.4 使用ad-doc指定一次远程命令，注意观察返回结果的颜色<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#45-ad-hoc%E5%B8%B8%E7%94%A8%E7%9A%84%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">4.5 ad-hoc常用的模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#46-%E4%BD%BF%E7%94%A8%E8%BF%87%E7%A8%8B%E4%B8%AD%E9%9C%80%E8%A6%81%E5%85%88%E4%BA%86%E8%A7%A3anisble-doc%E5%B8%AE%E5%8A%A9%E6%89%8B%E5%86%8C" target="_blank" rel="noopener noreferrer">4.6 使用过程中需要先了解anisble-doc帮助手册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>五、ansibel 模块
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#51-yum%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.1 yum模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#52-copy%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.2 copy模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#53-file%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.3 file模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#54-get_url%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.4 get_url模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#55-service%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.5 service模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#56-group%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.6 group模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#57-user%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.7 user模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#58-cron%E6%A8%A1%E5%9D%97" target="_blank" rel="noopener noreferrer">5.8 cron模块<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#59-mount" target="_blank" rel="noopener noreferrer">5.9 mount<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#510-firewalld" target="_blank" rel="noopener noreferrer">5.10 firewalld<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>六、Ansible playbook
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#61-%E4%BB%80%E4%B9%88%E6%98%AFplaybook" target="_blank" rel="noopener noreferrer">6.1 什么是playbook<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#62-ansible-playbook%E4%B8%8Ead-hoc%E7%9A%84%E5%85%B3%E7%B3%BB" target="_blank" rel="noopener noreferrer">6.2 Ansible playbook与ad-hoc的关系<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#63-ansible-playbook%E4%B9%A6%E5%86%99%E6%A0%BC%E5%BC%8F" target="_blank" rel="noopener noreferrer">6.3 Ansible playbook书写格式<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>七、变量
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#71-%E5%8F%98%E9%87%8F%E6%A6%82%E8%BF%B0" target="_blank" rel="noopener noreferrer">7.1 变量概述<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#72-%E5%8F%98%E9%87%8F%E5%AE%9A%E4%B9%89" target="_blank" rel="noopener noreferrer">7.2 变量定义<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#73-%E5%8F%98%E9%87%8F%E6%B3%A8%E5%86%8C" target="_blank" rel="noopener noreferrer">7.3 变量注册<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#74-facts%E5%8F%98%E9%87%8F" target="_blank" rel="noopener noreferrer">7.4 facts变量<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>八、Ansible Task 任务控制
<ul><li>8.1 piaybook条件语句
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%B8%80%EF%BC%9A%E6%A0%B9%E6%8D%AE%E4%B8%8D%E5%90%8C%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%EF%BC%8C%E5%AE%89%E8%A3%85%E7%9B%B8%E5%90%8C%E7%9A%84%E8%BD%AF%E4%BB%B6%E5%8C%85" target="_blank" rel="noopener noreferrer">案例一：根据不同操作系统，安装相同的软件包<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%BA%8C%EF%BC%9A%E4%B8%BA%E6%89%80%E6%9C%89web%E4%B8%BB%E6%9C%BA%E5%90%8D%E7%9A%84%E6%B7%BB%E5%8A%A0nginx%E4%BB%93%E5%BA%93%EF%BC%8C%E5%85%B6%E4%BD%99%E7%9A%84%E9%83%BD%E8%B7%B3%E8%BF%87%E6%B7%BB%E5%8A%A0" target="_blank" rel="noopener noreferrer">案例二：为所有web主机名的添加nginx仓库，其余的都跳过添加<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%B8%89%EF%BC%9A%E6%A0%B9%E6%8D%AE%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E7%9A%84%E7%BB%93%E6%9E%9C%E8%BF%9B%E8%A1%8C%E5%88%A4%E6%96%AD" target="_blank" rel="noopener noreferrer">案例三：根据命令执行的结果进行判断<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>8.2 playbook循环语句
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%B8%80%EF%BC%9A-%E4%BD%BF%E7%94%A8%E5%BE%AA%E7%8E%AF%E5%90%AF%E5%8A%A8%E5%A4%9A%E4%B8%AA%E6%9C%8D%E5%8A%A1" target="_blank" rel="noopener noreferrer">案例一： 使用循环启动多个服务<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%BA%8C%EF%BC%9A-%E4%BD%BF%E7%94%A8%E5%AD%97%E5%85%B8%E6%89%B9%E9%87%8F%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7" target="_blank" rel="noopener noreferrer">案例二： 使用字典批量创建用户<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%B8%89%EF%BC%9A-%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F%E5%AD%97%E5%85%B8%E5%BE%AA%E7%8E%AF%E7%9A%84%E6%96%B9%E5%BC%8F%E6%8B%B7%E8%B4%9D%E6%96%87%E4%BB%B6" target="_blank" rel="noopener noreferrer">案例三： 使用变量字典循环的方式拷贝文件<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>8.3 playbook handlers
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%EF%BC%9Aplaybook%E5%AE%89%E8%A3%85nginx" target="_blank" rel="noopener noreferrer">案例：playbook安装nginx<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>8.4 playbook tag
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%EF%BC%9A" target="_blank" rel="noopener noreferrer">案例：<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li>8.5 playbook include
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%EF%BC%9A" target="_blank" rel="noopener noreferrer">案例：<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#86-ignore_errors%E5%BF%BD%E7%95%A5%E9%94%99%E8%AF%AF" target="_blank" rel="noopener noreferrer">8.6 ignore_errors忽略错误<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li>8.7 playbook错误处理
<ul><li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%B8%80%EF%BC%9Atask%E6%89%A7%E8%A1%8C%E5%A4%B1%E8%B4%A5%E5%BC%BA%E5%88%B6%E8%B0%83%E7%94%A8handlers" target="_blank" rel="noopener noreferrer">案例一：task执行失败强制调用handlers<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%BA%8C%EF%BC%9A-%E5%85%B3%E9%97%ADchange%E7%9A%84%E7%8A%B6%E6%80%81%EF%BC%88%E7%A1%AE%E5%AE%9A%E4%B8%8D%E4%BC%9A%E5%AF%B9%E8%A2%AB%E6%8E%A7%E7%AB%AF%E4%B8%BB%E6%9C%BA%E8%BF%9B%E8%A1%8C%E4%BB%BB%E4%BD%95%E7%9A%84%E4%BF%AE%E6%94%B9%E5%92%8C%E5%8F%98%E6%9B%B4%EF%BC%89" target="_blank" rel="noopener noreferrer">案例二： 关闭change的状态（确定不会对被控端主机进行任何的修改和变更）<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.cnblogs.com/lvzhenjiang/p/14199445.html#%E6%A1%88%E4%BE%8B%E4%B8%89%EF%BC%9A-%E4%BD%BF%E7%94%A8changed_when%E6%A3%80%E6%9F%A5tasksrre%E4%BB%BB%E5%8A%A1%E8%BF%94%E5%9B%9E%E7%BB%93%E6%9E%9C" target="_blank" rel="noopener noreferrer">案例三： 使用changed_when检查tasksrre任务返回结果<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></li></ul></li></ul> <h3 id="一、ansible基础概述"><a href="#一、ansible基础概述" class="header-anchor">#</a> 一、Ansible基础概述</h3> <h4 id="_1-1-什么是ansible"><a href="#_1-1-什么是ansible" class="header-anchor">#</a> 1.1 什么是Ansible</h4> <p>Ansible是一个IT自动化的配置管理工具，自动化主要体现在Ansible集成了丰富模块、丰富的功能组件，可以通过一个命令完成一系列的操作。进而减少我们重复性的工作和维护成本，以提高工作效率！</p> <h4 id="_1-2-ansible-可以完成哪些功能"><a href="#_1-2-ansible-可以完成哪些功能" class="header-anchor">#</a> 1.2 Ansible 可以完成哪些功能</h4> <ul><li>批量执行远程命令，可以对N多台主机同时进行命令的执行；</li> <li>批量配置软件服务，可以进行自动化的方式配置和管理服务；</li> <li>实现软件开发功能，Jumpserver底层使用ansible来实现的自动化管理；</li> <li>编排高级的IT任务，Ansible的Playbook是一门编程语言，可以用来描绘一套IT架构；</li></ul> <h4 id="_1-3-ansible特点"><a href="#_1-3-ansible特点" class="header-anchor">#</a> 1.3 Ansible特点</h4> <ul><li>容易学习，无代理模式，不像saltstack既要学习客户端与服务端，还要学习客户端与服务端中间通信协议；</li> <li>操作灵活，体现在Ansible有较多的模块，提供了丰富的功能、playbook则提供类似于编程语言的复杂功能；</li> <li>简单复用，体现在Ansible一个命令可以完成很多事情；</li> <li>安全可靠，因为Ansible使用了SSH协议进行通信，既稳定也安全；</li> <li>移植性高，可以将写好的playbook拷贝任意机器进行执行；</li></ul> <h4 id="_1-4-ansible的架构中的控制节点、被控制节点、inventory、ad-hoc、playbook、连接协议这些是什么"><a href="#_1-4-ansible的架构中的控制节点、被控制节点、inventory、ad-hoc、playbook、连接协议这些是什么" class="header-anchor">#</a> 1.4 Ansible的架构中的控制节点、被控制节点、inventory、ad-hoc、playbook、连接协议这些是什么？</h4> <p><img src="http://pic.zzppjj.top/LightPicture/2023/04/556c50248b5a7784.jpg" alt="556c50248b5a7784.jpg"></p> <h3 id="二、ansible安装配置"><a href="#二、ansible安装配置" class="header-anchor">#</a> 二、Ansible安装配置</h3> <h4 id="_2-1-ansible安装"><a href="#_2-1-ansible安装" class="header-anchor">#</a> 2.1 ansible安装</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">wget</span> <span class="token parameter variable">-O</span> /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo
$ yum <span class="token function">install</span> ansible <span class="token parameter variable">-y</span>
$ ansible <span class="token parameter variable">--version</span>
ansible <span class="token number">2.9</span>.10
  config <span class="token function">file</span> <span class="token operator">=</span> /etc/ansible/ansible.cfg
  configured module search path <span class="token operator">=</span> <span class="token punctuation">[</span>u<span class="token string">'/root/.ansible/plugins/modules'</span>, u<span class="token string">'/usr/share/ansible/plugins/modules'</span><span class="token punctuation">]</span>
  ansible python module location <span class="token operator">=</span> /usr/lib/python2.7/site-packages/ansible
  executable location <span class="token operator">=</span> /usr/bin/ansible
  python version <span class="token operator">=</span> <span class="token number">2.7</span>.5 <span class="token punctuation">(</span>default, Nov <span class="token number">20</span> <span class="token number">2015</span>, 02:00:19<span class="token punctuation">)</span> <span class="token punctuation">[</span>GCC <span class="token number">4.8</span>.5 <span class="token number">20150623</span> <span class="token punctuation">(</span>Red Hat <span class="token number">4.8</span>.5-4<span class="token punctuation">)</span><span class="token punctuation">]</span>

$ ansible <span class="token operator">&lt;</span>host-pattern<span class="token operator">&gt;</span> <span class="token punctuation">[</span>option<span class="token punctuation">]</span>
--version: <span class="token comment"># ansible版本信息</span>
-v：显示详细信息
-i：主机清单文件路径，默认是/etc/ansibel/hosts
-m：使用的模块的名称，默认使用command模块
-a：使用的模块参数，模块的具体工作
-k：提示输入ssh密码，而不使用基于ssh的秘钥认证
-C：模拟执行测试，但不会真的执行
-T：指定命令的超时时间
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>ansible配置文件优先级顺序：</strong></p> <ul><li>最先查找$ANSIBLE_CONFIG变量；</li> <li>其次查找当前目录下ansible.cfg</li> <li>然后查找用户家目录下的.ansible.cfg</li> <li>最后查找/etc/ansible/ansible.cfg（默认）</li></ul> <h3 id="三、ansible-inventory"><a href="#三、ansible-inventory" class="header-anchor">#</a> 三、Ansible inventory</h3> <p><code>Inventory</code>文件中填写需要被管理主机与主机组信息（逻辑上定义）。默认<code>Inventory</code>文件在<code>/etc/ansible/hosts</code>。当然也可以自定义，然后使用<code>-i</code>指定<code>Inventory</code>文件位置：示例：</p> <h4 id="_3-1-场景一-基于密码连接"><a href="#_3-1-场景一-基于密码连接" class="header-anchor">#</a> 3.1 场景一：基于密码连接</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">cat</span> /etc/ansible/hosts

<span class="token comment"># 方法一</span>
<span class="token punctuation">[</span>webservers<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.225 <span class="token assign-left variable">ansible_ssh_port</span><span class="token operator">=</span><span class="token number">22</span> <span class="token assign-left variable">ansible_ssh_user</span><span class="token operator">=</span>root <span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123456'</span>
<span class="token number">192.168</span>.100.226 <span class="token assign-left variable">ansible_ssh_port</span><span class="token operator">=</span><span class="token number">22</span> <span class="token assign-left variable">ansible_ssh_user</span><span class="token operator">=</span>root <span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123456'</span>

<span class="token comment"># 方法二</span>
<span class="token punctuation">[</span>webservers<span class="token punctuation">]</span>
web<span class="token punctuation">[</span><span class="token number">1</span>:2<span class="token punctuation">]</span>.lzj.com <span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123456'</span>

<span class="token comment"># 方法三</span>
<span class="token punctuation">[</span>webservers<span class="token punctuation">]</span>
web<span class="token punctuation">[</span><span class="token number">1</span>:2<span class="token punctuation">]</span>.lzj.com
<span class="token punctuation">[</span>webservers：vars<span class="token punctuation">]</span>
<span class="token assign-left variable">ansible_ssh_pass</span><span class="token operator">=</span><span class="token string">'123456'</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><h4 id="_3-2-场景二-基于秘钥连接"><a href="#_3-2-场景二-基于秘钥连接" class="header-anchor">#</a> 3.2 场景二：基于秘钥连接</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ ssh-keygen
$ ssh-copy-id <span class="token number">192.168</span>.100.225
$ ssh-copy-id <span class="token number">192.168</span>.100.226
$ <span class="token function">mkdir</span> project1/ <span class="token operator">&amp;&amp;</span> <span class="token builtin class-name">cd</span> project1/
$ <span class="token function">vim</span> hosts
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.225
<span class="token number">192.168</span>.100.226
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">ping</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h4 id="_3-3-场景三-主机组使用方式"><a href="#_3-3-场景三-主机组使用方式" class="header-anchor">#</a> 3.3 场景三：主机组使用方式</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token punctuation">[</span>lbservers<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.221
<span class="token number">192.168</span>.100.222

<span class="token punctuation">[</span>webservers<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.223
<span class="token number">192.168</span>.100.224

<span class="token punctuation">[</span>servers:children<span class="token punctuation">]</span>    <span class="token comment"># 定义servers组包含两个子组（lbservers、webservers）</span>
lbservers
webservers
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h4 id="_3-4-列出每个主机组下面的主机情况"><a href="#_3-4-列出每个主机组下面的主机情况" class="header-anchor">#</a> 3.4 列出每个主机组下面的主机情况</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ ansible all <span class="token parameter variable">-i</span> hosts --list-hosts
  hosts <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>:
    <span class="token number">192.168</span>.100.225
    <span class="token number">192.168</span>.100.226
$ ansible web <span class="token parameter variable">-i</span> hosts --list-hosts
  hosts <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>:
    <span class="token number">192.168</span>.100.225
    <span class="token number">192.168</span>.100.226
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="四、ansible-ad-hoc"><a href="#四、ansible-ad-hoc" class="header-anchor">#</a> 四、Ansible ad-hoc</h3> <h4 id="_4-1-什么是ad-hoc"><a href="#_4-1-什么是ad-hoc" class="header-anchor">#</a> 4.1 什么是ad-hoc</h4> <p><code>ad-hoc</code>就是临时命令，执行完成后就结束，并不会保存！</p> <h4 id="_4-2-ad-hocm模式的使用场景"><a href="#_4-2-ad-hocm模式的使用场景" class="header-anchor">#</a> 4.2 ad-hocm模式的使用场景</h4> <p>比如在多台机器上查看某个进程是否启动，或拷贝指定文件到本地，等等！</p> <h4 id="_4-3-ad-hoc模式的命令使用"><a href="#_4-3-ad-hoc模式的命令使用" class="header-anchor">#</a> 4.3 ad-hoc模式的命令使用</h4> <table><thead><tr><th>命令格式</th> <th>ansible</th> <th>zpj</th> <th>-m</th> <th>command</th> <th>-a</th> <th>'df -h'</th></tr></thead> <tbody><tr><td>格式说明</td> <td>命令</td> <td>主机名称</td> <td>指定模块</td> <td>模块名称</td> <td>模块动作</td> <td>具体命令</td></tr></tbody></table> <h4 id="_4-4-使用ad-doc指定一次远程命令-注意观察返回结果的颜色"><a href="#_4-4-使用ad-doc指定一次远程命令-注意观察返回结果的颜色" class="header-anchor">#</a> 4.4 使用ad-doc指定一次远程命令，注意观察返回结果的颜色</h4> <ul><li>绿色：表示被管理主机没有被修改；</li> <li>黄色：表示被管理端主机发现变更；</li> <li>红色：表示出现了故障，注意查看提示；</li></ul> <h4 id="_4-5-ad-hoc常用的模块"><a href="#_4-5-ad-hoc常用的模块" class="header-anchor">#</a> 4.5 ad-hoc常用的模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token builtin class-name">command</span>            <span class="token comment"># 指定shell命令（不支持管道等特殊字符）</span>
shell            <span class="token comment"># 执行shell命令</span>
scripts            <span class="token comment"># 执行shell脚本</span>
yum_repository    <span class="token comment"># 配置yum仓库</span>
yum                <span class="token comment"># 安装软件</span>
copy            <span class="token comment"># 变更配置文件</span>
<span class="token function">file</span>            <span class="token comment"># 建立目录或文件</span>
<span class="token function">service</span>            <span class="token comment"># 启动、停止服务</span>
<span class="token function">mount</span>            <span class="token comment"># 挂载设备</span>
<span class="token function">cron</span>            <span class="token comment"># 定时任务</span>
firewalld        <span class="token comment"># 防火墙</span>
get_url            <span class="token comment"># 下载软件</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_4-6-使用过程中需要先了解anisble-doc帮助手册"><a href="#_4-6-使用过程中需要先了解anisble-doc帮助手册" class="header-anchor">#</a> 4.6 使用过程中需要先了解anisble-doc帮助手册</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ ansible-doc <span class="token parameter variable">-l</span>        <span class="token comment"># 查看所有模块说明</span>
$ ansible-doc copy        <span class="token comment"># 表示指定模块方法</span>
$ ansible-doc <span class="token parameter variable">-s</span> copy    <span class="token comment"># 表示指定模块参数</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><h3 id="五、ansibel-模块"><a href="#五、ansibel-模块" class="header-anchor">#</a> 五、ansibel 模块</h3> <h4 id="_5-1-yum模块"><a href="#_5-1-yum模块" class="header-anchor">#</a> 5.1 yum模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 安装当前最新的Apache软件，如果存在则更新</span>
$ ansible web <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=latest&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 安装当前最新的Apache软件，通过epel安装</span>
$ ansible web <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=present enablerepo=epel&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 通过公网URL安装rpm软件</span>
$ ansible web <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">&quot;name=https://mirrors4.tuna.tsinghua.edu.cn/zabbix/zabbix/4.0/rhel/7/x86_64/zabbix-agent-4.0.0-2.el7.x86_64.rpm state=present&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例四：更新所有的软件包，但排除和kernel相关的</span>
$ ansible web <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">&quot;name=&quot;</span>*<span class="token string">&quot; state=present exclude=&quot;</span>kernel*<span class="token string">&quot; -i hosts

# 示例五： 删除Apache软件
$  ansible web -m yum -a &quot;</span><span class="token assign-left variable">name</span><span class="token operator">=</span>httpd <span class="token assign-left variable">state</span><span class="token operator">=</span>absent&quot; <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_5-2-copy模块"><a href="#_5-2-copy模块" class="header-anchor">#</a> 5.2 copy模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 将本地的httpd.conf文件Listen 端口修改为9999，然后推送到远程主机</span>
$ <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/Listen 80/Listen 9999/g'</span> httpd.conf
$ ansible web <span class="token parameter variable">-m</span> copy <span class="token parameter variable">-a</span> <span class="token string">&quot;src=httpd.conf dest=/etc/httpd/conf/httpd.conf owner=root group=root mode-644&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 将本地的httpd.conf文件Listen端口修改为9988，然后推送到远端，检查远端是否存在上次备份的文件</span>
$ <span class="token function">sed</span> <span class="token parameter variable">-i</span> <span class="token string">'s/Listen 9999/Listen 9988/g'</span> httpd.conf
$ ansible web <span class="token parameter variable">-m</span> copy <span class="token parameter variable">-a</span> <span class="token string">&quot;src=httpd.conf dest=/etc/httpd/conf/httpd.conf owner=root group=root mode=644 backup=yes&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 往远程的主机文件写入内容</span>
$ ansible web <span class="token parameter variable">-m</span> copy <span class="token parameter variable">-a</span> <span class="token string">&quot;content=123456........ dest=/var/www/html/index.html&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_5-3-file模块"><a href="#_5-3-file模块" class="header-anchor">#</a> 5.3 file模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 创建文件，并设置属主、属组、权限</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;path=/var/www/html/t1.html state=touch owner=apache group=apache mode=644&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 创建目录，并设置属主、属组、权限</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;path=/var/www/html/dd state=directory owner=apache group=apache mode=755&quot;</span> <span class="token parameter variable">-i</span> hosts
<span class="token comment"># 示例三：递归授权目录的方式</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;path=/var/www/html state=directory owner=apache group=apache recurse=yes&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_5-4-get-url模块"><a href="#_5-4-get-url模块" class="header-anchor">#</a> 5.4 get_url模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 下载互联网的软件到本地</span>
$ ansible web <span class="token parameter variable">-m</span> get_url <span class="token parameter variable">-a</span> <span class="token string">&quot;url=http://192.168.99.181:12138/document/Ansible.docx dest=/root/&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 下载互联网文件并进行mds校验</span>
$ md5sum Ansible.docx      <span class="token comment"># 获取文件md5值</span>
7b1a6fe7af7252005987e16ce64e1e1a  Ansible.docx
$ ansible web <span class="token parameter variable">-m</span> get_url <span class="token parameter variable">-a</span> <span class="token string">&quot;url=http://192.168.99.181:12138/document/Ansible.docx dest=/root/ checksum=md5:7b1a6fe7af7252005987e16ce64e1e1a&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h4 id="_5-5-service模块"><a href="#_5-5-service模块" class="header-anchor">#</a> 5.5 service模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 启动httpd服务</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=started&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 重载httpd服务</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=reloaded&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 重启httpd服务</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=restarted&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例四： 停止httpd服务</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=stopped&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例五： 启动httpd服务，并加入开机自启</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=httpd state=started enabled=yes&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_5-6-group模块"><a href="#_5-6-group模块" class="header-anchor">#</a> 5.6 group模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 创建news基本组，指定gid为9999</span>
$ ansible web <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">&quot;name=news gid=9999 state=present&quot;</span>
 <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 创建http系统组，指定gid为8888</span>
$ ansible web <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">&quot;name=http gid=8888  state=present
 system=yes&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 删除test基本组</span>
$ ansible web <span class="token parameter variable">-m</span> group <span class="token parameter variable">-a</span> <span class="token string">&quot;name=test state=absent&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_5-7-user模块"><a href="#_5-7-user模块" class="header-anchor">#</a> 5.7 user模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 创建job用户，uid是1040，主要组是adm</span>
$ ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">&quot;name=job uid=1040 group=adm&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 创建joh用户，登录shell是/sbin/nologin，追加bin、sys两个组</span>
$ ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">&quot;name=joh groups=bin,sys shell=/sbin/nologin&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 创建jsm用户，为其添加123作为登录密码，并创建家目录</span>
$ ansible localhost <span class="token parameter variable">-m</span> debug <span class="token parameter variable">-a</span> <span class="token string">&quot;msg={{ '123' | password_hash('sha512','salt') }}&quot;</span>
<span class="token comment"># 获取123加密后的字符串</span>
<span class="token variable">$6</span><span class="token variable">$salt</span><span class="token variable">$jkHSO0tOjmLW0S1NFlw5veSIDRAVsiQQMTrkOKy4xdCCLPNIsHhZkIRlzfzIvKyXeGdOfCBoW1wJZPLyQ9Qx</span>/1

$ ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">'name=jsm password=$6$salt$jkHSO0tOjmLW0S1NFlw5veSIDRAVsiQQMTrkOKy4xdCCLPNIsHhZkIRlzfzIvKyXeGdOfCBoW1wJZPLyQ9Qx/1 create_home=yes'</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例四： 移除job用户</span>
$ ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">&quot;name=job state=absent remove=yes&quot;</span> <span class="token parameter variable">-i</span> hosts
<span class="token comment"># remove=yes删除普通用户家目录</span>

<span class="token comment"># 示例五： 创建http用户，并为该用户创建2048字节的私钥，存放在~/http/.ssh/id_rsa</span>
$ ansible web <span class="token parameter variable">-m</span> user <span class="token parameter variable">-a</span> <span class="token string">&quot;name=http generate_ssh_key=yes ssh_key_bits=2048 ssh_key_file=.ssh/id_rsa&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h4 id="_5-8-cron模块"><a href="#_5-8-cron模块" class="header-anchor">#</a> 5.8 cron模块</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 添加定时任务，每分钟执行一次ls</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=job1 job='ls &gt; /dev/null'&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 添加定时任务，每天的凌晨2点和凌晨5点执行一次ls</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=job2 job='ls &gt; /dev/null' minute=0 hour=2,5&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 关闭定时任务，使定时任务失败</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">cron</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=job2 job='ls &gt; /dev/null' minute=0 hour=2,5 disabled=yes&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_5-9-mount"><a href="#_5-9-mount" class="header-anchor">#</a> 5.9 mount</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 环境准备：</span>
$ ansible localhost <span class="token parameter variable">-m</span> yum <span class="token parameter variable">-a</span> <span class="token string">&quot;name=nfs-utils state=present&quot;</span> 
$ ansible localhost <span class="token parameter variable">-m</span> <span class="token function">file</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;path=/ops state=directory&quot;</span>
$ ansible localhost <span class="token parameter variable">-m</span> copy <span class="token parameter variable">-a</span> <span class="token string">'content=&quot;/ops 192.168.100.1/24(rw,sync)&quot; dest=/etc/exports'</span>
$ ansible localhost <span class="token parameter variable">-m</span> <span class="token function">service</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;name=nfs state=restarted&quot;</span>

<span class="token comment"># 示例一： 挂载nfs存储到本地的/opt目录，并实现开机自动挂载</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;src=192.168.99.181:/ops path=/opt fstype=nfs opts=defaults state=mounted&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 临时卸载nfs的挂载，但不会清理/etc/fstab</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;src=192.168.99.181:/ops path=/opt fstype=nfs opts=defaults state=unmounted&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 永久卸载ns的挂载，清理/etc/fstab</span>
$ ansible web <span class="token parameter variable">-m</span> <span class="token function">mount</span> <span class="token parameter variable">-a</span> <span class="token string">&quot;src=192.168.99.181:/ops path=/opt fstype=nfs opts=defaults state=absent&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h4 id="_5-10-firewalld"><a href="#_5-10-firewalld" class="header-anchor">#</a> 5.10 firewalld</h4> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 示例一： 永久放行https的流量，只有重启才生效</span>
$ ansible web <span class="token parameter variable">-m</span> firewalld <span class="token parameter variable">-a</span> <span class="token string">&quot;zone=public service=https permanent=yes state=enabled&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例二： 永久放行8081端口的流量，只有重启才生效</span>
$ ansible web <span class="token parameter variable">-m</span> firewalld <span class="token parameter variable">-a</span> <span class="token string">&quot;zone=public port=8081/tcp permanent=yes state=enabled&quot;</span> <span class="token parameter variable">-i</span> hosts

<span class="token comment"># 示例三： 放行8080-8090的所有的tcp端口流量，临时和永久都生效</span>
$ ansible web <span class="token parameter variable">-m</span> firewalld <span class="token parameter variable">-a</span> <span class="token string">&quot;zone=public port=8080-8090/tcp immediate=yes permanent=yes state=enabled&quot;</span> <span class="token parameter variable">-i</span> hosts
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h3 id="六、ansible-playbook"><a href="#六、ansible-playbook" class="header-anchor">#</a> 六、Ansible playbook</h3> <h4 id="_6-1-什么是playbook"><a href="#_6-1-什么是playbook" class="header-anchor">#</a> 6.1 什么是playbook</h4> <ul><li>playbook：定义了一个文本文件，以.yml为后缀结尾；</li> <li>play：定义的是主机的角色；</li> <li>task：定义的是具体执行的任务；</li></ul> <p>总结：playbook是由一个多个多个play组成，一个play可以包含多个task任务。可以理解为：使用不同的模块来共同完成一件事情！</p> <div class="language- extra-class"><pre><code>---
#### 6.2 Ansible playbook与ad-hoc的关系
</code></pre></div><ul><li>playbook是对ad-hoc的一种编排方式；</li> <li>playbook可以持久运行，而ad-hoc只能临时运行；</li> <li>playbook适合复杂的任务，而ad-hoc适合做快速简单的任务；</li> <li>playbook能控制任务执行的先后顺序；</li></ul> <h4 id="_6-3-ansible-playbook书写格式"><a href="#_6-3-ansible-playbook书写格式" class="header-anchor">#</a> 6.3 Ansible playbook书写格式</h4> <p>playbook是由yaml语法书写，结构清晰、可读性强。所以必须掌握yaml基础语法！</p> <table><thead><tr><th>语法</th> <th>概述</th></tr></thead> <tbody><tr><td>缩进</td> <td>YAML使用固定的缩进风格表示层级结构，每个缩进由两个空格组成，不能使用ta键</td></tr> <tr><td>冒号</td> <td>以冒号结尾的除外，其他所有冒号后面所有必须有空格</td></tr> <tr><td>短横线</td> <td>表示列表项，使用一个短横杠加一个空格。多个项使用同样的缩进级别作为统一列表</td></tr></tbody></table> <h3 id="七、变量"><a href="#七、变量" class="header-anchor">#</a> 七、变量</h3> <h4 id="_7-1-变量概述"><a href="#_7-1-变量概述" class="header-anchor">#</a> 7.1 变量概述</h4> <p>变量提供了便捷的方式来管理ansible项目中的动态值，比如：nginx-1.12，可能后期会反复的使用这个版本的值，那么如果将此值设置为变量，后续使用和修改都将变得非常方便。这样可以简化项目的创建和维护。</p> <p>那么在ansible中定义变量分为以下三种方式：</p> <ul><li>通过命令行进行变量定义；</li> <li>在play文件中进行定义变量；</li> <li>通过Inventory在主机组或单个主机中设置变量；</li></ul> <p>如果定义的变量出现重复，且造成冲突，怎么办？谁说了算？</p> <h4 id="_7-2-变量定义"><a href="#_7-2-变量定义" class="header-anchor">#</a> 7.2 变量定义</h4> <p>1、在playbook的文件开头通过vars关键字进行变量定义</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">web_packages</span><span class="token punctuation">:</span> httpd
    <span class="token punctuation">-</span> <span class="token key atrule">ftp_packages</span><span class="token punctuation">:</span> vsftpd

  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Rpm Packages &quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> web_packages <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot; &quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> ftp_packages <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot;
      <span class="token key atrule">yum</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;{{ web_packages }}&quot;</span>
          <span class="token punctuation">-</span> <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
        <span class="token key atrule">state</span><span class="token punctuation">:</span> present
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><p>2、可以在playbook中使用<code>vars_files</code>指定文件作为变量文件，好处就是其他的playbook也可以调用</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1）准备一个变量的文件，建议使用yml格式</span>
$ <span class="token function">cat</span> vars.yml
web_packages: httpd
ftp_packages: vsftpd

<span class="token comment"># 2）准备playbook进行调用</span>
$ <span class="token function">cat</span> test.yml
- hosts: web
  vars_files:
    - vars.yml
  tasks:
    - name: Install Rpm Packages <span class="token string">&quot;{{ web_packages }}&quot;</span> <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
      yum:
        name:
          - <span class="token string">&quot;{{ web_packages }}&quot;</span>
          - <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
        state: present
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>3、在Inventory主机清单中定义变量，但是注意：主机变量优先级高于主机组变量</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1）在Inventory主机清单中对主机组进行定义变量</span>
$ <span class="token function">cat</span> hosts
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.225
<span class="token number">192.168</span>.100.226

<span class="token punctuation">[</span>web:vars<span class="token punctuation">]</span>
<span class="token assign-left variable">filename</span><span class="token operator">=</span>group_vars

<span class="token comment"># 2）playbook中直接调用变量</span>
$ <span class="token function">cat</span> test.yml
- hosts: web
  tasks:
    - name: Create File
      file:
        name: /tmp/<span class="token punctuation">{</span><span class="token punctuation">{</span> filename<span class="token punctuation">}</span><span class="token punctuation">}</span>
        state: <span class="token function">touch</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><p>4、官方建议是在ansible项目目录中创建两个额外的变量目录，分别是<code>host_vars</code>和<code>group_vars</code></p> <ul><li>测试<code>group_vars</code>定义变量方式</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">cat</span> hosts
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.225
<span class="token number">192.168</span>.100.226

<span class="token comment"># 1）在当前的项目目录中创建两个变量的目录</span>
$ <span class="token function">mkdir</span> <span class="token punctuation">{</span>group,host<span class="token punctuation">}</span>_vars

<span class="token comment"># 2）在group_vars目录中创建一个文件，文件名与Inventory清单中的主机组名称要保持一致</span>
$ <span class="token function">cat</span> group_vars/web
web_packages: <span class="token function">wget</span>
ftp_packages: tree

<span class="token comment"># 3）编写playbook，只需在playbook中使用变量即可</span>
$ <span class="token function">cat</span> test.yml
- hosts: web
  tasks:
    - name: Install Rpm Packages <span class="token string">&quot;{{ web_packages }}&quot;</span> <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
      yum:
        name:
          - <span class="token string">&quot;{{ web_packages }}&quot;</span>
          - <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
        state: present
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><p><strong>测试test组能否使用web组定义的变量，无法使用！但是系统提供了特殊的all组，也就是说<code>group_vars</code>目录下创建一个all文件，定义变量对所有的主机都生效！</strong></p> <ul><li>测试<code>host_vars</code>定义变量方式</li></ul> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1）在host_vars目录创建一个文件，文件名与Inventory清单中的主机名称要保持一致，如果是IP地址，则创建相同的IP</span>
$ <span class="token function">cat</span> hosts
<span class="token punctuation">[</span>web<span class="token punctuation">]</span>
<span class="token number">192.168</span>.100.225
<span class="token number">192.168</span>.100.226

<span class="token comment"># 2）在host_vars目录中创建文件，给192.168.100.225主机定义变量</span>
$ <span class="token function">cat</span> host_vars/192.168.100.225
web_packages: zlib-static
ftp_packages: zmap

<span class="token comment"># 3）转别一个playbook文件调用host主机变量</span>
$ <span class="token function">cat</span> test.yml
- hosts: <span class="token number">192.168</span>.100.225
  tasks:
    - name: Install Rpm Packages <span class="token string">&quot;{{ web_packages }}&quot;</span> <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
      yum:
        name:
          - <span class="token string">&quot;{{ web_packages }}&quot;</span>
          - <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
        state: present
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>5、通过命令行<code>-extra-vars</code>或<code>-e</code>外置穿餐设定变量</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 1）准备playbook文件</span>
$ <span class="token function">cat</span> test.yml
- hosts: <span class="token string">&quot;{{ host }}&quot;</span>
  tasks:
    - name: Install Rpm Packages <span class="token string">&quot;{{ web_packages }}&quot;</span> <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
      yum:
        name:
          - <span class="token string">&quot;{{ web_packages }}&quot;</span>
          - <span class="token string">&quot;{{ ftp_packages }}&quot;</span>
        state: present

<span class="token comment"># 2）执行playbook时进行变量的传递</span>
$ ansible-playbook <span class="token parameter variable">-i</span> hosts test.yml <span class="token parameter variable">-e</span> <span class="token string">&quot;host=web&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><p>6、变量的优先级顺序：</p> <p>命令行变量——&gt;paly中的vars_files——&gt;paly中的vars——&gt;host_vars——&gt;group_vars/all</p> <h4 id="_7-3-变量注册"><a href="#_7-3-变量注册" class="header-anchor">#</a> 7.3 变量注册</h4> <p><code>register</code>关键字可以将某个task任务结果存储至变量中，最后使用debug输出变量内容，可以用于后续排查故障！</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> system status
      <span class="token key atrule">shell</span><span class="token punctuation">:</span> netstat <span class="token punctuation">-</span>lntp
      <span class="token key atrule">register</span><span class="token punctuation">:</span> System_Status

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> System Status
      <span class="token key atrule">debug</span><span class="token punctuation">:</span> msg=&quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> System_Status.stdout_lines <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h4 id="_7-4-facts变量"><a href="#_7-4-facts变量" class="header-anchor">#</a> 7.4 facts变量</h4> <p>Ansible facts是在被管理主机上通过ansible自动采集发现的变量。facts包含每台特定的主机信息。比如：被控端主机的主机名、IP地址、系统版本、CPU数量、内存状态、磁盘状态等等。</p> <p>默认情况的facts变量名都已经预先定义好了，只需要采集被控端的信息，然后传递至facts变量即可！</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code> $ ansible web <span class="token parameter variable">-m</span> setup <span class="token parameter variable">-i</span> hosts <span class="token operator">&gt;</span> facts.txt
 <span class="token comment"># 获取所有的facts变量</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>facts变量使用场景：</p> <ul><li><p>通过facts变量检查被控端主机硬件CPU信息，从而生成不同的Nginx配置文件；</p></li> <li><p>通过facts变量检查被控端主机名称信息，从而生成不同的zabbix配置文件；</p></li> <li><p>通过facts变量检查被控端主机内存状态信息，从而生成不同的memcached配置文件；</p> <p>………………</p></li></ul> <p>1、facts基本用法：比如获取被控端的主机名和IP地址，然后通过debug输出</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> OutPut variables ansible facts
      <span class="token key atrule">debug</span><span class="token punctuation">:</span>
        <span class="token key atrule">msg</span><span class="token punctuation">:</span> this default IPv4 address &quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> ansible_fqdn <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot; is &quot;<span class="token punctuation">{</span><span class="token punctuation">{</span> ansible_default_ipv4.address <span class="token punctuation">}</span><span class="token punctuation">}</span>&quot;
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>2、facts开启后会影响Ansible主机的性能，如果没有采集被控端主机需求可选择关闭</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">gather_facts</span><span class="token punctuation">:</span> no    <span class="token comment"># 关闭信息采集</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h3 id="八、ansible-task-任务控制"><a href="#八、ansible-task-任务控制" class="header-anchor">#</a> 八、Ansible Task 任务控制</h3> <h4 id="_8-1-piaybook条件语句"><a href="#_8-1-piaybook条件语句" class="header-anchor">#</a> 8.1 piaybook条件语句</h4> <p>判断在Ansible任务中的使用频率非常高，比如yum模块可以检测软件包是否已经被安装，而在这个过程中我们不用做太多的人工干预。但是也有部分任务需要进行判断。</p> <h5 id="案例一-根据不同操作系统-安装相同的软件包"><a href="#案例一-根据不同操作系统-安装相同的软件包" class="header-anchor">#</a> 案例一：根据不同操作系统，安装相同的软件包</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Centos Install Httpd
      <span class="token key atrule">yum</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> httpd
        <span class="token key atrule">state</span><span class="token punctuation">:</span> present
      <span class="token key atrule">when</span><span class="token punctuation">:</span> ( ansible_distribution == &quot;CentOS&quot; )
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h5 id="案例二-为所有web主机名的添加nginx仓库-其余的都跳过添加"><a href="#案例二-为所有web主机名的添加nginx仓库-其余的都跳过添加" class="header-anchor">#</a> 案例二：为所有web主机名的添加nginx仓库，其余的都跳过添加</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Create YUM Repo
      <span class="token key atrule">yum_repository</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> ansible_nginx
        <span class="token key atrule">description</span><span class="token punctuation">:</span> ansible_test
        <span class="token key atrule">baseurl</span><span class="token punctuation">:</span> http<span class="token punctuation">:</span>//nginx.org/packages/centos/$releasever/$basearch/
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> yes
        <span class="token key atrule">gpgcheck</span><span class="token punctuation">:</span> no
      <span class="token key atrule">when</span><span class="token punctuation">:</span> ( ansible_fqdn is match(&quot;web<span class="token important">*&quot;)</span> )

<span class="token comment"># 当然when也可以使用and与or方式</span>
<span class="token comment"># when： ( ansible_fqdn is match(&quot;web*&quot;) ) or</span>
<span class="token comment">#         ( ansible_fqdn is match(&quot;lb*&quot;) )</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h5 id="案例三-根据命令执行的结果进行判断"><a href="#案例三-根据命令执行的结果进行判断" class="header-anchor">#</a> 案例三：根据命令执行的结果进行判断</h5> <p>通过register将命令执行结果保存至变量，然后通过when语句进行判断</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Check Httpd Server
      <span class="token key atrule">command</span><span class="token punctuation">:</span> systemctl is<span class="token punctuation">-</span>active httpd
      <span class="token key atrule">ignore_errors</span><span class="token punctuation">:</span> yes        <span class="token comment"># 忽略错误</span>
      <span class="token key atrule">register</span><span class="token punctuation">:</span> check_httpd

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Httpd Restart        <span class="token comment"># 如果check_httpd执行命令结果等于0，则重启httpd,否则跳过</span>
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> httpd
        <span class="token key atrule">state</span><span class="token punctuation">:</span> restarted
      <span class="token key atrule">when</span><span class="token punctuation">:</span> check_httpd.rc == 0
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_8-2-playbook循环语句"><a href="#_8-2-playbook循环语句" class="header-anchor">#</a> 8.2 playbook循环语句</h4> <p>有时候我们写playbook的时候会发现了很多task都要重复引用某个模块，比如一次启动10个服务，或者一个拷贝10个文件。如果安装传统的写法最少要写10次，这样会显得playbook很臃肿。如果使用循环的方式来编写playbokk，这样可以减少重复使用某个模块！</p> <h5 id="案例一-使用循环启动多个服务"><a href="#案例一-使用循环启动多个服务" class="header-anchor">#</a> 案例一： 使用循环启动多个服务</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Service Start
      <span class="token key atrule">service</span><span class="token punctuation">:</span> 
        <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item }}&quot;</span>
        <span class="token key atrule">state</span><span class="token punctuation">:</span> started
      <span class="token key atrule">with_items</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> httpd
        <span class="token punctuation">-</span> sshd
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><h5 id="案例二-使用字典批量创建用户"><a href="#案例二-使用字典批量创建用户" class="header-anchor">#</a> 案例二： 使用字典批量创建用户</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Add Users
      <span class="token key atrule">user</span><span class="token punctuation">:</span> 
        <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.name }}&quot;</span>
        <span class="token key atrule">group</span><span class="token punctuation">:</span> <span class="token string">&quot;{{item.group }}&quot;</span>
        <span class="token key atrule">state</span><span class="token punctuation">:</span> present
      <span class="token key atrule">with_items</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'test01'</span><span class="token punctuation">,</span><span class="token key atrule">group</span><span class="token punctuation">:</span> <span class="token string">'bin'</span> <span class="token punctuation">}</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> <span class="token string">'test02'</span><span class="token punctuation">,</span><span class="token key atrule">group</span><span class="token punctuation">:</span> <span class="token string">'root'</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h5 id="案例三-使用变量字典循环的方式拷贝文件"><a href="#案例三-使用变量字典循环的方式拷贝文件" class="header-anchor">#</a> 案例三： 使用变量字典循环的方式拷贝文件</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy File
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.src }}&quot;</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.dest }}&quot;</span>
        <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.mode }}&quot;</span>
      <span class="token key atrule">with_items</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">'rsync.conf'</span> <span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">'/tmp/rsync.conf'</span> <span class="token punctuation">,</span> <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">644</span> <span class="token punctuation">}</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">'rsync.pass'</span> <span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">'/tmp/rsync.pass'</span> <span class="token punctuation">,</span> <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">600</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>高级写法(变量套变量)：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> all
  <span class="token key atrule">vars</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">Path</span><span class="token punctuation">:</span> /tmp
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy File
      <span class="token key atrule">copy</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.src }}&quot;</span>
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.dest }}&quot;</span>
        <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ item.mode }}&quot;</span>
      <span class="token key atrule">with_items</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">'rsync.conf'</span> <span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">'{{ Path }}/rsync.conf'</span> <span class="token punctuation">,</span> <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">644</span> <span class="token punctuation">}</span>
        <span class="token punctuation">-</span> <span class="token punctuation">{</span> <span class="token key atrule">src</span><span class="token punctuation">:</span> <span class="token string">'rsync.pass'</span> <span class="token punctuation">,</span> <span class="token key atrule">dest</span><span class="token punctuation">:</span> <span class="token string">'{{ Path }}/rsync.pass'</span> <span class="token punctuation">,</span> <span class="token key atrule">mode</span><span class="token punctuation">:</span> <span class="token number">600</span> <span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h4 id="_8-3-playbook-handlers"><a href="#_8-3-playbook-handlers" class="header-anchor">#</a> 8.3 playbook handlers</h4> <p>handlers是一个触发器，也是一个tasks，只不过是一个特殊的tasks，它是需要被tasks触发才会执行。只要配置文件发生变更，则会触发handlers执行重启服务操作，如果配置文件不发生任何变化，则不会重启！
notify监控——&gt;通知——&gt;handlers触发</p> <h5 id="案例-playbook安装nginx"><a href="#案例-playbook安装nginx" class="header-anchor">#</a> 案例：playbook安装nginx</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Instll Nginx
    <span class="token key atrule">yum</span><span class="token punctuation">:</span> 
      <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
      <span class="token key atrule">state</span><span class="token punctuation">:</span> present

  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy Nignx.conf
    <span class="token key atrule">template</span><span class="token punctuation">:</span>
      <span class="token key atrule">src</span><span class="token punctuation">:</span> nginx.conf.j2
      <span class="token key atrule">dest</span><span class="token punctuation">:</span> /etc/nginx/nginx.conf
    <span class="token key atrule">notify</span><span class="token punctuation">:</span> Restart Nignx Service

  <span class="token key atrule">handlers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restart Nignx Service
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">state</span><span class="token punctuation">:</span> restarted
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><strong>handlers注意事项：</strong></p> <ul><li>无论多少个task通知相同的handlers，handlers仅会在所有task结束后执行一次；</li> <li>只有task发生变化后才会通知handlers，没有改变则不会触发handlers；</li> <li>不能使用handlers代替task，因为handlers是一个特殊的task；</li></ul> <h4 id="_8-4-playbook-tag"><a href="#_8-4-playbook-tag" class="header-anchor">#</a> 8.4 playbook tag</h4> <p>默认情况下，Ansible在执行一个playbook时，会执行playbook中的定义的所有任务。Ansible的标签（Tags）功能可以给单独任务甚至整个playbook打上tag标签，然后利用tag标签指定要运行的个别任务，或跳过个别的任务！</p> <h6 id="案例"><a href="#案例" class="header-anchor">#</a> 案例：</h6> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Instll Nginx
    <span class="token key atrule">yum</span><span class="token punctuation">:</span> 
      <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
      <span class="token key atrule">state</span><span class="token punctuation">:</span> present
    <span class="token key atrule">tags</span><span class="token punctuation">:</span> install nginx            <span class="token comment"># 添加tag标签</span>

  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Copy Nignx.conf
    <span class="token key atrule">template</span><span class="token punctuation">:</span>
      <span class="token key atrule">src</span><span class="token punctuation">:</span> nginx.conf.j2
      <span class="token key atrule">dest</span><span class="token punctuation">:</span> /etc/nginx/nginx.conf
    <span class="token key atrule">notify</span><span class="token punctuation">:</span> Restart Nignx Service

  <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Start Nginx 
    <span class="token key atrule">service</span><span class="token punctuation">:</span>
      <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
      <span class="token key atrule">state</span><span class="token punctuation">:</span> started
    <span class="token key atrule">tags</span><span class="token punctuation">:</span> start nginx          <span class="token comment"># 添加tag标签</span>

  <span class="token key atrule">handlers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restart Nignx Service
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">state</span><span class="token punctuation">:</span> restarted
$ ansible<span class="token punctuation">-</span>playbook <span class="token punctuation">-</span>i hosts test.yml  <span class="token punctuation">-</span>t 'install nginx'
<span class="token comment"># 仅仅执行playbook中的某个tag标签</span>

$ $ ansible<span class="token punctuation">-</span>playbook <span class="token punctuation">-</span>i hosts test.yml  <span class="token punctuation">-</span><span class="token punctuation">-</span>skip<span class="token punctuation">-</span>tags 'install nginx'
<span class="token comment"># 跳过playbook中的特定的tag标签</span>

$ ansible<span class="token punctuation">-</span>playbook <span class="token punctuation">-</span>i hosts test.yml  <span class="token punctuation">-</span>t 'install nginx' <span class="token punctuation">-</span>t 'start nginx'
<span class="token comment"># 指定多个tag标签</span>

$ ansible<span class="token punctuation">-</span>playbook <span class="token punctuation">-</span>i hosts test.yml  <span class="token punctuation">-</span><span class="token punctuation">-</span>skip<span class="token punctuation">-</span>tags 'install nginx' <span class="token punctuation">-</span><span class="token punctuation">-</span>skip<span class="token punctuation">-</span>tags 'start nginx'
<span class="token comment"># 跳过多个tag标签</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br></div></div><h4 id="_8-5-playbook-include"><a href="#_8-5-playbook-include" class="header-anchor">#</a> 8.5 playbook include</h4> <p>有时发现大量的playbook内容要重复编写，与tasks之间贡呢需相互调用才能完成各自贡呢。playbook庞大到维护困难，这是就需要使用include！</p> <h6 id="案例-2"><a href="#案例-2" class="header-anchor">#</a> 案例：</h6> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">cat</span> restart_httpd.yml 
- name: Restart Httpd Service
  service:
    name: httpd
    state: restarted
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>A Project的yaml文件：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> A Project command
      <span class="token key atrule">command</span><span class="token punctuation">:</span> echo &quot;A&quot;
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restart Httpd
      <span class="token key atrule">include</span><span class="token punctuation">:</span> restart_httpd.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>A Project的yaml文件：</p> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> B Project command
      <span class="token key atrule">command</span><span class="token punctuation">:</span> echo &quot;B&quot;
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restart Httpd
      <span class="token key atrule">include</span><span class="token punctuation">:</span> restart_httpd.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><strong>高级用法：</strong></p> <p>一次执行的多个playbook文件！</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code>$ <span class="token function">cat</span> tasks_total.yml 
- import_playbook: test.yml
- import_playbook: test01.yml

$ ansible-playbook <span class="token parameter variable">-i</span> hosts  tasks_total.yml
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h4 id="_8-6-ignore-errors忽略错误"><a href="#_8-6-ignore-errors忽略错误" class="header-anchor">#</a> 8.6 ignore_errors忽略错误</h4> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Command
      <span class="token key atrule">command</span><span class="token punctuation">:</span> /bin/false
      <span class="token key atrule">ignore_errors</span><span class="token punctuation">:</span> yes

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Create File
      <span class="token key atrule">file</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /tmp/file
        <span class="token key atrule">state</span><span class="token punctuation">:</span> touch
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h4 id="_8-7-playbook错误处理"><a href="#_8-7-playbook错误处理" class="header-anchor">#</a> 8.7 playbook错误处理</h4> <p>通常情况下，当task失败后，play将会终止，任何在前面已经被tasks notify的handlers都不会被执行。如果在play中设置<code>force_handlers</code>，被通知的handlers就会被强制执行。</p> <h5 id="案例一-task执行失败强制调用handlers"><a href="#案例一-task执行失败强制调用handlers" class="header-anchor">#</a> 案例一：task执行失败强制调用handlers</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">force_handlers</span><span class="token punctuation">:</span> yes     <span class="token comment"># 强制调用handlers</span>

  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Touch File
      <span class="token key atrule">file</span><span class="token punctuation">:</span>
        <span class="token key atrule">path</span><span class="token punctuation">:</span> /tmp/test
        <span class="token key atrule">state</span><span class="token punctuation">:</span> touch
      <span class="token key atrule">notify</span><span class="token punctuation">:</span> Restart Httpd Service

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Packages
      <span class="token key atrule">yum</span><span class="token punctuation">:</span> 
        <span class="token key atrule">name</span><span class="token punctuation">:</span> sb
        <span class="token key atrule">state</span><span class="token punctuation">:</span> present

  <span class="token key atrule">handlers</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Restart Httpd Service
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> httpd
        <span class="token key atrule">state</span><span class="token punctuation">:</span> restarted
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h5 id="案例二-关闭change的状态-确定不会对被控端主机进行任何的修改和变更"><a href="#案例二-关闭change的状态-确定不会对被控端主机进行任何的修改和变更" class="header-anchor">#</a> 案例二： 关闭change的状态（确定不会对被控端主机进行任何的修改和变更）</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Install Httpd Server
      <span class="token key atrule">yum</span><span class="token punctuation">:</span> 
        <span class="token key atrule">name</span><span class="token punctuation">:</span> httpd
        <span class="token key atrule">state</span><span class="token punctuation">:</span> present
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Service Httpd Started
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> httpd
        <span class="token key atrule">state</span><span class="token punctuation">:</span> started
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Check Httpd Server
      <span class="token key atrule">shell</span><span class="token punctuation">:</span> ps aux <span class="token punctuation">|</span> grep httpd
      <span class="token key atrule">register</span><span class="token punctuation">:</span> check_httpd
      <span class="token key atrule">changed_when</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> OutPut Variables
      <span class="token key atrule">debug</span><span class="token punctuation">:</span>
        <span class="token key atrule">msg</span><span class="token punctuation">:</span> <span class="token string">&quot;{{ check_httpd.stdout_lines }}&quot;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h5 id="案例三-使用changed-when检查tasksrre任务返回结果"><a href="#案例三-使用changed-when检查tasksrre任务返回结果" class="header-anchor">#</a> 案例三： 使用changed_when检查tasksrre任务返回结果</h5> <div class="language-yaml line-numbers-mode"><pre class="language-yaml"><code><span class="token punctuation">-</span> <span class="token key atrule">hosts</span><span class="token punctuation">:</span> web
  <span class="token key atrule">tasks</span><span class="token punctuation">:</span>
    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Configure Nginx Server
      <span class="token key atrule">template</span><span class="token punctuation">:</span>
        <span class="token key atrule">src</span><span class="token punctuation">:</span> nginx.conf.j2
        <span class="token key atrule">dest</span><span class="token punctuation">:</span> /etc/nginx/nginx.conf
      <span class="token key atrule">notify</span><span class="token punctuation">:</span> Restart Nginx Server

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Check Httpd
      <span class="token key atrule">shell</span><span class="token punctuation">:</span> /usr/sbin/nginx <span class="token punctuation">-</span>t
      <span class="token key atrule">register</span><span class="token punctuation">:</span> nginx_check
      <span class="token key atrule">changed_when</span><span class="token punctuation">:</span>
        <span class="token punctuation">-</span> (nginx_check.stdout.find('successful'))
        <span class="token punctuation">-</span> <span class="token boolean important">false</span>

    <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> Start Httpd Server
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">state</span><span class="token punctuation">:</span> started
        <span class="token key atrule">enabled</span><span class="token punctuation">:</span> yes

    <span class="token punctuation">-</span> <span class="token key atrule">handlers</span><span class="token punctuation">:</span> Restart Httpd Server
      <span class="token key atrule">service</span><span class="token punctuation">:</span>
        <span class="token key atrule">name</span><span class="token punctuation">:</span> nginx
        <span class="token key atrule">state</span><span class="token punctuation">:</span> restarted
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div></div></div> <div class="page-slot page-slot-bottom"><div class="donation">
  <button>打赏</button>
  <div class="main">
      <div class="pic">
          <img src="http://pic.zzppjj.top/LightPicture/2023/02/cebf13bbcea9264d.jpg" alt="微信">
          <img src="http://pic.zzppjj.top/LightPicture/2023/02/d98d15501306c7c4.jpg" alt="支付宝">
      </div>
  </div>
</div></div> <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=ansible" title="标签">#ansible</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2023/04/24, 16:55:42</span></div></div> <div class="page-nav-wapper"><!----> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/pages/f8f66c/">anisble批量安装node_exporter</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/pages/a3cd2b/"><div>
            pip更换国内源
            <!----></div></a> <span class="date">07-31</span></dt></dl><dl><dd>02</dd> <dt><a href="/pages/df6e29/"><div>
            conda安装和镜像源配置
            <!----></div></a> <span class="date">07-31</span></dt></dl><dl><dd>03</dd> <dt><a href="/pages/6cb488/"><div>
            awk常用参数和使用示例
            <!----></div></a> <span class="date">07-24</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="https://github.com/zpj874878956" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="mailto:874878956@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://blog.zzppjj.top/rss.xml" title="订阅" target="_blank" class="iconfont icon-rss"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2019-2024
    <span>| <a href="https://www.foreverblog.cn/" class="d-inline-block text-muted" target="_blank" rel="external nofollow"><img src="/img/964560013b68c2e4.png" alt="点击查看十年之约" style="width:auto;height:11px;"></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><canvas id="vuepress-canvas-cursor"></canvas><!----><div></div><div></div><div></div></div></div>
    <script src="/assets/js/app.73676f20.js" defer></script><script src="/assets/js/4.23144ec8.js" defer></script><script src="/assets/js/1.09d67b9a.js" defer></script><script src="/assets/js/3.fc5194e0.js" defer></script><script src="/assets/js/72.b6cd4d2e.js" defer></script><script src="/assets/js/38.33c96ce4.js" defer></script><script src="/assets/js/21.2c073392.js" defer></script>
  </body>
</html>
