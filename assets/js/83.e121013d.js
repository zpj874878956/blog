(window.webpackJsonp=window.webpackJsonp||[]).push([[83],{436:function(s,a,t){"use strict";t.r(a);var e=t(0),n=Object(e.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"集群部署-kubeadm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#集群部署-kubeadm"}},[s._v("#")]),s._v(" 集群部署-kubeadm")]),s._v(" "),a("h2",{attrs:{id:"主机准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机准备"}},[s._v("#")]),s._v(" 主机准备")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("主机名")]),s._v(" "),a("th",[s._v("操作系统")]),s._v(" "),a("th",[s._v("CPU")]),s._v(" "),a("th",[s._v("MEM")]),s._v(" "),a("th",[s._v("角色要求")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("master1")]),s._v(" "),a("td",[s._v("CentOS7.6")]),s._v(" "),a("td",[s._v("2")]),s._v(" "),a("td",[s._v("2G")]),s._v(" "),a("td",[s._v("master")])]),s._v(" "),a("tr",[a("td",[s._v("worker1")]),s._v(" "),a("td",[s._v("CentOS7.6")]),s._v(" "),a("td",[s._v("2")]),s._v(" "),a("td",[s._v("2G")]),s._v(" "),a("td",[s._v("worker")])]),s._v(" "),a("tr",[a("td",[s._v("worker2")]),s._v(" "),a("td",[s._v("CentOS7.6")]),s._v(" "),a("td",[s._v("2")]),s._v(" "),a("td",[s._v("2G")]),s._v(" "),a("td",[s._v("worker")])])])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[a("strong",[s._v("主机操作系统")])]),s._v(" "),a("th",[a("strong",[s._v("硬件配置")])]),s._v(" "),a("th",[a("strong",[s._v("硬盘分区")])]),s._v(" "),a("th",[s._v("IP")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("CentOS7u6最小化")]),s._v(" "),a("td",[s._v("2C 2G 100G")]),s._v(" "),a("td",[s._v("/boot、/")]),s._v(" "),a("td",[s._v("192.168.216.100")])]),s._v(" "),a("tr",[a("td",[s._v("CentOS7u6最小化")]),s._v(" "),a("td",[s._v("2C 2G 100G")]),s._v(" "),a("td",[s._v("/boot、/")]),s._v(" "),a("td",[s._v("192.168.216.101")])]),s._v(" "),a("tr",[a("td",[s._v("CentOS7u6最小化")]),s._v(" "),a("td",[s._v("2C 2G 100G")]),s._v(" "),a("td",[s._v("/boot、/")]),s._v(" "),a("td",[s._v("192.168.216.102")])])])]),s._v(" "),a("h3",{attrs:{id:"主机名"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机名"}},[s._v("#")]),s._v(" 主机名")]),s._v(" "),a("p",[s._v("三台机器，分别对应设置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# hostnamectl set-hostname XXX")]),s._v("\n主机名列表 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.100 master1 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.101 worker1 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.102 worker2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"主机ip地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机ip地址"}},[s._v("#")]),s._v(" 主机IP地址")]),s._v(" "),a("p",[s._v("三台机器，分别对应设置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("IP地址段根据自己主机实际情况进行配置\n本次使用VMWare Workstation Pro虚拟机部署，需要注意网关设置。\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/sysconfig/network- scripts/ifcfg-ens33 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DEVICE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("eth0 \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("TYPE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("Ethernet \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("ONBOOT")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("yes \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("BOOTPROTO")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("static \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("IPADDR")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.XXX \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("NETMASK")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("255.255")]),s._v(".255.0 \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("GATEWAY")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.2 \n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("DNS1")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("119.29")]),s._v(".29.29\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"主机名称解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机名称解析"}},[s._v("#")]),s._v(" 主机名称解析")]),s._v(" "),a("p",[s._v("三台机器，同样设置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /etc/hosts \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("127.0")]),s._v(".0.1 localhost localhost.localdomain localhost4 localhost4.localdomain4 ::1 localhost localhost.localdomain localhost6 localhost6.localdomain6 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.100 master1 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.101 worker1 \n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".216.102 worker2\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h3",{attrs:{id:"主机安全配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机安全配置"}},[s._v("#")]),s._v(" 主机安全配置")]),s._v(" "),a("p",[s._v("关闭firewalld")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl stop firewalld")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl disable firewalld ")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#确认是否运行 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# firewall-cmd --state ")]),s._v("\nnot running\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("关闭selinux")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sed -ri 's/SELINUX=enforcing/SELINUX=disabled/' /etc/selinux/config")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"主机时间同步"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#主机时间同步"}},[s._v("#")]),s._v(" 主机时间同步")]),s._v(" "),a("p",[s._v("三台机器，同样设置")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install ntpdate")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# crontab -l ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" */1 * * * ntpdate time1.aliyun.com\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"永久关闭swap分区"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#永久关闭swap分区"}},[s._v("#")]),s._v(" 永久关闭swap分区")]),s._v(" "),a("p",[s._v("使用kubeadm部署必须关闭swap分区，修改配置文件后需要重启操作系统。")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/fstab ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# /etc/fstab # Created by anaconda on Tue Mar 5 11:40:13 2019 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Accessible filesystems, by reference, are maintained under '/dev/disk' ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# See man pages fstab(5), findfs(8), mount(8) and/or blkid(8) for more info ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n/dev/mapper/centos-root / \n    xfs defaults "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("UUID")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2791cef9-e7dd-40cb-917c-52f8bc061339 /boot xfs defaults "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#/dev/mapper/centos-swap swap swap defaults 0 0")]),s._v("\n在swap文件系统对应的行，行首添加"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#表示注释。")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("h3",{attrs:{id:"添加网桥过滤"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加网桥过滤"}},[s._v("#")]),s._v(" 添加网桥过滤")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("添加网桥过滤及地址转发 \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/sysctl.d/k8s.conf ")]),s._v("\nnet.bridge.bridge-nf-call-ip6tables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \nnet.bridge.bridge-nf-call-iptables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \nnet.ipv4.ip_forward "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \nvm.swappiness "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" \n\n加载br_netfilter模块 \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# modprobe br_netfilter")]),s._v("\n\n查看是否加载 \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsmod | grep br_netfilter ")]),s._v("\nbr_netfilter "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("22256")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" bridge "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("151336")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" br_netfilter\n\n加载网桥过滤配置文件 \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sysctl -p ")]),s._v("\n/etc/sysctl.d/k8s.conf \nnet.bridge.bridge-nf-call-ip6tables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \nnet.bridge.bridge-nf-call-iptables "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nnet.ipv4.ip_forward "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" \nvm.swappiness "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h3",{attrs:{id:"开启ipvs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#开启ipvs"}},[s._v("#")]),s._v(" 开启ipvs")]),s._v(" "),a("p",[s._v("安装ipset及ipvsadm")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install ipset ipvsadm")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("在所有节点执行如下脚本")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("添加需要加载的模块 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat > ")]),s._v("\n/etc/sysconfig/modules/ipvs.modules "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<<")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("EOF \n#!/bin/bash \nmodprobe -- ip_vs \nmodprobe -- ip_vs_rr \nmodprobe -- ip_vs_wrr \nmodprobe -- ip_vs_sh \nmodprobe -- nf_conntrack_ipv4\nEOF")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("授权、运行、检查是否加载 \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chmod 755 ")]),s._v("\n/etc/sysconfig/modules/ipvs.modules "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("bash")]),s._v(" \n/etc/sysconfig/modules/ipvs.modules "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" lsmod "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("grep")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" ip_vs "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" nf_conntrack_ipv4\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[s._v("检查是否加载\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@XXX ~"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# lsmod | grep -e ipvs -e nf_conntrack_ipv4")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"各节点安装docker-ce"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#各节点安装docker-ce"}},[s._v("#")]),s._v(" 各节点安装docker-ce")]),s._v(" "),a("h3",{attrs:{id:"yum源获取"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yum源获取"}},[s._v("#")]),s._v(" YUM源获取")]),s._v(" "),a("blockquote",[a("p",[s._v("建议使用清华镜像源，官方提供的镜像源由于网络速度原")]),s._v(" "),a("p",[s._v("因下载较慢")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# wget -O /etc/yum.repos.d/docker-ce.repo https://mirrors.tuna.tsinghua.edu.cn/docker- ce/linux/centos/docker-ce.repo")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"查看docker-ce版本"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看docker-ce版本"}},[s._v("#")]),s._v(" 查看docker-ce版本")]),s._v(" "),a("blockquote",[a("p",[s._v("对版本进行排序查询")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum list docker-ce.x86_64 -- showduplicates | sort -r")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h3",{attrs:{id:"安装指定版本docker-ce"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装指定版本docker-ce"}},[s._v("#")]),s._v(" 安装指定版本docker-ce")]),s._v(" "),a("blockquote",[a("p",[s._v("安装指定版本docker-ce，此版本不需要修改服务启动文件及iptables默认规则链策略。")])]),s._v(" "),a("blockquote",[a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install -- setopt=obsoletes=0 docker-ce-18.06.3.ce-3.el7")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])])]),s._v(" "),a("h3",{attrs:{id:"修改docker-ce服务配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改docker-ce服务配置文件"}},[s._v("#")]),s._v(" 修改docker-ce服务配置文件")]),s._v(" "),a("blockquote",[a("p",[s._v("修改其目的是为了后续使用/etc/docker/daemon.json来进行更多配置。")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("修改内容如下 "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /usr/lib/systemd/system/docker.service ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Unit]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Service]")]),s._v(" \n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" \nExecStart="),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("usr/bin/dockerd "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#如果原文件此行后面 有-H选项，请删除-H(含)后面所有内容。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Install]")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n注意：有些版本不需要修改，请注意观察\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#在/etc/docker/daemon.json添加如下内容：")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@localhost ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat /etc/docker/daemon.json ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"exec-opts"')]),s._v(": "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"native.cgroupdriver=systemd"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br")])]),a("h2",{attrs:{id:"部署软件及配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#部署软件及配置"}},[s._v("#")]),s._v(" "),a("strong",[s._v("部署软件及配置")])]),s._v(" "),a("h3",{attrs:{id:"软件安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软件安装"}},[s._v("#")]),s._v(" 软件安装")]),s._v(" "),a("blockquote",[a("p",[s._v("所有k8s集群节点均需安装，默认YUM源是谷歌，可以使")]),s._v(" "),a("p",[s._v("用阿里云YUM")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("需求")]),s._v(" "),a("th",[s._v("kubeadm")]),s._v(" "),a("th",[s._v("kubelet")]),s._v(" "),a("th",[s._v("kubectl")]),s._v(" "),a("th",[s._v("docker-ce")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("值")]),s._v(" "),a("td",[s._v("初始化集群、管理集群等，版本为：1.17.2")]),s._v(" "),a("td",[s._v("用于接收api-server指令，对pod生命周期进行管理，版本为：1.17.2")]),s._v(" "),a("td",[s._v("集群命令行管理工具，版本为1.17.2")]),s._v(" "),a("td",[s._v("18.06.3")])])])]),s._v(" "),a("ul",[a("li",[s._v("谷歌YUM源")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[kubernetes]")]),s._v(" \nname=Kubernetes \nbaseurl=https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("google"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com/yum/repos/kubernetes-el7-x86_64 \nenabled=1 \ngpgcheck=1 \nrepo_gpgcheck=1 \ngpgkey=https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("google"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com/yum/doc/yum-key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gpg https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("packages"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("cloud"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("google"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com/yum/doc/rpm-package-key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gpg\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("阿里云YUM源")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[kubernetes]")]),s._v(" \nname=Kubernetes \nbaseurl=https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com/kubernetes/yum/repos/kubernetes-el7-x86_64/ \nenabled=1 \ngpgcheck=1 \nrepo_gpgcheck=1 \ngpgkey=https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com/kubernetes/yum/doc/yum-key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gpg https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("mirrors"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("aliyun"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com/kubernetes/yum/doc/rpm-package-key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gpg\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("ul",[a("li",[s._v("安装指定版本 kubeadm kubelet kubectl")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum list kubeadm.x86_64 -- showduplicates | sort -r ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# yum -y install -- setopt=obsoletes=0 kubeadm-1.17.2-0 kubelet- 1.17.2-0 kubectl-1.17.2-0")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"软件设置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#软件设置"}},[s._v("#")]),s._v(" 软件设置")]),s._v(" "),a("blockquote",[a("p",[s._v("主要配置kubelet，如果不配置可能会导致k8s集群无法启动。")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("为了实现docker使用的cgroupdriver与kubelet使用的 cgroup的一致性，建议修改如下文件内容。 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim /etc/sysconfig/kubelet ")]),s._v("\nKUBELET_EXTRA_ARGS="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"--cgroup-driver=systemd"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("设置为开机自启动即可，由于没有生成配置文件，集群初始化 后自动启动 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# systemctl enable kubelet")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"k8s集群容器镜像准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群容器镜像准备"}},[s._v("#")]),s._v(" k8s集群容器镜像准备")]),s._v(" "),a("blockquote",[a("p",[s._v("由于使用kubeadm部署集群，集群所有核心组件均以Pod运行，需要为主机准备镜像，不同角色主机准备不同")]),s._v(" "),a("p",[s._v("镜像，建议使用科学上网方式下载镜像")])]),s._v(" "),a("h3",{attrs:{id:"master主机镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#master主机镜像"}},[s._v("#")]),s._v(" Master主机镜像")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("查看集群使用的容器镜像 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm config images list ")]),s._v("\nk8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/kube-apiserver:v1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("2 \nk8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/kube-controller-manager:v1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("2 \nk8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/kube-scheduler:v1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("2 \nk8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/kube-proxy:v1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("17"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("2 k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/pause:3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1 \nk8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/etcd:3"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("4"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("3-0 \nk8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("gcr"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/coredns:1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("6"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("5\n\n列出镜像列表到文件中，便于下载使用。 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm config images list >> image.list")]),s._v("\n\n查看已列出镜像文件列表 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat image.list")]),s._v("\n\n编写镜像下载脚本 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat image.pull ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#!/bin/bash ")]),s._v("\nimg_list="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("' k8s.gcr.io/kube-apiserver:v1.17.2 \nk8s.gcr.io/kube-controller-manager:v1.17.2 \nk8s.gcr.io/kube-scheduler:v1.17.2 \nk8s.gcr.io/kube-proxy:v1.17.2 \nk8s.gcr.io/pause:3.1 \nk8s.gcr.io/etcd:3.4.3-0 \nk8s.gcr.io/coredns:1.6.5\n'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" img in "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$img_list")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v("\n    docker pull "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$img")]),s._v("\ndone\n\n执镜像下载脚本 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# sh image.pull")]),s._v("\n\n查看已下载镜像\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br")])]),a("h3",{attrs:{id:"worker主机镜像"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#worker主机镜像"}},[s._v("#")]),s._v(" Worker主机镜像")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("保存镜像为tar\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker save -o kube- proxy.tar k8s.gcr.io/kube-proxy:v1.17.2")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker save -o pause.tar k8s.gcr.io/pause:3.1")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls kube-proxy.tar pause.tar")]),s._v("\n\n复制tar到worker节点 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp kube-proxy.tar pause.tar work1:/root")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp kube-proxy.tar pause.tar work2:/root")]),s._v("\n\n在worker节点导入镜像\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls ")]),s._v("\nkube-proxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar pause"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i kube- proxy.tar")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i pause.tar")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work2 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls ")]),s._v("\nkube-proxy"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar pause"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work2 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i kube- proxy.tar")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work2 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i pause.tar")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br")])]),a("h2",{attrs:{id:"k8s集群初始化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群初始化"}},[s._v("#")]),s._v(" k8s集群初始化")]),s._v(" "),a("h3",{attrs:{id:"master节点"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#master节点"}},[s._v("#")]),s._v(" master节点")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm init --kubernetes-version=v1.17.2 --pod-network-cidr=172.16.0.0/16 --apiserver-advertise-address=192.168.216.100")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 192.168.216.100 是当前主机IP")]),s._v("\n\n初始化过程中导出结果\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" \nYour Kubernetes control-plane has initialized successfully!\n\nTo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("start")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" your cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" you need to run the following as a regular user:\n\n    mkdir "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("p "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kube\n    sudo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("i "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("etc/kubernetes/admin"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("conf "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kube/config\n    sudo chown $"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("u"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(":$"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("id "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("g"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$HOME")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("kube/config\n\nYou should now deploy a pod network to the cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\nRun "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kubectl apply -f [podnetwork].yaml"')]),s._v("\nwith one of the options listed at:https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("kubernetes"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/docs/concepts/cluste r-administration/addons/\n\nThen you can join any number of worker nodes by running the following on each as root:\n\nkubeadm join 192"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("168"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("216"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("100:6443 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("token m0rpym"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("522tija0299geb8h \\ "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("discovery-token-ca-cert-hash sha256:cef7351d9fefc67868f22aa3122165dd01f63 e95870d2fb22197ee66c61b18d6\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br")])]),a("h3",{attrs:{id:"准备集群管理文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#准备集群管理文件"}},[s._v("#")]),s._v(" 准备集群管理文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir .kube ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cp -i /etc/kubernetes/admin.conf .kube/config ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# chown $(id -u):$(id -g) .kube/config")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"网络插件使用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#网络插件使用"}},[s._v("#")]),s._v(" 网络插件使用")]),s._v(" "),a("h4",{attrs:{id:"calico镜像准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#calico镜像准备"}},[s._v("#")]),s._v(" calico镜像准备")]),s._v(" "),a("blockquote",[a("p",[s._v("三台主机都要操作")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls ")]),s._v("\ncalico-cni"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar calico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yml pod2daemon-flexvol"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar calico-node"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar kube-controllers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("tar\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i calico-cni.tar")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i calico-node.tar")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i pod2daemon-flexvol.tar")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker load -i kube-controllers.tar")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h4",{attrs:{id:"修改calico资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#修改calico资源清单文件"}},[s._v("#")]),s._v(" 修改calico资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 由于calico自身网络发现机制有问题，因为需要修改 calico使用的物理网卡，添加607及608行\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# vim calico.yml")]),s._v("\n\n602 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: CLUSTER_TYPE\n603 value: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"k8s,bgp"')]),s._v("\n604 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Auto-detect the BGP IP address.")]),s._v("\n605 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: IP\n606 value: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"autodetect"')]),s._v("\n607 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: IP_AUTODETECTION_METHOD\n608 value: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"interface=ens.*"')]),s._v("\n\n说明：ens"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("，这个值在服务器上"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("if")]),s._v(" a查看。\n\n2"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" 修改为初始化时设置的pod-network-cidr\n619 "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: CALICO_IPV4POOL_CIDR\n620 value: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"172.16.0.0/16"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br")])]),a("h4",{attrs:{id:"应用calico资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用calico资源清单文件"}},[s._v("#")]),s._v(" 应用calico资源清单文件")]),s._v(" "),a("blockquote",[a("p",[s._v("在应用caclico资源清单文件之前，需要把calico所有的镜像导入到node节点中。")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 calico39]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f calico.yml")]),s._v("\n\n输出结果\nconfigmap/calico-config created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/felixconfigurations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/ipamblocks"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/blockaffinities"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/ipamhandles"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/ipamconfigs"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/bgppeers"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/bgpconfigurations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/ippools"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/hostendpoints"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/clusterinformations"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/globalnetworkpolicies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("or g created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/globalnetworksets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created\ncustomresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/networkpolicies"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created customresourcedefinition"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apiextensions"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("i o/networksets"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("crd"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("projectcalico"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org created clusterrole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/calico "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("kube-controllers created clusterrolebinding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("calico-kube-controllers created clusterrole"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io/calico "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("node created clusterrolebinding"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("rbac"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("authorization"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("k8s"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("calico-node created daemonset"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/calico-node created serviceaccount/calico-node created deployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/calico-kube-controllers created serviceaccount/calico-kube-controllers created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h3",{attrs:{id:"添加工作节点到集群"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加工作节点到集群"}},[s._v("#")]),s._v(" 添加工作节点到集群")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm join 192.168.122.100:6443 --token m0rpym.522tija0299geb8h \\ ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("discovery-token-ca-cert-hash sha256:cef7351d9fefc67868f22aa3122165dd01f63e 95870d2fb22197ee66c61b18d6\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\nRun "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl get nodes'")]),s._v(" on the control-plane to see this node join the cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work2 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubeadm join 192.168.122.100:6443 --token m0rpym.522tija0299geb8h \\ ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("discovery-token-ca-cert-hash sha256:cef7351d9fefc67868f22aa3122165dd01f63e 95870d2fb22197ee66c61b18d6\n\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n\nRun "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl get nodes'")]),s._v(" on the control-plane to see this node join the cluster"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h2",{attrs:{id:"验证k8s集群可用性方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证k8s集群可用性方法"}},[s._v("#")]),s._v(" 验证k8s集群可用性方法")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("查看节点状态\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get nodes")]),s._v("\n\n查看集群健康状态\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get cs")]),s._v("\n或\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl cluster-info")]),s._v("\nKubernetes master is running at https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("192"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("168"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("11:6443 \nKubeDNS is running at https:"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("192"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("168"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("122"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("11:6443/api/v1/namespaces/kube-system/services/kube-dns:dns/proxy\n\nTo further debug and diagnose cluster problems"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" use "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'kubectl cluster-info dump'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("h1",{attrs:{id:"k8s集群客户端工具kubectl"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群客户端工具kubectl"}},[s._v("#")]),s._v(" k8s集群客户端工具kubectl")]),s._v(" "),a("h2",{attrs:{id:"kubectl帮助方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl帮助方法"}},[s._v("#")]),s._v(" kubectl帮助方法")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("检查kubectl是否安装\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# rpm -qa | grep kubectl")]),s._v("\n\n获取kubectl帮助方法 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl --help")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("h2",{attrs:{id:"kubectl子命令使用分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl子命令使用分类"}},[s._v("#")]),s._v(" kubectl子命令使用分类")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/04/75c50b92ada7151a.png",alt:"75c50b92ada7151a.png"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/04/16cde53a5b38054e.png",alt:"16cde53a5b38054e.png"}})]),s._v(" "),a("h2",{attrs:{id:"使用kubectl命令必要环境"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用kubectl命令必要环境"}},[s._v("#")]),s._v(" 使用kubectl命令必要环境")]),s._v(" "),a("blockquote",[a("p",[s._v("在worker节点如何使用kubectl命令管理k8s集群")])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("准备集群管理配置文件 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mkdir .kube")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# scp master1:/root/.kube/config .kube/")]),s._v("\n\n使用命令验证 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@work1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get nodes")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h1",{attrs:{id:"k8s集群资源清单-yaml-文件书写方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群资源清单-yaml-文件书写方法"}},[s._v("#")]),s._v(" k8s集群资源清单(YAML)文件书写方法")]),s._v(" "),a("h2",{attrs:{id:"yaml文件书写格式"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yaml文件书写格式"}},[s._v("#")]),s._v(" YAML文件书写格式")]),s._v(" "),a("h3",{attrs:{id:"yaml介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yaml介绍"}},[s._v("#")]),s._v(" YAML介绍")]),s._v(" "),a("p",[s._v("YAML ：仍是一种标记语言。")]),s._v(" "),a("p",[s._v("为了强调这种语言以数据做为中心，而不是以标记语言为重点。")]),s._v(" "),a("p",[s._v("YAML是一个可读性高，用来表达数据序列的格式。")]),s._v(" "),a("h3",{attrs:{id:"基本语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基本语法"}},[s._v("#")]),s._v(" 基本语法")]),s._v(" "),a("p",[s._v("使用空格做为缩进")]),s._v(" "),a("p",[s._v("缩进的空格数目不重要，只要相同层级的元素左侧对齐即可")]),s._v(" "),a("p",[s._v("低版本缩进时不允许使用Tab键，只允许使用空格")]),s._v(" "),a("p",[s._v("使用#标识注释，从这个字符一直到行尾，都会被解释器忽略")]),s._v(" "),a("h3",{attrs:{id:"yaml支持的数据结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#yaml支持的数据结构"}},[s._v("#")]),s._v(" YAML支持的数据结构")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("对象")]),s._v(" "),a("p",[s._v("键值对的集合")]),s._v(" "),a("p",[s._v("又称为映射(mapping) / 哈希（hashes） / 字典")]),s._v(" "),a("p",[s._v("（dictionary）")])])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("对象类型：对象的一组键值对，使用冒号结构表示\nname: Tom \nage: 18\n\nYaml 也允许另一种写法，将所有键值对写成一个行内对象\nhash: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(" name: Tom"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" age: 18 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("数组：")]),s._v(" "),a("p",[s._v("一组按次序排列的值")]),s._v(" "),a("p",[s._v("又称为序列（sequence） / 列表 （list）")])])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("数组类型：一组连词线开头的行，构成一个数组\n\nPeople \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" Tom \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" Jack\n\n数组也可以采用行内表示法\nPeople: "),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[Tom, Jack]")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[a("p",[s._v("纯量（scalars）：")]),s._v(" "),a("p",[s._v("单个的、不可再分的值")])])]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("纯量：纯量是最基本的、不可再分的值。以下数据类型都属于 纯量\n\n数值直接以字面量的形式表示\nnumber: 12"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("30\n\n布尔值用true和false表示\nisSet: true\n\nnull用 ~ 表示 \nparent: ~\n\n时间采用 ISO8601 格式 \niso8601: 2001-12-14t21:59:43"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("10-05:00\n\n日期采用复合 iso8601 格式的年、月、日表示 \ndate: 1976-07-31\n\nYAML 允许使用两个感叹号，强制转换数据类型\ne: "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("str 123\nf: "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("str true\n\n字符串默认不使用引号表示\n\nstr: 这是一行字符串\n\n如果字符串之中包含空格或特殊字符，需要放在引号之中\n\nstr: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'内容： 字符串'")]),s._v("\n\n单引号和双引号都可以使用，双引号不会对特殊字符转义 \ns1: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'内容\\n字符串'")]),s._v(" \ns2: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"内容\\n字符串"')]),s._v("\n\n单引号之中如果还有单引号，必须连续使用两个单引号转义 \nstr: "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'labor''s day'")]),s._v("\n\n字符串可以写成多行，从第二行开始，必须有一个单空格缩 进。换行符会被转为 空格 \nstr: 这是一段 \n    多行\n    字符串\n\n多行字符串可以使用"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v("保留换行符，也可以使用>折叠换行\nthis: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("|")]),s._v(" \nFoo \nBar\n\nthat \nFoo \nBar\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br"),a("span",{staticClass:"line-number"},[s._v("45")]),a("br"),a("span",{staticClass:"line-number"},[s._v("46")]),a("br"),a("span",{staticClass:"line-number"},[s._v("47")]),a("br"),a("span",{staticClass:"line-number"},[s._v("48")]),a("br"),a("span",{staticClass:"line-number"},[s._v("49")]),a("br")])]),a("h2",{attrs:{id:"资源清单描述方法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#资源清单描述方法"}},[s._v("#")]),s._v(" "),a("strong",[s._v("资源清单描述方法")])]),s._v(" "),a("blockquote",[a("p",[s._v("在k8s中，一般使用YAML格式的文件来创建符合我们预期期")]),s._v(" "),a("p",[s._v("望的pod,这样的YAML文件称为资源清单。")])]),s._v(" "),a("h3",{attrs:{id:"常用字段"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#常用字段"}},[s._v("#")]),s._v(" "),a("strong",[s._v("常用字段")])]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("参数名")]),s._v(" "),a("th",[s._v("字段类型")]),s._v(" "),a("th",[s._v("说明")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("version")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("这里是指的是K8S API的版本，目前基本上是v1，可以用kubectl api-versions命令查询")])]),s._v(" "),a("tr",[a("td",[s._v("kind")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("这里指的是yam文件定义的资源类型和角色，比如:Pod")])]),s._v(" "),a("tr",[a("td",[s._v("metadata")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("元数据对象，固定值就写metadata")])]),s._v(" "),a("tr",[a("td",[s._v("metadata.name")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("元数据对象的名字，这里由我们编写，比如命名Pod的名字")])]),s._v(" "),a("tr",[a("td",[s._v("metadata.namespace")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("元数据对象的命名空间，由我们自身定义")])]),s._v(" "),a("tr",[a("td",[s._v("Spec")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("详细定义对象，固定值就写Spec")])]),s._v(" "),a("tr",[a("td",[s._v("spec. containers[]")]),s._v(" "),a("td",[s._v("list")]),s._v(" "),a("td",[s._v("这里是Spec对象的容器列表定义，是个列表")])]),s._v(" "),a("tr",[a("td",[s._v("spec containers [].name")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("这里定义容器的名字")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].image")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("这里定义要用到的镜像名称")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].imagePullPolicy")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("定义镜像拉取策略，有Always、 Never、 IfNotPresent三个值可选(1) Always:意思是每次都尝试重新拉取镜像(2) Never:表示仅使用本地镜像(3) IfNotPresent:如果本地有镜像就使用本地镜像，没有就拉取在线镜像。上面三个值都没设置的话，默认是Always。")])]),s._v(" "),a("tr",[a("td",[s._v("spec containers [].command[]")]),s._v(" "),a("td",[s._v("List")]),s._v(" "),a("td",[s._v("指定容器启动命令，因为是数组可以指定多个。不指定则使用镜像打包时使用的启动命令。")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].args")]),s._v(" "),a("td",[s._v("List")]),s._v(" "),a("td",[s._v("指定容器启动命令参数，因为是数组可以指定多个.")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].workDir")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定容器的工作目录")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[]. volumeMounts[]")]),s._v(" "),a("td",[s._v("List")]),s._v(" "),a("td",[s._v("指定容器内部的存储卷配置")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[]. volumeMounts[].name")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定可以被容器挂戴的存储卷的名称")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[]. mountPath")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定可以被容器捱戴的存储卷的路径")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[]. volumeMounts[].readOnly")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("设置存储卷路径的读写模式，ture或者false，默认为读写模式")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].ports[]")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指症容器需要用到的端口列表")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].ports[].name")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定端口名称")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].ports[].containerPort")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定容器需要监听的端口号")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].ports[].hostPort")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定容所在主机需要监听的端口号，默认跟上面containerPort相同，注意设置了 hostPort同一台主机无法启动该容器的相同副本(因为主机的端口号不能相同，这样会冲突)")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].ports[].protocol")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定端口协议，支持TCP和 UDP，默认值为TCP")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].env[]")]),s._v(" "),a("td",[s._v("List")]),s._v(" "),a("td",[s._v("指定容器运行前需设的环境变量列表")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].env[].name")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定环境变量名称")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers [].env[].value")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定环境变量值")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("指定资源 限制和资源请求的值（这里开始就是设置容器的资源上限）")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources.limits")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("指定设置容器运行时资源的运行上限")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources.limits.cpu")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定CPU限制，单位为core数，将用于docker run -- cpu- shares参数")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources.limits.memory")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("指定MEM内存的限制，单位为MiB、GiB")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources.requests")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("指定容器启动和调度时的限制设置")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources.requests.cpu")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("CPU请求，单位为core数，容器启动时初始化可用数量")])]),s._v(" "),a("tr",[a("td",[s._v("spec.containers[].resources.requests.memory")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("内存请求，单位为MiB、GiB，容器启动时初始化可用数量")])]),s._v(" "),a("tr",[a("td",[s._v("sepc.restartPolicy")]),s._v(" "),a("td",[s._v("String")]),s._v(" "),a("td",[s._v("定义Pod的重启策略，可选值为Always、 OnFailure,默认值为Always。 1.Always:Pod一旦终止运行，则无论容器时如何终止的，kubelet服务都将重启它。2.OnFailure:只 有Pod以非零退出码终止时，kubelet才会重启该容器。如果容器正常结束（退出码为0），则kubelet将不会重启它。3.Never:Pod终止后，kubelet将退出码报告给Master,不会重启该Pod。")])]),s._v(" "),a("tr",[a("td",[s._v("spec.nodeSelector")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("定义Node的 Label过滤标签，以key:value格式指定。")])]),s._v(" "),a("tr",[a("td",[s._v("spec.imagePullSecrets")]),s._v(" "),a("td",[s._v("Object")]),s._v(" "),a("td",[s._v("定义pull镜像时使用secret名称，以name:secretkey格式指定。")])]),s._v(" "),a("tr",[a("td",[s._v("spec.hostNetwork")]),s._v(" "),a("td",[s._v("Boolean")]),s._v(" "),a("td",[s._v("定义是否使用主机网络模式，默认值为false。设置true表示使用宿主机网络，不使用docker网桥，同时设置了true将无法在同一台宿主机上启动第二个副本。")])])])]),s._v(" "),a("h3",{attrs:{id:"举例说明"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#举例说明"}},[s._v("#")]),s._v(" "),a("strong",[s._v("举例说明")])]),s._v(" "),a("p",[s._v("创建一个namespace")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1 \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Namespace \n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" test\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("p",[s._v("创建一个pod")]),s._v(" "),a("div",{staticClass:"language-yaml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yaml"}},[a("code",[a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("apiVersion")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" v1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("kind")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" Pod\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("metadata")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" pod1\n"),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("spec")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" \n    "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("containers")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("name")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("-")]),s._v("containers\n      "),a("span",{pre:!0,attrs:{class:"token key atrule"}},[s._v("image")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(":")]),s._v("latest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h1",{attrs:{id:"k8s集群namespace-命名空间"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群namespace-命名空间"}},[s._v("#")]),s._v(" k8s集群NameSpace(命名空间)")]),s._v(" "),a("h2",{attrs:{id:"namespace介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#namespace介绍"}},[s._v("#")]),s._v(" NameSpace介绍")]),s._v(" "),a("p",[s._v("命名空间")]),s._v(" "),a("p",[s._v("作用：多租户情况下，实现资源隔离")]),s._v(" "),a("p",[s._v("属于逻辑隔离")]),s._v(" "),a("p",[s._v("属于管理边界")]),s._v(" "),a("p",[s._v("不属于网络边界")]),s._v(" "),a("p",[s._v("可以针对每个namespace做资源配额")]),s._v(" "),a("h2",{attrs:{id:"查看namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看namespace"}},[s._v("#")]),s._v(" 查看NameSpace")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME                 STATUS         AGE \ndefault             Active         16h \nkube-node-lease      Active      16h \nkube-public         Active         16h \nkube-system         Active         16h\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("说明\ndefault 用户创建的pod默认在此命名空间 \nkube-public 所有用户均可以访问，包括未认证用户 \nkube-node-lease kubernetes集群节点租约状态 \nv1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("13加入 \nkube-system kubernetes集群在使用\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h2",{attrs:{id:"创建namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建namespace"}},[s._v("#")]),s._v(" 创建NameSpace")]),s._v(" "),a("h3",{attrs:{id:"通过kubectl命令行创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl命令行创建"}},[s._v("#")]),s._v(" 通过kubectl命令行创建")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl create namespace")]),s._v("\ntest\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nnamespace/test created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 16h \nkube-node-lease Active 16h \nkube-public Active 16h \nkube-system Active 16h \ntest Active 16s 已经创建\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"通过kubectl命令应用资源清单文件创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl命令应用资源清单文件创建"}},[s._v("#")]),s._v(" 通过kubectl命令应用资源清单文件创建")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("准备资源清单文件\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat 01-create-ns.yaml")]),s._v("\napiVersion: v1\nkind: Namespace\nmetadata:\n    name: demons1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n应用资源清单文件\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f 01- create-ns.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n验证是否创建成功\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 16h \ndemons1 Active 30s \nkube-node-lease Active 16h \nkube-public Active 16h \nkube-system Active 16h \ntest Active 13m 已创建\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h2",{attrs:{id:"删除namespace"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除namespace"}},[s._v("#")]),s._v(" 删除NameSpace")]),s._v(" "),a("blockquote",[a("p",[s._v("删除命名空间时，命名空间中包含的所有资源对象同时被删除。")])]),s._v(" "),a("h3",{attrs:{id:"通过kubectl命令行删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl命令行删除"}},[s._v("#")]),s._v(" 通过kubectl命令行删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看namespace\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 16h \ndemons1 Active 7m15s \nkube-node-lease Active 16h \nkube-public Active 16h \nkube-system Active 16h \ntest Active 19m 确认存在\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n删除namespace \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete namespace test")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nnamespace "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"test"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看现有NameSpace，确认是否删除\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 16h \ndemons1 Active 7m39s \nkube-node-lease Active 16h \nkube-public Active 16h \nkube-system Active 16h\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h3",{attrs:{id:"通过kubectl命令应用资源清单文件删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl命令应用资源清单文件删除"}},[s._v("#")]),s._v(" 通过kubectl命令应用资源清单文件删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看namespace\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 16h \ndemons1 Active 7m39s 确认存在 \nkube-node-lease Active 16h \nkube-public Active 16h \nkube-system Active 16h\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("查看namespace资源清单文件\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat 01-create-ns.yaml")]),s._v("\napiVersion: v1\nkind: Namespace\nmetadata:\n    name: demons1\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n通过namespace资源清单文件删除\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete -f 01- create-ns.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nnamespace "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"demons1"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n确认是否被删除\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 16h \nkube-node-lease Active 16h \nkube-public Active 16h \nkube-system Active 16h\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("h1",{attrs:{id:"k8s集群核心概念-pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群核心概念-pod"}},[s._v("#")]),s._v(" k8s集群核心概念 Pod")]),s._v(" "),a("h2",{attrs:{id:"pod介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#pod介绍"}},[s._v("#")]),s._v(" pod介绍")]),s._v(" "),a("p",[s._v("Pod是kubernetes集群能够调度的最小单元")]),s._v(" "),a("p",[s._v("Pod是容器的封装")]),s._v(" "),a("h2",{attrs:{id:"查看pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#查看pod"}},[s._v("#")]),s._v(" 查看Pod")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令及输出 \n查看default命名空间中的Pod\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod")]),s._v("\nNo resources found"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n或\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods")]),s._v("\nNo resources found"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n或\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods --namespace default")]),s._v("\nNo resources found"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n或\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod --namespace default")]),s._v("\nNo resources found"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看kube-system命名空间中的Pod\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get namespace")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME STATUS AGE \ndefault Active 17h \nkube-node-lease Active 17h \nkube-public Active 17h \nkube-system Active 17h 确认有此命名空间\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pod -n kube- system")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE \ncalico-node-896hj 1/2 Running 0 17h calico-node-q4w7q 2/2 Running 0 17h calico-node-qzws6 1/2 Running 0 17h calico-typha-7d87d68466-5mdw4 1/1 Running 0 17h coredns-5c98db65d4-9l4tp 1/1 Running 0 17h coredns-5c98db65d4-sqxj7 1/1 Running 0 17h etcd-master1 1/1 Running 0 17h kube-apiserver-master1 1/1 Running 0 17h kube-controller-manager-master1 1/1 Running 0 17h kube-proxy-4sgmb 1/1 Running 0 17h kube-proxy-crmq2 1/1 Running 0 17h kube-proxy-sqhp4 1/1 Running 0 17h\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"创建pod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建pod"}},[s._v("#")]),s._v(" 创建Pod")]),s._v(" "),a("blockquote",[a("p",[s._v("由于网络原因，建议提前准备好容器镜像。本次使用nginx:latest容器镜像。")])]),s._v(" "),a("h3",{attrs:{id:"编写用于创建pod资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写用于创建pod资源清单文件"}},[s._v("#")]),s._v(" 编写用于创建Pod资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat 02-create-pod.yaml")]),s._v("\napiVersion: v1\nkind: Pod\nmetadata:\n    name: pod1\nspec:\n    containers:\n    "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: ngninx-pod\n      image: nginx:latest\n      ports:\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: nginxport\n          containerPort: 80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br")])]),a("h3",{attrs:{id:"应用用于创建pod资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用用于创建pod资源清单文件"}},[s._v("#")]),s._v(" 应用用于创建Pod资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f 02-create-pod.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\npod/pod1 created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"验证pod是否被创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证pod是否被创建"}},[s._v("#")]),s._v(" 验证Pod是否被创建")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看已创建pod\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE \npod1 1/1 Running 0 88s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n通过指定默认命名空间查看已创建pod \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -n default")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE \npod1 1/1 Running 0 2m43s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看pod更加详细信息 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -o wide")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GAT \npod1 1/1 Running 0 9m5s 172"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("1"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("2 node2 <none> <none>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"prod访问"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#prod访问"}},[s._v("#")]),s._v(" Prod访问")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://172.16.1.2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\n<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html> <html> <head> <title>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title> <style> body "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("width: 35em"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" margin: 0 auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" font-family: Tahoma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Verdana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sans-serif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("style> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head> <body> <h1>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("h1> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" you see this page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" the nginx web server is successfully installed and working"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Further configuration is required"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" online documentation and support please refer to <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.org/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <br/> Commercial support is available at <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.com/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p><em>Thank you "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("em><"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body><"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h2",{attrs:{id:"删除prod"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除prod"}},[s._v("#")]),s._v(" 删除Prod")]),s._v(" "),a("blockquote",[a("p",[s._v("可通过命令行删除，也可通过资源清单(YAML)文件删除。")])]),s._v(" "),a("h3",{attrs:{id:"kubectl命令行删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#kubectl命令行删除"}},[s._v("#")]),s._v(" kubectl命令行删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete pods pod1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\npod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pod1"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"通过kubectl使用pod资源清单文件删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl使用pod资源清单文件删除"}},[s._v("#")]),s._v(" 通过kubectl使用Pod资源清单文件删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 yamldir]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete -f 02-create-pod.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\npod "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"pod1"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h1",{attrs:{id:"k8s集群核心概念-controller-控制器"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群核心概念-controller-控制器"}},[s._v("#")]),s._v(" k8s集群核心概念 Controller(控制器)")]),s._v(" "),a("h2",{attrs:{id:"controller介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#controller介绍"}},[s._v("#")]),s._v(" Controller介绍")]),s._v(" "),a("p",[s._v("控制器")]),s._v(" "),a("p",[s._v("用于对应用运行的资源对象进行监控")]),s._v(" "),a("p",[s._v("当Pod出现问题时，会把Pod重新拉起，以达到用户的期望状态")]),s._v(" "),a("h2",{attrs:{id:"controller分类"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#controller分类"}},[s._v("#")]),s._v(" Controller分类")]),s._v(" "),a("p",[s._v("常见Pod控制器：")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("控制器名称")]),s._v(" "),a("th",[s._v("作用")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[s._v("Deployment")]),s._v(" "),a("td",[s._v("声明式更新控制器，用于发布无状态应用")])]),s._v(" "),a("tr",[a("td",[s._v("ReplicaSet")]),s._v(" "),a("td",[s._v("副本集控制器，用于对Pod进行副本规模扩大或剪裁")])]),s._v(" "),a("tr",[a("td",[s._v("StatefulSet")]),s._v(" "),a("td",[s._v("有状态副本集，用于发布有状态应用")])]),s._v(" "),a("tr",[a("td",[s._v("DaemonSet")]),s._v(" "),a("td",[s._v("在k8s集群每一个Node上运行一个副本，用于发布监控或日志收集类等应用")])]),s._v(" "),a("tr",[a("td",[s._v("Job")]),s._v(" "),a("td",[s._v("运行一次性作业任务")])]),s._v(" "),a("tr",[a("td",[s._v("CronJob")]),s._v(" "),a("td",[s._v("运行周期性作业任务")])]),s._v(" "),a("tr",[a("td"),s._v(" "),a("td")])])]),s._v(" "),a("h2",{attrs:{id:"deployment控制器介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#deployment控制器介绍"}},[s._v("#")]),s._v(" Deployment控制器介绍")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("具有上线部署、滚动升级、创建副本、回滚到以前某一版本（成功/ 稳定）等功能")])]),s._v(" "),a("li",[a("p",[s._v("Deployment包含ReplicaSet，除非需要自定义升级功能")]),s._v(" "),a("p",[s._v("或者根本不需要升级Pod，否则还是建议使用")]),s._v(" "),a("p",[s._v("Deployment而不直接使用Replica Set 。")])])]),s._v(" "),a("h2",{attrs:{id:"创建deployment控制器类型应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建deployment控制器类型应用"}},[s._v("#")]),s._v(" 创建Deployment控制器类型应用")]),s._v(" "),a("h3",{attrs:{id:"通过kubectl命令行创建-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl命令行创建-2"}},[s._v("#")]),s._v(" 通过kubectl命令行创建")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl run nginx-app --image=nginx:latest --image-pull-policy=IfNotPresent --replicas=2")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx-app created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("说明\nnginx-app 是deployment控制器类型的应用名称 \nnginx:latest 是应用运行的Pod中的Container所使用的 镜像\nIfNotPresent 是Container容器镜像下载策略，如果本 地有镜像，使用本地，如果本地没有镜像，下载镜像 \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("replicas=2 是指应用运行的Pod共计2个副本，这是用 户的期望值，Deployment控制器中的ReplicaSet控制器会 一直监控此应用运行的Pod副本状态，如果数量达不到用户期 望，就会重新拉起一个新的Pod，会让Pod数量一直维持在用 户期望值数量。\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看Deployment控制器类型应用 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deployment.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY UP-TO-DATE AVAILABLE AGE \nnginx-app 2/2 2 2 2m46s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看ReplicaSet控制器类型 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get replicaset")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME DESIRED CURRENT READY AGE \nnginx-app-84c4bb6478 2 2 2 3m14s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看Pod状态 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE \nnginx-app-84c4bb6478-c72fj 1/1 Running 0 3m37s \nnginx-app-84c4bb6478-cxjqn 1/1 Running 0 3m37s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看Pod状态，显示更宽泛信息 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods -o wide")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE IP NODE NOMINATED NODE READINESS GATES nginx-app-84c4bb6478-c72fj 1/1 Running 0 5m52s 172"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("215"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("5 work1 <none> <none> nginx-app-84c4bb6478-cxjqn 1/1 Running 0 5m52s 172"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("16"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("123"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("56 work2 <none> <none>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n访问Pod \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://172.16.215.5 ")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://172.16.123.56")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\n访问Pod输出web页面信息 \n<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html> <html> <head> <title>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title> <style> body "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("width: 35em"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" margin: 0 auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" font-family: Tahoma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Verdana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sans-serif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("style> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head> <body> <h1>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("h1> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" you see this page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" the nginx web server is successfully installed and working"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Further configuration is required"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" online documentation and support please refer to<a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.org/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <br/> Commercial support is available at <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.com/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p><em>Thank you "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("em><"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h3",{attrs:{id:"通过资源清单文件创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过资源清单文件创建"}},[s._v("#")]),s._v(" 通过资源清单文件创建")]),s._v(" "),a("h4",{attrs:{id:"编写用于创建deployment控制器类型应用资源清单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写用于创建deployment控制器类型应用资源清单"}},[s._v("#")]),s._v(" 编写用于创建Deployment控制器类型应用资源清单")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat 03-creat-deployment- app.yaml")]),s._v("\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: nginx-apps\n    labels:\n      app: nginx\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx\n    template:\n      metadata:\n        labels:\n          app: nginx\n      spec:\n        containers:\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: nginxapp\n          image: nginx:latest\n          imagePullPolicy: IfNotPresent\n          ports:\n          "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" containerPort: 80 \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br")])]),a("h4",{attrs:{id:"应用创建deployment控制器类型应用资源清单"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用创建deployment控制器类型应用资源清单"}},[s._v("#")]),s._v(" 应用创建Deployment控制器类型应用资源清单")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f 03-creat- deployment-app.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx-apps created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"验证资源清单应用后结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证资源清单应用后结果"}},[s._v("#")]),s._v(" 验证资源清单应用后结果")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看Deployment控制器类型应用 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deployment.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY UP-TO-DATE AVAILABLE AGE \nnginx-apps 1/1 1 1 78s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看ReplicaSet控制器类型应用 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get replicaset.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看Pod状态 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get pods")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY STATUS RESTARTS AGE \nnginx-apps-66dcfbcd96-c8bjv 1/1 Running 0 2m9s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h2",{attrs:{id:"删除deployment控制器类型应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除deployment控制器类型应用"}},[s._v("#")]),s._v(" 删除Deployment控制器类型应用")]),s._v(" "),a("blockquote",[a("p",[s._v("带有控制器类型的Pod不能随便删除，如果必须删除，请删除控制器类型的应用名称。")])]),s._v(" "),a("h3",{attrs:{id:"通过kubectl命令行删除-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl命令行删除-2"}},[s._v("#")]),s._v(" 通过kubectl命令行删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deployment.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY UP-TO-DATE AVAILABLE AGE \nnginx-app 2/2 2 2 20m\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete deployment.apps nginx-app")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-app"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"通过kubectl应用资源清单文件删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过kubectl应用资源清单文件删除"}},[s._v("#")]),s._v(" 通过kubectl应用资源清单文件删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deployment.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY UP-TO-DATE AVAILABLE AGE \nnginx-apps 1/1 1 1 8m15s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete -f 03-creat-deployment-app.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-apps"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h1",{attrs:{id:"k8s集群核心概念-service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#k8s集群核心概念-service"}},[s._v("#")]),s._v(" k8s集群核心概念 Service")]),s._v(" "),a("h2",{attrs:{id:"service介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service介绍"}},[s._v("#")]),s._v(" Service介绍")]),s._v(" "),a("p",[s._v("不是实体服务")]),s._v(" "),a("p",[s._v("是一条iptables或ipvs的转发规则")]),s._v(" "),a("h2",{attrs:{id:"service作用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service作用"}},[s._v("#")]),s._v(" Service作用")]),s._v(" "),a("p",[s._v("通过Service为pod客户端提供访问pod方法，即客户端访问pod入口")]),s._v(" "),a("p",[s._v("Service通过Pod标签与Pod进行关联")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/04/5d428075a086e7de.png",alt:"5d428075a086e7de.png"}})]),s._v(" "),a("h2",{attrs:{id:"service类型"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service类型"}},[s._v("#")]),s._v(" Service类型")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("ClusterIP")]),s._v(" "),a("p",[s._v("默认，分配一个集群内部可以访问的虚拟IP")])]),s._v(" "),a("li",[a("p",[s._v("NodePort")]),s._v(" "),a("p",[s._v("在每个Node上分配一个端口作为外部访问入口")])]),s._v(" "),a("li",[a("p",[s._v("LoadBalancer")]),s._v(" "),a("p",[s._v("工作在特定的Cloud Provider上，例如Google Cloud，AWS，OpenStack")])]),s._v(" "),a("li",[a("p",[s._v("ExternalName")]),s._v(" "),a("p",[s._v("表示把集群外部的服务引入到集群内部中来，即实现了")]),s._v(" "),a("p",[s._v("集群内部pod和集群外部的服务进行通信")])])]),s._v(" "),a("h2",{attrs:{id:"service参数"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service参数"}},[s._v("#")]),s._v(" Service参数")]),s._v(" "),a("ul",[a("li",[a("p",[s._v("port 访问service使用的端口")])]),s._v(" "),a("li",[a("p",[s._v("targetPort Pod中容器端口")])]),s._v(" "),a("li",[a("p",[s._v("NodePort 通过Node实现外网用户访问k8s集群内service")]),s._v(" "),a("p",[s._v("(30000-32767)")])])]),s._v(" "),a("h2",{attrs:{id:"service创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#service创建"}},[s._v("#")]),s._v(" Service创建")]),s._v(" "),a("p",[s._v("Service的创建在工作中有两种方式，一是命令行创建，二是通过资源清单文件YAML文件创建")]),s._v(" "),a("h3",{attrs:{id:"通过命令行创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过命令行创建"}},[s._v("#")]),s._v(" 通过命令行创建")]),s._v(" "),a("p",[s._v("默认创建Service为ClusterIP类型")]),s._v(" "),a("h4",{attrs:{id:"创建deployment类型应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建deployment类型应用"}},[s._v("#")]),s._v(" 创建Deployment类型应用")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl run nginx-app -- image=nginx:latest --image-pull-policy=IfNotPresent --replicas=1")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx-app created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"验证deployment类型应用创建情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证deployment类型应用创建情况"}},[s._v("#")]),s._v(" 验证Deployment类型应用创建情况")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deployment.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY UP-TO-DATE AVAILABLE AGE \nnginx-app 1/1 1 1 71s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"创建service与deployment类型应用关联"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建service与deployment类型应用关联"}},[s._v("#")]),s._v(" 创建Service与Deployment类型应用关联")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n创建service \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl expose deployment.apps nginx-app --type=ClusterIP -- target-port=80 --port=80")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nservice/nginx-app exposed\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("说明\nexpose 创建service \ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps 控制器类型 \nnginx-app 应用名称，也是service名称 \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("type")]),s._v("=ClusterIP 指定service类型 \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("target-port=80 指定Pod中容器端口 \n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),s._v("port=80 指定service端口\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("h4",{attrs:{id:"访问service以实现访问pod目的"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#访问service以实现访问pod目的"}},[s._v("#")]),s._v(" 访问Service以实现访问Pod目的")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看Service创建情况\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get service")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("TYPE")]),s._v(" CLUSTER-IP EXTERNAL-IP PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AGE \nnginx-app ClusterIP 10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("109"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("21"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("171 <none> 80/TCP 5m15s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n访问Service \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://10.109.21.171")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\n<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html> <html> <head> <title>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title> <style> body "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("width: 35em"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" margin: 0 auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" font-family: Tahoma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Verdana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sans-serif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("style> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head> <body> <h1>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("h1> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" you see this page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" the nginx web server is successfully installed andworking"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Further configuration is required"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" online documentation and support please refer to <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.org/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <br/> Commercial support is available at <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.com/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p><em>Thank you "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("em><"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"通过资源清单yaml文件创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过资源清单yaml文件创建"}},[s._v("#")]),s._v(" 通过资源清单YAML文件创建")]),s._v(" "),a("h4",{attrs:{id:"编写用于创建service资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写用于创建service资源清单文件"}},[s._v("#")]),s._v(" 编写用于创建Service资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat create-deployment-service-clusterip.yaml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\napiVersion: apps/v1\nkind: Deployment \nmetadata:\n  name: nginx-apps\n  labels:\n    app: nginx\nspec: \n  replicas: 1 \n  selector: \n    matchLabels: \n      app: nginx\n  template: \n    metadata: \n      labels: \n        app: nginx\n    spec:\n      containers:\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: nginxapps\n        image: nginx:latest\n        imagePullPolicy: IfNotPresent\n        ports:\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" containerPort: 80\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\napiVersion: v1\nkind: Service \nmetadata: \n  name: nginx-apps\nspec:\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("type")]),s._v(": ClusterIP\n  selector:\n    app: nginx\n  ports:\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" protocol: TCP\n    port: 80\n    targetPort: 80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("h4",{attrs:{id:"应用用于创建service资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用用于创建service资源清单文件"}},[s._v("#")]),s._v(" 应用用于创建Service资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n应用create-deployment-service-clusterip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f create-deployment-service-clusterip.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx-apps created \nservice/nginx-apps created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"验证资源对象创建结果"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证资源对象创建结果"}},[s._v("#")]),s._v(" 验证资源对象创建结果")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看deployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get deployment.apps")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME READY UP-TO-DATE AVAILABLE AGE \nnginx-apps 1/1 1 1 48s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get service")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("TYPE")]),s._v(" CLUSTER-IP EXTERNAL-IP PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AGE \nnginx-apps ClusterIP 10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("105"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("7"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("229 <none> 80/TCP 2m22s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl http://10.105.7.229")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\n<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("DOCTYPE html> <html> <head> <title>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("title> <style> body "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("width: 35em"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("margin: 0 auto"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" font-family: Tahoma"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Verdana"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" Arial"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" sans-serif"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("style> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("head> <body> <h1>Welcome to nginx!<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("h1> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("If")]),s._v(" you see this page"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v(" the nginx web server is successfully installed and working"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" Further configuration is required"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p>"),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("For")]),s._v(" online documentation and support please refer to <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.org/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("org<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <br/> Commercial support is available at <a href="),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://nginx.com/"')]),s._v(">nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("com<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("a>"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v(" <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <p><em>Thank you "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("using")]),s._v(" nginx"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("<"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("em><"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("p> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("body> <"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("/")]),s._v("html>\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"基于资源清单yaml文件创建nodeport类型service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#基于资源清单yaml文件创建nodeport类型service"}},[s._v("#")]),s._v(" 基于资源清单YAML文件创建NodePort类型Service")]),s._v(" "),a("h4",{attrs:{id:"编写资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#编写资源清单文件"}},[s._v("#")]),s._v(" 编写资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cat create-deployment-service-nodeport.yaml")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\napiVersion: apps/v1 \nkind: Deployment \nmetadata:\n  name: nginx-app-nodeport\n  labels:\n    app: nginx-app\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: nginx-app\n  template:\n    metadata:\n      labels:\n        app: nginx-app4\n    spec:\n      containers:\n      "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" name: nginx\n        image: nginx:latest\n        imagePullPolicy: IfNotPresent\n        ports:\n        "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" containerPort: 80\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("--")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v("\napiVersion: v1\nkind: Service\nmetadata:\n  name: nginx-app\nspec:\n  selector:\n    app: nginx-app\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("type")]),s._v(": NodePort\n  ports:\n  "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("-")]),s._v(" protocol: TCP\n    nodePort: 30001\n    port: 80\n    targetPort: 80\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br")])]),a("h4",{attrs:{id:"应用资源清单文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#应用资源清单文件"}},[s._v("#")]),s._v(" 应用资源清单文件")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n应用create-deployment-service-nodeport"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl apply -f create-deployment-service-nodeport.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps/nginx-app-nodeport created \nservice/nginx-app created\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("h4",{attrs:{id:"验证资源对象创建情况"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#验证资源对象创建情况"}},[s._v("#")]),s._v(" 验证资源对象创建情况")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看service创建 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get service")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("TYPE")]),s._v(" CLUSTER-IP EXTERNAL-IP PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AGE \nnginx-app NodePort 10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("98"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("196"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("211 <none> 80:30001/TCP 26s\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看k8s集群所有主机30001端口侦听状态 \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@XXX ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# ss -anput | grep ":30001"')]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ntcp LISTEN 0 128 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":30001 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("::"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(":"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("*")]),s._v(" users: "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"kube-proxy"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("pid=4164"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("fd=21"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h4",{attrs:{id:"在k8s集群外访问service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在k8s集群外访问service"}},[s._v("#")]),s._v(" 在k8s集群外访问Service")]),s._v(" "),a("blockquote",[a("p",[s._v("在物理机浏览器中访问即可验证。")])]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/04/4d816fe4bf1dfc7f.png",alt:"4d816fe4bf1dfc7f.png"}})]),s._v(" "),a("h2",{attrs:{id:"删除service"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#删除service"}},[s._v("#")]),s._v(" 删除Service")]),s._v(" "),a("h3",{attrs:{id:"通过命令行删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过命令行删除"}},[s._v("#")]),s._v(" 通过命令行删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n查看servie \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl get service")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nNAME "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("TYPE")]),s._v(" CLUSTER-IP EXTERNAL-IP PORT"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("S"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" AGE \nnginx-app ClusterIP 10"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("109"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("21"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("171 <none> 80/TCP 18m\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令删除service \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete service nginx-app")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\nservice "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-app"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"通过资源清单yaml文件删除"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#通过资源清单yaml文件删除"}},[s._v("#")]),s._v(" 通过资源清单YAML文件删除")]),s._v(" "),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("命令\n应用create-deployment-service-clusterip"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("yaml \n"),a("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("[root@master1 ~]")]),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kubectl delete -f create-deployment-service-clusterip.yaml")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("div",{staticClass:"language-powershell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-powershell"}},[a("code",[s._v("输出\ndeployment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("apps "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-apps"')]),s._v(" deleted \nservice "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"nginx-apps"')]),s._v(" deleted\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])])])}),[],!1,null,null,null);a.default=n.exports}}]);