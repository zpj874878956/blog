(window.webpackJsonp=window.webpackJsonp||[]).push([[354],{707:function(a,t,r){"use strict";r.r(t);var e=r(0),s=Object(e.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("h3",{attrs:{id:"环境初始化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#环境初始化"}},[a._v("#")]),a._v(" 环境初始化")]),a._v(" "),t("p",[a._v("查验版本")]),a._v(" "),t("p",[a._v("#cat /etc/redhat-release")]),a._v(" "),t("p",[a._v("关闭防火墙，selinux\nsystemctl stop firewalld.service && systemctl disable firewalld.service\nsed -i ‘s/^SELINUX=enforcing/#SELINUX=enforcing\\nSELINUX=disabled/g’ /etc/selinux/config\n配置时间同步\n配置yum源\n优化ssh服务\n安装必要软件包\n以上过程不一一细讲")]),a._v(" "),t("h3",{attrs:{id:"安装依赖包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装依赖包"}},[a._v("#")]),a._v(" 安装依赖包")]),a._v(" "),t("p",[a._v("yum -y install OpenIPMI OpenIPMI-modalias net-snmp-libs net-snmp-agent-libs fping unixODBC")]),a._v(" "),t("p",[a._v("fping需要epel源，若没有的话也可以使用rpm包进行安装\nwget http://www.rpmfind.net/linux/dag/redhat/el7/en/x86_64/dag/RPMS/fping-3.10-1.el7.rf.x86_64.rpm\nrpm -ivh fping-3.10-1.el7.rf.x86_64.rpm")]),a._v(" "),t("h3",{attrs:{id:"下载对应版本的zabbix-proxy-mysql安装包"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#下载对应版本的zabbix-proxy-mysql安装包"}},[a._v("#")]),a._v(" 下载对应版本的zabbix-proxy-mysql安装包")]),a._v(" "),t("p",[a._v("官网：https://repo.zabbix.com/zabbix/5.0/\n由于我这里的zabbix-server端的版本是5.0.19，因此这里的zabbix-proxy版本也用的是5.0.X;\nyum -y install wget\nwget https://repo.zabbix.com/zabbix/5.0/rhel/7/x86_64/zabbix-proxy-mysql-5.0.25-1.el7.x86_64.rpm\nrpm -ivh zabbix-proxy-mysql-5.0.25-1.el7.x86_64.rpm")]),a._v(" "),t("h3",{attrs:{id:"安装并初始化数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#安装并初始化数据库"}},[a._v("#")]),a._v(" 安装并初始化数据库")]),a._v(" "),t("p",[a._v("yum -y install mariadb-server\nsystemctl restart mariadb && systemctl enable mariadb\nnetstat -anptu | grep -i mysqld\n*初始化数据库\nmysql_secure_installation")]),a._v(" "),t("h3",{attrs:{id:"配置zabbix-proxy数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#配置zabbix-proxy数据库"}},[a._v("#")]),a._v(" 配置zabbix-proxy数据库")]),a._v(" "),t("h4",{attrs:{id:"登录数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#登录数据库"}},[a._v("#")]),a._v(" 登录数据库")]),a._v(" "),t("p",[a._v("[root@CentOS79 ~]# mysql -uroot -p")]),a._v(" "),t("h4",{attrs:{id:"创建zabbix-proxy库并设置字符集"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建zabbix-proxy库并设置字符集"}},[a._v("#")]),a._v(" 创建zabbix_proxy库并设置字符集")]),a._v(" "),t("p",[a._v("MariaDB [(none)]> create database zabbix_proxy default character set utf8 collate utf8_bin;")]),a._v(" "),t("h4",{attrs:{id:"对root用户进行授权"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对root用户进行授权"}},[a._v("#")]),a._v(" 对root用户进行授权")]),a._v(" "),t("p",[a._v("MariaDB [(none)]> grant all privileges on . to root@127.0.0.1 identified by ‘root@123’;")]),a._v(" "),t("h4",{attrs:{id:"创建zabbix用户"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#创建zabbix用户"}},[a._v("#")]),a._v(" 创建zabbix用户")]),a._v(" "),t("p",[a._v("MariaDB [zabbix_proxy]> create user zabbix@localhost identified by ‘zabbix@123’;")]),a._v(" "),t("h4",{attrs:{id:"对zabbix进行授权-授权其仅能访问zabbix-proxy库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#对zabbix进行授权-授权其仅能访问zabbix-proxy库"}},[a._v("#")]),a._v(" 对zabbix进行授权(授权其仅能访问zabbix_proxy库）")]),a._v(" "),t("p",[a._v("MariaDB [zabbix_proxy]> grant all privileges on zabbix_proxy.* to zabbix@localhost identified by ‘zabbix@123’;")]),a._v(" "),t("h4",{attrs:{id:"quit推出数据库"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#quit推出数据库"}},[a._v("#")]),a._v(" quit推出数据库")]),a._v(" "),t("h3",{attrs:{id:"导入zabbix-proxy-mysql库文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#导入zabbix-proxy-mysql库文件"}},[a._v("#")]),a._v(" 导入zabbix-proxy-mysql库文件")]),a._v(" "),t("p",[a._v("[root@CentOS79 ~]# zcat /usr/share/doc/zabbix-proxy-mysql-5.0.25/schema.sql.gz | mysql -uzabbix -p zabbix_proxy")]),a._v(" "),t("h3",{attrs:{id:"修改配置文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#修改配置文件"}},[a._v("#")]),a._v(" 修改配置文件")]),a._v(" "),t("p",[a._v("[root@CentOS79 ~]# vim /etc/zabbix/zabbix_proxy.conf\n编辑如下参数：\n30 Server=10.0.3.246 ##配置zabbix-server服务端地址，zabbix-proxy会将收集到数 据发往该地址\n49 Hostname=YCGF-Zabbix-Proxy ##配置主机名\n163 DBHost=localhost ##配置数据库主机（默认localhost即可）\n174 DBName=zabbix_proxy ##配置数据库名成（就是你刚创建的库名）\n189 DBUser=zabbix ##配置书库据操作用户\n198 DBPassword=Longi@123 ##输入数据库用户密码\n其他配置默认即可\n[root@CentOS79 zabbix]# vim /etc/zabbix/zabbix_agentd.conf\n100 Server=10.0.3.246 ##配置zabbix-server端地址")]),a._v(" "),t("h3",{attrs:{id:"重启zabbix-proxy和zabbix-agent服务"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重启zabbix-proxy和zabbix-agent服务"}},[a._v("#")]),a._v(" 重启zabbix-proxy和zabbix-agent服务")]),a._v(" "),t("p",[a._v("systemctl restart zabbix-proxy.service && systemctl enable zabbix-proxy.service\nsystemctl restart zabbix-agent.service && systemctl enable zabbix-agent.service")]),a._v(" "),t("h3",{attrs:{id:"添加agent代理配置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#添加agent代理配置"}},[a._v("#")]),a._v(" 添加agent代理配置")]),a._v(" "),t("p",[a._v("登录zabbix-web——管理——agent代理程序——创建代理——根据页面填空即可")]),a._v(" "),t("p",[t("strong",[a._v("此处我选择的是被动式。")]),a._v("\n主动模式：客户端每隔一段时间主动向服务端发起连接请求–>服务端收到请求,查询客户端需要取的item信息,发送给客户端–>客户端收集数据发送服务端–>结束。（收集数据时间一致）\n被动模式：客户端开一个端口默认10050,等待服务端来取数据,然后客户端收集数据发送到服务端,然后结束。")]),a._v(" "),t("p",[a._v("原文链接："),t("a",{attrs:{href:"https://blog.csdn.net/sinat_41836475/article/details/125803897",target:"_blank",rel:"noopener noreferrer"}},[a._v("CentOS7.9部署zabbix-proxy-5.0.25过程简记_王大江1018的博客-CSDN博客"),t("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=s.exports}}]);