(window.webpackJsonp=window.webpackJsonp||[]).push([[98],{452:function(s,e,n){"use strict";n.r(e);var a=n(0),r=Object(a.a)({},(function(){var s=this,e=s._self._c;return e("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[e("h3",{attrs:{id:"一、release介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#一、release介绍"}},[s._v("#")]),s._v(" 一、release介绍")]),s._v(" "),e("p",[s._v("在以上的章节中曾介绍过 helm 的两大术语：chart 和 release。如果可以把 chart 比作程序源码的话，那么 release 则可以看做是程序运行时的进程。")]),s._v(" "),e("p",[s._v("chart 是用户可直接感知的对象（其表现形式就是 .tgz 格式的压缩包）；而 release 理解起来则比较抽象，它是专属于 helm 的一个逻辑概念，用来标识在 k8s 中运行的一组资源。有了 release，helm 在操作 k8s 时，就再也不用逐个管理资源，而可以将一组相关的资源当做一个整体来操作，比如删除或升级。")]),s._v(" "),e("h3",{attrs:{id:"二、release查看"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#二、release查看"}},[s._v("#")]),s._v(" 二、release查看")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("ls")]),s._v("\nNAME    NAMESPACE       REVISION        UPDATED STATUS  CHART   APP VERSION\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("h3",{attrs:{id:"三、release安装"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#三、release安装"}},[s._v("#")]),s._v(" 三、release安装")]),s._v(" "),e("p",[s._v("在线安装指定的 chart，比如 nginx-ingress。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm repo "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" nginx-stable https://helm.nginx.com/stable\n$ helm repo update\n\n$ helm search repo nginx-ingress\nNAME                            CHART VERSION   APP VERSION     DESCRIPTION\naliyun/nginx-ingress            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),s._v(".5           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.10")]),s._v(".2          An nginx Ingress controller that uses ConfigMap"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\nnginx-stable/nginx-ingress      "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.9")]),s._v(".3           "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          NGINX Ingress Controller\nstable/nginx-ingress            "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.41")]),s._v(".3          v0.34.1         DEPRECATED"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" An nginx Ingress controller that us"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\naliyun/nginx-lego               "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v(".1                           Chart "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" nginx-ingress-controller and kube-lego\nstable/nginx-lego               "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.3")]),s._v(".1                           Chart "),e("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" nginx-ingress-controller and kube-lego\n\n$ helm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" mynginx-ingress nginx-stable/nginx-ingress\nNAME: mynginx-ingress\nLAST DEPLOYED: Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":17:57 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\nNAMESPACE: default\nSTATUS: deployed\nREVISION: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nTEST SUITE: None\nNOTES:\nThe NGINX Ingress Controller has been installed.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br"),e("span",{staticClass:"line-number"},[s._v("20")]),e("br")])]),e("h3",{attrs:{id:"四、release更新"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#四、release更新"}},[s._v("#")]),s._v(" 四、release更新")]),s._v(" "),e("p",[s._v("如果想修改运行时 release 的配置，可以使用 "),e("code",[s._v("--set")]),s._v(" 或者 "),e("code",[s._v("-f")]),s._v(" 选项进行修改。")]),s._v(" "),e("p",[s._v("基于命令行更新")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mynginx-ingress 是上面创建的 release 名；nginx-stable/nginx-ingress 是在线 chart 名")]),s._v("\n\n$ helm upgrade "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--set")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("controller.hostNetwork")]),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true mynginx-ingress nginx-stable/nginx-ingress\nRelease "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynginx-ingress"')]),s._v(" has been upgraded. Happy Helming"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nNAME: mynginx-ingress\nLAST DEPLOYED: Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20:05 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\nNAMESPACE: default\nSTATUS: deployed\nREVISION: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("\nTEST SUITE: None\nNOTES:\nThe NGINX Ingress Controller has been installed.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br")])]),e("p",[s._v("基于文件更新release")]),s._v(" "),e("p",[s._v("如果想基于文件来更新 release，则首先需要将 chart 下载到本地，然后手动修改 chart 的 "),e("code",[s._v("values.yaml")]),s._v(" 文件。")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm pull nginx-stable/nginx-ingress\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载 chart")]),s._v("\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" zxf nginx-ingress-0.9.3.tgz\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压缩 chart")]),s._v("\n\n$ "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s/hostNetwork: false/hostNetwork: true/g'")]),s._v(" nginx-ingress/values.yaml\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 修改 values.yaml 内容。比如修改 hostNetwork 的值为 true")]),s._v("\n\n$ helm upgrade mynginx-ingress nginx-ingress "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" nginx-ingress/values.yaml\nRelease "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynginx-ingress"')]),s._v(" has been upgraded. Happy Helming"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\nNAME: mynginx-ingress\nLAST DEPLOYED: Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":23:50 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("\nNAMESPACE: default\nSTATUS: deployed\nREVISION: "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("\nTEST SUITE: None\nNOTES:\nThe NGINX Ingress Controller has been installed.\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br"),e("span",{staticClass:"line-number"},[s._v("10")]),e("br"),e("span",{staticClass:"line-number"},[s._v("11")]),e("br"),e("span",{staticClass:"line-number"},[s._v("12")]),e("br"),e("span",{staticClass:"line-number"},[s._v("13")]),e("br"),e("span",{staticClass:"line-number"},[s._v("14")]),e("br"),e("span",{staticClass:"line-number"},[s._v("15")]),e("br"),e("span",{staticClass:"line-number"},[s._v("16")]),e("br"),e("span",{staticClass:"line-number"},[s._v("17")]),e("br"),e("span",{staticClass:"line-number"},[s._v("18")]),e("br"),e("span",{staticClass:"line-number"},[s._v("19")]),e("br")])]),e("p",[s._v("查看release更新后的新值")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm get values mynginx-ingress\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br")])]),e("h3",{attrs:{id:"五、release版本"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#五、release版本"}},[s._v("#")]),s._v(" 五、release版本")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" mynginx-ingress\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# mynginx-ingress 这个 release 各个历史版本。其中 REVISION 3 是最新的版本。")]),s._v("\nREVISION        UPDATED                         STATUS          CHART                   APP VERSION     DESCRIPTION\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":17:57 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        superseded      nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Install complete\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20:05 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        superseded      nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Upgrade complete\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":23:50 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        deployed        nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Upgrade complete\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br")])]),e("h3",{attrs:{id:"六、release回滚"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#六、release回滚"}},[s._v("#")]),s._v(" 六、release回滚")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm rollback mynginx-ingress "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\nRollback was a success"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v(" Happy Helming"),e("span",{pre:!0,attrs:{class:"token operator"}},[s._v("!")]),s._v("\n\n$ helm "),e("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" mynginx-ingress\nREVISION        UPDATED                         STATUS          CHART                   APP VERSION     DESCRIPTION\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":17:57 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        superseded      nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Install complete\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":20:05 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        superseded      nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Upgrade complete\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":23:50 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        superseded      nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Upgrade complete\n"),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("               Sat Jun "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("16")]),s._v(":29:59 "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("2021")]),s._v("        deployed        nginx-ingress-0.9.3     "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.11")]),s._v(".3          Rollback to "),e("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br"),e("span",{staticClass:"line-number"},[s._v("3")]),e("br"),e("span",{staticClass:"line-number"},[s._v("4")]),e("br"),e("span",{staticClass:"line-number"},[s._v("5")]),e("br"),e("span",{staticClass:"line-number"},[s._v("6")]),e("br"),e("span",{staticClass:"line-number"},[s._v("7")]),e("br"),e("span",{staticClass:"line-number"},[s._v("8")]),e("br"),e("span",{staticClass:"line-number"},[s._v("9")]),e("br")])]),e("h3",{attrs:{id:"七、release卸载"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#七、release卸载"}},[s._v("#")]),s._v(" 七、release卸载")]),s._v(" "),e("div",{staticClass:"language-bash line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[s._v("$ helm uninstall mynginx-ingress\nrelease "),e("span",{pre:!0,attrs:{class:"token string"}},[s._v('"mynginx-ingress"')]),s._v(" uninstalled\n")])]),s._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[s._v("1")]),e("br"),e("span",{staticClass:"line-number"},[s._v("2")]),e("br")])]),e("hr"),s._v(" "),e("p",[e("a",{attrs:{href:"https://www.cnblogs.com/lvzhenjiang/p/14878530.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),e("OutboundLink")],1)])])}),[],!1,null,null,null);e.default=r.exports}}]);