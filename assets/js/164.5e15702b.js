(window.webpackJsonp=window.webpackJsonp||[]).push([[164],{517:function(a,s,e){"use strict";e.r(s);var t=e(0),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"第一步-安装acme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第一步-安装acme"}},[a._v("#")]),a._v(" 第一步，安装acme")]),a._v(" "),s("p",[a._v("下载脚本：https://github.com/acmesh-official/acme.sh/archive/refs/tags/3.0.7.tar.gz")]),a._v(" "),s("p",[a._v("执行一下命令")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-xf")]),a._v(" acme.sh-3.0.7.tar.gz\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" acme.sh-3.0.7\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" acme.sh "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--install")]),a._v("\n\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h1",{attrs:{id:"第二步-配置acme"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#第二步-配置acme"}},[a._v("#")]),a._v(" 第二步，配置acme")]),a._v(" "),s("p",[a._v("去Cloudflare找到你的个人api key，如果没有Cloudflare就去注册一个。")]),a._v(" "),s("h4",{attrs:{id:"方法a"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法a"}},[a._v("#")]),a._v(" 方法A")]),a._v(" "),s("p",[a._v("首先你需要获取你的"),s("a",{attrs:{href:"https://dash.cloudflare.com/profile/api-tokens",target:"_blank",rel:"noopener noreferrer"}},[a._v("Cloudflare Global API Key"),s("OutboundLink")],1),a._v("。访问上面这个链接，然后在"),s("code",[a._v("API 密钥")]),a._v("选项卡中找到"),s("code",[a._v("Global API Key")]),a._v("，点击后面的"),s("code",[a._v("查看")]),a._v("按钮。然后在"),s("code",[a._v("Shell")]),a._v("中执行以下命令，不要忘记替换以下命令行中的部分参数。")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('export CF_Key="这里替换为你的Global API Key"\nexport CF_Email="这里替换为你的Cloudflare账户的电子邮箱"\nacme.sh --issue --dns dns_cf -d example.com -d \'*.example.com\'\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[s("code",[a._v("CF_Key")]),a._v(" 和 "),s("code",[a._v("CF_Email")]),a._v(" 将保存在 "),s("code",[a._v("~/.acme.sh/account.conf")]),a._v("中，并在下次需要时重复使用。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("DNS API 令牌已成功创建\nxxxxxxxxxxx\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("curl")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-X")]),a._v(" GET "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"https://api.cloudflare.com/client/v4/user/tokens/verify"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n     "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Authorization: Bearer xxxxxxxxxxx"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n     "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-H")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"Content-Type:application/json"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("p",[s("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2024/05/d4690152f530f099.png",alt:""}})]),a._v(" "),s("h4",{attrs:{id:"方法b"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方法b"}},[a._v("#")]),a._v(" 方法B")]),a._v(" "),s("p",[a._v("因为某些原因不想使用"),s("code",[a._v("Global API Key")]),a._v("还可以使用"),s("code",[a._v("Api Token")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('export CF_Token="替换为TOKEN"\nexport CF_Account_ID="替换为账户ID"\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h1",{attrs:{id:"更换acme-sh的ca为zerossl"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#更换acme-sh的ca为zerossl"}},[a._v("#")]),a._v(" 更换ACME.sh的CA为ZeroSSL")]),a._v(" "),s("h3",{attrs:{id:"注册一个zerossl账户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#注册一个zerossl账户"}},[a._v("#")]),a._v(" 注册一个ZeroSSL账户")]),a._v(" "),s("p",[a._v("传送门：https://app.zerossl.com/signup")]),a._v(" "),s("h3",{attrs:{id:"获取账户的eab凭证-用来注册acme帐户"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#获取账户的eab凭证-用来注册acme帐户"}},[a._v("#")]),a._v(" 获取账户的EAB凭证，用来注册acme帐户")]),a._v(" "),s("p",[a._v("传送门："),s("a",{attrs:{href:"https://app.zerossl.com/developer",target:"_blank",rel:"noopener noreferrer"}},[a._v("Log In - ZeroSSL"),s("OutboundLink")],1)]),a._v(" "),s("p",[a._v("点击生成会生成你的eab-kid和eab-hmac-key，复制保存下来；")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("acme.sh  --register-account  "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--server")]),a._v(" zerossl "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\n        --eab-kid  你的eab-kid "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n\n        --eab-hmac-key  你的eab-hmac-key\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h3",{attrs:{id:"切换默认ca"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#切换默认ca"}},[a._v("#")]),a._v(" 切换默认CA")]),a._v(" "),s("p",[a._v("切换acme.sh的默认CA为ZeroSSL")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("acme.sh --set-default-ca  --server zerossl\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"申请证书"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#申请证书"}},[a._v("#")]),a._v(" 申请证书")]),a._v(" "),s("h3",{attrs:{id:"方式一"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式一"}},[a._v("#")]),a._v(" 方式一")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("acme.sh --install-cert "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" zzppjj.top "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--key-file /cert/zzppjj.top.key  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--fullchain-file /cert/zzppjj.top.crt "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--reloadcmd")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"systemctl restart nginx"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("h3",{attrs:{id:"方式二"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#方式二"}},[a._v("#")]),a._v(" 方式二")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("acme.sh --install-cert "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" lushihuan.com "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--cert-file      /usr/local/nginx/ssl/cert.pem  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--key-file       /usr/local/nginx/ssl/key.pem  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n--fullchain-file /usr/local/nginx/ssl/fullchain.pem  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--reloadcmd")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"systemctl restart nginx"')]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])])])}),[],!1,null,null,null);s.default=r.exports}}]);