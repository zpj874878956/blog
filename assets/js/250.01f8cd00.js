(window.webpackJsonp=window.webpackJsonp||[]).push([[250],{603:function(s,n,a){"use strict";a.r(n);var e=a(0),r=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h2",{attrs:{id:"apache与nginx的区别"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#apache与nginx的区别"}},[s._v("#")]),s._v(" apache与nginx的区别")]),s._v(" "),n("blockquote",[n("p",[s._v("nginx本身只能处理静态页的解析，如果要解析动态页面的话，需要用到反向代理的功能"),n("br"),s._v("\nnginx有"),n("strong",[s._v("反向代理功能")]),s._v("，能做负载均衡。apache没有"),n("br"),s._v("\nnginx更轻量级，占用的内存很小。而apache更稳定"),n("br"),s._v("\nnginx更适合高并发，因为nginx处理请求属于异步非阻塞的，可以多个连接（万级别）对应一个进程。而apache 则是阻塞型的，一个连接对应一个进程。"),n("br"),s._v("\nnginx 处理 静态资源 性能高于apache，处理 动态语言 性能低于apache，因为nginx处理动态语言经过的层次太多了。")])]),s._v(" "),n("p",[n("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2024/04/bcc3fcb0d39aa2f0.png",alt:""}})]),s._v(" "),n("p",[n("strong",[s._v("A")]),s._v(". 使用nginx的反向代理将请求转发到php-fpm -> "),n("strong",[s._v("B")]),s._v(".fastcgi进程管理器(php-fpm)收到请求后选择并连接一个cgi解释器")]),s._v(" "),n("h2",{attrs:{id:"nginx的两种负载均衡方式"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#nginx的两种负载均衡方式"}},[s._v("#")]),s._v(" nginx的两种负载均衡方式")]),s._v(" "),n("blockquote",[n("p",[s._v("轮询加权(也可以不加权,就是1:1负载)和"),n("br"),s._v("\nip_hash(根据ip分配后端服务器,解决session问题)")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("// 轮询加权\nupstream lb {\n    server 192.168.196.130 weight=1;\n    server 192.168.196.132 weight=2;\n}\n\n// ip_hash轮询\nupstream lb {\n    server 192.168.196.130;\n    server 192.168.196.132;\n    ip_hash;\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h2",{attrs:{id:"服务器环境假设"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#服务器环境假设"}},[s._v("#")]),s._v(" 服务器环境假设")]),s._v(" "),n("blockquote",[n("p",[s._v("假设"),n("br"),s._v("\n192.168.1.111（主） -> 安装有LNMP，进行负载均衡控制"),n("br"),s._v("\n192.168.1.112（从） -> 安装有LNMP，进行应用运行"),n("br"),s._v("\n192.168.1.113（从） -> 安装有LNMP，进行应用运行")])]),s._v(" "),n("h2",{attrs:{id:"负载均衡配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡配置"}},[s._v("#")]),s._v(" 负载均衡配置")]),s._v(" "),n("h3",{attrs:{id:"主服务器-192-168-1-111-负载均衡配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#主服务器-192-168-1-111-负载均衡配置"}},[s._v("#")]),s._v(" 主服务器（192.168.1.111）负载均衡配置")]),s._v(" "),n("blockquote",[n("p",[s._v("vim /opt/nginx/conf/vhosts/zhuifanba.conf")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("upstream load_balance{\n    # 设置负载均衡的机器列表(采用轮询的方式)\n    server 192.168.1.112:80; #从服务器1\n    server 192.168.1.113:80; #从服务器2\n}\n\nserver {\n    listen 80;\n    server_name www.zhuifanba.com;\n    location / {\n        #设置反向代理\n        proxy_pass  http://load_balance;\n        proxy_set_header   Host             $host;\n        proxy_set_header   X-Real-IP        $remote_addr;\n        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n    }\n\n    location ~ .*\\.(php|php5)?$\n    {\n        #设置反向代理\n        proxy_pass  http://load_balance;\n        proxy_set_header   Host             $host;\n        proxy_set_header   X-Real-IP        $remote_addr;\n        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;\n    }\n\n    location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n    {\n        # 设置静态文件的反向代理\n        proxy_pass   http://load_balance;\n        expires      30d;\n    }\n\n    location ~ .*\\.(js|css)?$\n    {\n        # 设置静态文件的反向代理\n        proxy_pass  http://load_balance;\n        expires      1h;\n    }\n\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br")])]),n("h3",{attrs:{id:"从服务器-192-168-1-112-113-运行环境配置"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#从服务器-192-168-1-112-113-运行环境配置"}},[s._v("#")]),s._v(" 从服务器（192.168.1.112~113）运行环境配置")]),s._v(" "),n("blockquote",[n("p",[s._v("vim /opt/nginx/conf/vhosts/zhuifanba.conf")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v("server {\n    listen       80;\n    server_name   www.zhuifanba.com;\n    index index.html index.htm index.php;\n    root /var/www/zhuifanba/frontend/web;\n\n    location / {\n        if (!-e $request_filename){\n            rewrite ^/(.*) /index.php last;\n        }\n    }\n\n    location ~ .*\\.(php|php5)?$\n    {\n        fastcgi_pass  127.0.0.1:9000;\n        fastcgi_index index.php;\n        fastcgi_param  SCRIPT_FILENAME  /var/www/zhuifanba/frontend/web$fastcgi_script_name;\n        include fastcgi.conf;\n    }\n    location ~ .*\\.(gif|jpg|jpeg|png|bmp|swf)$\n    {\n        expires 30d;\n    }\n    location ~ .*\\.(js|css)?$\n    {\n        expires 1h;\n    }\n\n    error_log /var/log/zhuifanba.error.log;\n    access_log /var/log/zhuifanba.access.log;\n\n}\n")])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br")])])])}),[],!1,null,null,null);n.default=r.exports}}]);