(window.webpackJsonp=window.webpackJsonp||[]).push([[263],{616:function(a,s,t){"use strict";t.r(s);var e=t(0),n=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"查看帮助文档"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#查看帮助文档"}},[a._v("#")]),a._v(" 查看帮助文档")]),a._v(" "),s("p",[a._v("从帮助文档可以看出，包过滤的表达式一定要放在最后一个参数")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("       tcpdump "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-AbdDefhHIJKlLnNOpqStuUvxX")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ] [ -B buffer_size ]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" count "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--count")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" file_size "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-E")]),a._v(" spi@ipaddr algo:secret,"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-F")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-G")]),a._v(" rotate_seconds "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" interface "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" --immediate-mode "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-j")]),a._v(" tstamp_type "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-m")]),a._v(" module "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-M")]),a._v(" secret "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--number")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--print")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Q")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("out"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("|")]),a._v("inout "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-r")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-s")]),a._v(" snaplen "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-T")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("type")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--version")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-V")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-W")]),a._v(" filecount "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-y")]),a._v(" datalinktype "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-z")]),a._v(" postrotate-command "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Z")]),a._v(" user "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" --time-stamp-precision"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("tstamp_precision "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--micro")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--nano")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v(" expression "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h1",{attrs:{id:"列出所有网卡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#列出所有网卡"}},[a._v("#")]),a._v(" 列出所有网卡")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-D")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(".enp89s0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Up, Running, Connected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(".docker0 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Up, Running, Connected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v(".vetha051ecc "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Up, Running, Connected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v(".vethe67e03a "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Up, Running, Connected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(".vethc58c174 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Up, Running, Connected"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h1",{attrs:{id:"指定网卡-i"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定网卡-i"}},[a._v("#")]),a._v(" 指定网卡 -i")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" eth0\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"所有网卡"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#所有网卡"}},[a._v("#")]),a._v(" 所有网卡")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" any\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"不要域名解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#不要域名解析"}},[a._v("#")]),a._v(" 不要域名解析")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-n")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" any\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"指定主机"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定主机"}},[a._v("#")]),a._v(" 指定主机")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdoump "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".0.1\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"指定源ip或者目标ip"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定源ip或者目标ip"}},[a._v("#")]),a._v(" 指定源IP或者目标IP")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# 根据源IP过滤\ntcpdump src 192.168.3.2\n\n# 根据目标IP过滤\ntcpdump dst 192.168.3.2\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h1",{attrs:{id:"指定协议过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定协议过滤"}},[a._v("#")]),a._v(" 指定协议过滤")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump tcp\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"指定端口"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定端口"}},[a._v("#")]),a._v(" 指定端口")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 根据某个端口过滤")]),a._v("\ntcpdomp port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("33")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 根据源端口或者目标端口过滤")]),a._v("\ntcpdump dst port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("33")]),a._v("\ntcpdump src port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("33")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 根据端口范围过滤")]),a._v("\ntcpdump portrange "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v("-90\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("h1",{attrs:{id:"根据ip和地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#根据ip和地址"}},[a._v("#")]),a._v(" 根据IP和地址")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" ens33 tcp and "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".40.30\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"抓包结果写文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#抓包结果写文件"}},[a._v("#")]),a._v(" 抓包结果写文件")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" ens33 tcp and "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".40.30 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" log.pcap\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"每隔30秒写一个文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#每隔30秒写一个文件"}},[a._v("#")]),a._v(" 每隔30秒写一个文件")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("-G 30")]),a._v(" 表示每隔30秒写一个文件")]),a._v(" "),s("li",[a._v("文件名中的%实际上是时间格式")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" ens33 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-G")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v(" tcp and "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".40.30 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" %Y_%m%d_%H%M_%S.log.pcap\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"每达到30mb产生一个文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#每达到30mb产生一个文件"}},[a._v("#")]),a._v(" 每达到30MB产生一个文件")]),a._v(" "),s("ul",[s("li",[s("code",[a._v("-C 30")]),a._v(" 每达到30MB产生一个文件")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" ens33 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-C")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v(" tcp and "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("192.168")]),a._v(".40.30 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" log.pcap\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"指定抓包的个数"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#指定抓包的个数"}},[a._v("#")]),a._v(" 指定抓包的个数")]),a._v(" "),s("p",[a._v("在流量很大的网络上抓包，如果写文件的话，很可能将磁盘写满。所以最好指定一个最大的抓包个数，在达到包的个数后，自动退出。")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("tcpdump "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100000")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-i")]),a._v(" eth0 "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21.23")]),a._v(".3.2 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-w")]),a._v(" test.pcap\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"抓包文件太大-切割成小包"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#抓包文件太大-切割成小包"}},[a._v("#")]),a._v(" 抓包文件太大，切割成小包")]),a._v(" "),s("p",[a._v("把原来的包文件切割成20M大小的多个包")]),a._v(" "),s("div",{staticClass:"language-makefile line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-makefile"}},[s("code",[a._v("tcpdump -r old_file -w new_files -C 20\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"按照包长大小过滤"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#按照包长大小过滤"}},[a._v("#")]),a._v(" 按照包长大小过滤")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 包长小于某个值")]),a._v("\ntcpdump "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("less")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 包长大于某个值")]),a._v("\ntcpdump greater "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("h1",{attrs:{id:"按照16进制的方式显示包的内容"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#按照16进制的方式显示包的内容"}},[a._v("#")]),a._v(" 按照16进制的方式显示包的内容")]),a._v(" "),s("h1",{attrs:{id:"bpf-过滤规则"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#bpf-过滤规则"}},[a._v("#")]),a._v(" BPF 过滤规则")]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[a._v("port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v("\nsrc port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v("\ndest port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".3.4\nsrc "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".3.4\ndest "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".3.4\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("host")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1.2")]),a._v(".3.4 and port "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("53")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h1",{attrs:{id:"读取old-pcap文件-然后根据条件过滤-产生新的文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#读取old-pcap文件-然后根据条件过滤-产生新的文件"}},[a._v("#")]),a._v(" 读取old.pcap文件 然后根据条件过滤 产生新的文件")]),a._v(" "),s("p",[a._v("适用于从一个大的pcap文件中过滤出需要的包")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("tcpdump -r old.pcap -w new.pcap less 1280\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h1",{attrs:{id:"最佳实践"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#最佳实践"}},[a._v("#")]),a._v(" 最佳实践")]),a._v(" "),s("h2",{attrs:{id:"_1-关注-packets-dropped-by-kernel的值"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-关注-packets-dropped-by-kernel的值"}},[a._v("#")]),a._v(" 1. 关注 packets dropped by kernel的值")]),a._v(" "),s("p",[a._v("有时候，抓包停止后，tcpdump打印xxx个包drop by kernel。一旦这个值不为零，就要注意了。某些包并不是在网络中丢包了，而是在tcpdump这个工具给丢弃了。")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("60 packets captured\n279514 packets received by filter\n279368 packets dropped by kernel\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("p",[a._v("默认情况下，tcpdump抓包时会做dns解析，这个dns解析会降低tcpdump的处理速度，造成tcpdump的buffer被填满，然后就被tcpdump丢弃。")]),a._v(" "),s("p",[a._v("我们可以用两个方法解决这个问题")]),a._v(" "),s("ol",[s("li",[a._v("-B 指定buffer的大小，默认单位为kb。例如-B 1024")]),a._v(" "),s("li",[a._v("-n -nn 设置tcpdump 不要解析host地址，不要抓换协议和端口号")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("-n     Don't convert host addresses to names.  This can be used to avoid DNS lookups.\n\n-nn    Don't convert protocol and port numbers etc. to names either.\n\n-B buffer_size\n--buffer-size=buffer_size\n  Set the operating system capture buffer size to buffer_size, in units of KiB (1024 bytes).\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br")])]),s("h1",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[a._v("#")]),a._v(" 参考")]),a._v(" "),s("ul",[s("li",[a._v("https://serverfault.com/questions/131872/how-to-split-a-pcap-file-into-a-set-of-smaller-ones")]),a._v(" "),s("li",[a._v("http://alumni.cs.ucr.edu/~marios/ethereal-tcpdump.pdf")]),a._v(" "),s("li",[s("a",{attrs:{href:"https://www.yuque.com/attachments/yuque/0/2021/pdf/280451/1626588032882-a3eda373-8e1e-46be-9f97-5ad42473a6d9.pdf?_lake_card=%7B%22src%22%3A%22https%3A%2F%2Fwww.yuque.com%2Fattachments%2Fyuque%2F0%2F2021%2Fpdf%2F280451%2F1626588032882-a3eda373-8e1e-46be-9f97-5ad42473a6d9.pdf%22%2C%22name%22%3A%22ethereal-tcpdump.pdf%22%2C%22size%22%3A78412%2C%22type%22%3A%22application%2Fpdf%22%2C%22ext%22%3A%22pdf%22%2C%22status%22%3A%22done%22%2C%22taskId%22%3A%22u847a776e-8d93-4565-9217-1ea315a6320%22%2C%22taskType%22%3A%22upload%22%2C%22id%22%3A%22ua4c30b92%22%2C%22card%22%3A%22file%22%7D",target:"_blank",rel:"noopener noreferrer"}},[a._v("ethereal-tcpdump.pdf"),s("OutboundLink")],1)]),a._v(" "),s("li",[a._v("https://unix.stackexchange.com/questions/144794/why-would-the-kernel-drop-packets")])]),a._v(" "),s("p",[s("a",{attrs:{href:"https://wdd.js.org/network/wireshark/",target:"_blank",rel:"noopener noreferrer"}},[a._v("« PREV"),s("br"),a._v("\nWireshark抓包教程"),s("OutboundLink")],1),s("a",{attrs:{href:"https://wdd.js.org/network/httpry/",target:"_blank",rel:"noopener noreferrer"}},[a._v("NEXT »"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);