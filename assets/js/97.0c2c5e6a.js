(window.webpackJsonp=window.webpackJsonp||[]).push([[97],{450:function(s,a,t){"use strict";t.r(a);var n=t(0),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h3",{attrs:{id:"一、minio安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一、minio安装"}},[s._v("#")]),s._v(" 一、minio安装")]),s._v(" "),a("p",[s._v("minio下载")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v(" https://dl.minio.io/server/minio/release/linux-amd64/minio\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("minio安装")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("chmod")]),s._v(" +x minio "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mv")]),s._v(" minio /usr/local/bin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[s._v("查看版本")]),s._v(" "),a("p",[s._v("minio --version")]),s._v(" "),a("p",[s._v("创建minio工作目录和日志文件")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /data/minio/oss\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 minio 服务端工作目录")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /data/minio/log "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("touch")]),s._v(" /data/minio/log/minio.log\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 minio 服务端日志文件")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("p",[s._v("minio启动")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("nohup")]),s._v(" minio server "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--address")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("192.168")]),s._v(".99.1:9001 /data/minio/oss "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v(" /data/minio/log/minio.log "),a("span",{pre:!0,attrs:{class:"token operator"}},[a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("2")]),s._v(">")]),a("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[s._v("&1")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动 minio 服务器完毕后会将启动信息写入日志文件 /data/minio/log/minio.log ，配置信息写入隐藏的工作目录 /data/minio/oss/.minio.sys。")]),s._v("\n\n$ ll "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" /data/minio/oss/\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("41")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":26 "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(".")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("28")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":21 "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("\ndrwxr-xr-x "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("82")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(":22 .minio.sys\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("p",[s._v("minio登录")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/06/fe9052a955ff6de9.png",alt:"fe9052a955ff6de9.png"}})]),s._v(" "),a("p",[s._v("从 "),a("code",[s._v("/data/minio/oss/.minio.sys/config/config.json")]),s._v(" 找到登录秘钥。如下图所示：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cat")]),s._v(" /data/minio/oss/.minio.sys/config/config.json "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v(" python "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),s._v(" json.tool\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("h3",{attrs:{id:"自建仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#自建仓库"}},[s._v("#")]),s._v(" 自建仓库")]),s._v(" "),a("p",[s._v("创建helm仓库")]),s._v(" "),a("p",[s._v("浏览器登录 minio，点击右下角的“新增”按钮，选择 "),a("code",[s._v("Create bucket")]),s._v("：")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/06/95407ab174122f8d.png",alt:"95407ab174122f8d.png"}})]),s._v(" "),a("p",[s._v("填写 "),a("code",[s._v("Bucket Name")]),s._v(" 回车，创建 helm 仓库：")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/06/3a561749536d94ff.png",alt:"3a561749536d94ff.png"}})]),s._v(" "),a("p",[s._v("设置helm仓库权限")]),s._v(" "),a("p",[s._v("选择 "),a("code",[s._v("Edit policy")]),s._v(" 菜单：")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/06/9bc8683c433a08ad.png",alt:"9bc8683c433a08ad.png"}})]),s._v(" "),a("p",[s._v("在弹出框中选择 "),a("code",[s._v("Read and write")]),s._v(" ，然后点击“新增（Add）”按钮：")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/06/e5c2ca0717ea69f9.png",alt:"e5c2ca0717ea69f9.png"}})]),s._v(" "),a("h3",{attrs:{id:"添加私有仓库"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#添加私有仓库"}},[s._v("#")]),s._v(" 添加私有仓库")]),s._v(" "),a("p",[s._v("上面完成了私有仓库的创建。下一步就可以将 helm 跟私有仓库进行关联了。执行如下命令：")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意不要忘记私有仓库名 “helm-repo” ")]),s._v("\n$ helm repo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" minio http://192.168.99.1:9001/helm-repo\nError: looks like "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v('"http://192.168.99.1:9001/helm-repo"')]),s._v(" is not a valid chart repository or cannot be reached: failed to fetch http://192.168.99.1:9001/helm-repo/index.yaml "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" Not Found\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  执行报错，helm 3 认为创建的私有仓库无效，因为缺少 index.yaml 文件。执行命令生成 index.yaml 文件。")]),s._v("\n\n$ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("mkdir")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" /root/helm/repo \n$ helm repo index /root/helm/repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建 index.yaml 文件")]),s._v("\n$ ll /root/helm/repo/\n总用量 "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v("\n-rw-r--r-- "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(" root root "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("76")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("6")]),s._v("月  "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("14")]),s._v(":50 index.yaml\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("上传索引文件")]),s._v(" "),a("p",[s._v("登录 minio 服务器（"),a("a",{attrs:{href:"http://192.168.99.1:9001/",target:"_blank",rel:"noopener noreferrer"}},[s._v("http://192.168.99.1:9001"),a("OutboundLink")],1),s._v("）。选择 “上传文件（upload file）” 按钮，上传 index.yaml 文件。")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://pic.zzppjj.top/LightPicture/2023/06/e7751830bec87bdb.png",alt:"e7751830bec87bdb.png"}})]),s._v(" "),a("p",[s._v("关联私有仓库")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ helm repo "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("add")]),s._v(" minio http://192.168.99.1:9001/helm-repo\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注意不要忘写私有仓库名 helm-repo")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br")])]),a("p",[s._v("验证私有仓库")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("$ helm repo list\nNAME            URL\nstable          http://mirror.azure.cn/kubernetes/charts\naliyun          https://kubernetes.oss-cn-hangzhou.aliyuncs.com/charts\njetstack        https://charts.jetstack.io\nminio           http://192.168.99.1:9001/helm-repo\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("hr"),s._v(" "),a("p",[a("a",{attrs:{href:"https://www.cnblogs.com/lvzhenjiang/p/14878279.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("原文链接"),a("OutboundLink")],1)])])}),[],!1,null,null,null);a.default=e.exports}}]);