(window.webpackJsonp=window.webpackJsonp||[]).push([[361],{714:function(s,t,a){"use strict";a.r(t);var n=a(0),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"【0】解决思路分析"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【0】解决思路分析"}},[s._v("#")]),s._v(" 【0】解决思路分析")]),s._v(" "),t("p",[t("strong",[s._v("需求：我需要每天屏蔽某个时间段的某些告警项")])]),s._v(" "),t("p",[s._v("比如：凌晨4点会异地备份，导致流量报警，我想屏蔽每天4点-4点30分的该告警项")]),s._v(" "),t("p",[t("strong",[s._v("思路：")])]),s._v(" "),t("p",[t("strong",[s._v("直接操作是没有这个步骤的，曲线救国吧；")])]),s._v(" "),t("p",[s._v("（1）定时任务，每天凌晨四点的 silences")]),s._v(" "),t("p",[s._v("（2）定时任务中使用 alertmanager api 来建设")]),s._v(" "),t("h2",{attrs:{id:"【1】api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【1】api"}},[s._v("#")]),s._v(" 【1】API")]),s._v(" "),t("p",[s._v("官网："),t("a",{attrs:{href:"https://www.kancloud.cn/pshizhsysu/prometheus/1872669",target:"_blank",rel:"noopener noreferrer"}},[s._v("AlertManager的API · prometheus · 看云"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"api-version"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#api-version"}},[s._v("#")]),s._v(" API Version")]),s._v(" "),t("p",[s._v("AlertManager有两套API，v1与v2，不过两套API的内部逻辑基本是一致的，调用哪套都没有关系。v1没有相关的文档，不过我们可以找到v2的相关文档。"),t("br"),s._v("\nAPI-v2的swagger文件的链接为：")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/prometheus/alertmanager/blob/master/api/v2/openapi.yaml",target:"_blank",rel:"noopener noreferrer"}},[s._v("alertmanager/openapi.yaml at main · prometheus/alertmanager · GitHub"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("把这个文件的内容拷贝到 "),t("a",{attrs:{href:"https://editor.swagger.io/",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://editor.swagger.io"),t("OutboundLink")],1),s._v(" 里面，便可以查看API。下面罗列了v2版本的所有API：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Alert")]),s._v("\nGET    /api/v2/alerts\nPOST   /api/v2/alerts\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# AlertGroup")]),s._v("\nGET    /api/v2/alerts/groups  \n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# General")]),s._v("\nGET    /api/v2/status\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Receiver")]),s._v("\nGET    /api/v2/receivers\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Silence")]),s._v("\nGET    /api/v2/silences\nPOST   /api/v2/silences\nGET    /api/v2/silence/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("silenceID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\nDELETE /api/v2/silence/"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("silenceID"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("其中最重要的是Alert与AlertGroup的那三个API，接下来我们详细地讲解一下")]),s._v(" "),t("p",[s._v("使用其中提供的url："),t("strong",[s._v("http://127.0.0.1:9090/api/v1/alerts")]),s._v(" ，可以获取到报警的json信息，即可获得json的格式")]),s._v(" "),t("div",{staticClass:"language-context line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-context"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"annotations":\n'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"description":\n"localhost:9100 of job exporter has been down for more than 5 minutes.",\n"summary":"Instance localhost:9100 down"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n"endsAt":"2021-11-25T08:13:56.026Z",\n"fingerprint":"d44e90ffc89b2ea1",\n"receivers":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"mail"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',\n"startsAt":"2021-11-25T07:36:11.026Z",\n"status":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"inhibitedBy":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',"silencedBy":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',"state":"active"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n"updatedAt":"2021-11-25T16:09:56.030+08:00",\n"generatorURL":"http://localhost.localdomain:9090/graph?g0.expr=up+'),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('%3D%3D+0\\u0026g0.tab=1",')]),s._v('\n"labels":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"alertname":"InstanceDown","instance":"localhost:9100","job":"exporter","severity":"page"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br")])]),t("p",[s._v("编写好的json文件可以使用curl语句进行测试")]),s._v(" "),t("div",{staticClass:"language-context line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-context"}},[t("code",[s._v('curl -i -k -H "Content-type: application/json" -X POST -d\n'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"annotations":\n'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"description":\n"localhost:9100 of job exporter has been down for more than 5 minutes.",\n"summary":"Instance localhost:9100 down"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n"endsAt":"2021-11-25T08:13:56.026Z",\n"fingerprint":"d44e90ffc89b2ea1",\n"receivers":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"mail"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',\n"startsAt":"2021-11-25T07:36:11.026Z",\n"status":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"inhibitedBy":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',"silencedBy":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',"state":"active"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n"updatedAt":"2021-11-25T16:09:56.030+08:00",\n"generatorURL":"http://localhost.localdomain:9090/graph?g0.expr=up+'),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('%3D%3D+0\\u0026g0.tab=1",')]),s._v('\n"labels":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"alertname":"InstanceDown","instance":"localhost:9100","job":"exporter","severity":"page"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('\n"http://192.168.217.22:9093/api/v1/alerts"\n')])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br")])]),t("h3",{attrs:{id:"post-api-v2-alerts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#post-api-v2-alerts"}},[s._v("#")]),s._v(" "),t("code",[s._v("POST /api/v2/alerts")])]),s._v(" "),t("p",[s._v("Body参数示例如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"annotations"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"generatorURL"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"startsAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-01-01T00:00:00.000+08:00"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# optional")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"endsAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-01-01T01:00:00.000+08:00"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# optional")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br")])]),t("p",[s._v("Body参数是一个数组，里面是一个个的告警。其中startsAt与endsAt是可选参数，且格式必须是上面的那种，不能是时间戳。")]),s._v(" "),t("h3",{attrs:{id:"get-api-v2-alerts"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#get-api-v2-alerts"}},[s._v("#")]),s._v(" "),t("code",[s._v("GET /api/v2/alerts")])]),s._v(" "),t("p",[s._v("Query参数如下，以下参数用来过滤告警")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("参数名")]),s._v(" "),t("th",[s._v("类型")]),s._v(" "),t("th",[s._v("默认值")]),s._v(" "),t("th",[s._v("是否必须")]),s._v(" "),t("th",[s._v("其他说明")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("active")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("silenced")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("inhibited")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("unprocessed")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("filter")]),s._v(" "),t("td",[s._v("array[string]")]),s._v(" "),t("td",[s._v("无")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("receiver")]),s._v(" "),t("td",[s._v("string")]),s._v(" "),t("td",[s._v("无")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])])])]),s._v(" "),t("p",[s._v("其返回值如下：")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"labels"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"annotations"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"label"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"value"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"generatorURL"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"startsAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-01-01T00:00:00.000+08:00"')]),s._v(", \n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"endsAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-01-01T01:00:00.000+08:00"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"updatedAt"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2020-01-01T01:00:00.000+08:00"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"fingerprint"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"receivers"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"status"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"state"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"active"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# active, unprocessed, ...")]),s._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"silencedBy"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(",\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"inhibitedBy"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"string"')]),s._v(", "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v("."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"get-api-v2-alerts-groups"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#get-api-v2-alerts-groups"}},[s._v("#")]),s._v(" "),t("code",[s._v("GET /api/v2/alerts/groups")])]),s._v(" "),t("p",[s._v("Query参数如下，以下参数用来过滤告警")]),s._v(" "),t("table",[t("thead",[t("tr",[t("th",[s._v("参数名")]),s._v(" "),t("th",[s._v("类型")]),s._v(" "),t("th",[s._v("默认值")]),s._v(" "),t("th",[s._v("是否必须")]),s._v(" "),t("th",[s._v("其他说明")])])]),s._v(" "),t("tbody",[t("tr",[t("td",[s._v("active")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("silenced")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("inhibited")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("unprocessed")]),s._v(" "),t("td",[s._v("bool")]),s._v(" "),t("td",[s._v("true")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("filter")]),s._v(" "),t("td",[s._v("array[string]")]),s._v(" "),t("td",[s._v("无")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])]),s._v(" "),t("tr",[t("td",[s._v("receiver")]),s._v(" "),t("td",[s._v("string")]),s._v(" "),t("td",[s._v("无")]),s._v(" "),t("td",[s._v("optional")]),s._v(" "),t("td",[s._v("-")])])])]),s._v(" "),t("p",[s._v("其返回值如下：")]),s._v(" "),t("div",{staticClass:"language-context line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-context"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v(' \n    "labels": '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"label": "value", ...'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n    "receiver": '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name": "string"'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',  # 注意与alert的receivers的区别\n    "alerts": '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("alert1, alert2, ..."),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("  # alert的Json结构与 `GET /api/v2/alerts` 返回值中的结构一致\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  ...\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br")])]),t("h2",{attrs:{id:"【2】api使用实践"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【2】api使用实践"}},[s._v("#")]),s._v(" 【2】API使用实践")]),s._v(" "),t("p",[s._v("参考："),t("a",{attrs:{href:"https://www.kancloud.cn/pshizhsysu/prometheus/1874907",target:"_blank",rel:"noopener noreferrer"}},[s._v("实践：AlertManager · prometheus · 看云"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"_2-1-基本案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-基本案例"}},[s._v("#")]),s._v(" （2.1）基本案例")]),s._v(" "),t("p",[s._v("构造测试数据：")]),s._v(" "),t("div",{staticClass:"language-context line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-context"}},[t("code",[s._v("# 构造测试数据\n\naa='"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n        "Labels": '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n            "alertname": "NodeCpuPressure",\n            "IP": "192.168.2.101"\n        '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n        "Annotations": '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('\n            "summary": "NodeCpuPressure, IP: 192.168.2.101, Value: 90'),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('%, Threshold: 85%"')]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(',\n        "StartsAt": "2020-02-17T23:00:00.000+08:00", \n        "EndsAt": "2023-02-18T23:00:00.000+08:00"\n    '),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("'\n\n# 执行 POST\ncurl http://127.0.0.1:9093/api/v2/alerts -XPOST -H'Content-Type: application/json' -d\"$aa\"\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br")])]),t("p",[s._v("如果是使用V1版本，可以不用加  "),t("strong",[s._v("-H'Content-Type: application/json'")])]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317170106813-275993103.png",alt:""}})]),s._v(" "),t("p",[s._v("怎么取消掉？把结束时间修改一下就好了；")]),s._v(" "),t("p",[s._v("我们可以通过  "),t("strong",[s._v("curl -X GET localhost:9093/api/v2/alerts")]),s._v("  获取")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317171817241-1167958971.png",alt:""}})]),s._v(" "),t("p",[s._v("然后修改其时间")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317171703148-1162929347.png",alt:""}})]),s._v(" "),t("p",[s._v("然后我们在上述的"),t("strong",[s._v("操作前：")])]),s._v(" "),t("p",[s._v("活跃且没被静默的 Alert")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317171918415-359987565.png",alt:""}})]),s._v(" "),t("p",[s._v("操作后：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317171955730-1721135518.png",alt:""}})]),s._v(" "),t("p",[t("a",{attrs:{href:"https://www.cnblogs.com/gered/p/15946822.html#_labelTop",target:"_blank",rel:"noopener noreferrer"}},[s._v("回到顶部"),t("OutboundLink")],1)]),s._v(" "),t("h2",{attrs:{id:"【3】最佳实践-定时静默"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#【3】最佳实践-定时静默"}},[s._v("#")]),s._v(" 【3】最佳实践（定时静默）")]),s._v(" "),t("p",[s._v("注意，静默条目所生成、显示的时间是UTC时间")]),s._v(" "),t("h3",{attrs:{id:"_3-1-立马构造出故障的告警信息"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-1-立马构造出故障的告警信息"}},[s._v("#")]),s._v(" （3.1）立马构造出故障的告警信息")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317154202436-1188521351.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317154357709-1494474288.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317154435726-1647233958.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"_3-2-构建好静默-获取静默语句"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-2-构建好静默-获取静默语句"}},[s._v("#")]),s._v(" （3.2）构建好静默，获取静默语句")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317154725827-954969462.png",alt:""}})]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317154912493-1232898288.png",alt:""}})]),s._v(" "),t("p",[s._v("最终结果：")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317162639233-279360153.png",alt:""}})]),s._v(" "),t("div",{staticClass:"language-context line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-context"}},[t("code",[s._v("curl '127.0.0.1:9093/api/v2/silences' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Connection: keep-alive' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/98.0.4758.102 Safari/537.36' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Content-Type: application/json' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Accept: */*' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Origin: http://127.0.0.1:9093' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Referer: http://127.0.0.1:9093/' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Accept-Language: zh-CN,zh;q=0.9' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  -H 'Cookie: grafana_session=a504e4a78501efe7009fa8b7587d5fb4' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  --data-raw '"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"matchers":'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"alertname","value":"磁盘读吞吐过高","isRegex":false'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"instance","value":"127.0.0.1:9182","isRegex":false'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"job","value":"测试_win","isRegex":false'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"name","value":"测试数据库鸭'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("47.103.57.124"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v('","isRegex":false'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(","),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v('"name":"severity","value":"warning","isRegex":false'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(',"startsAt":"2022-03-17T07:44:45.446Z","endsAt":"2022-03-17T09:44:45.446Z","createdBy":"guochaoqun","comment":"tmp","id":null'),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("' "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  --compressed "),t("span",{pre:!0,attrs:{class:"token function selector"}},[s._v("\\\n")]),s._v("  --insecure\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br")])]),t("h3",{attrs:{id:"_3-3-使用生成静默规则"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-3-使用生成静默规则"}},[s._v("#")]),s._v(" （3.3）使用生成静默规则")]),s._v(" "),t("p",[s._v("V1方式")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-X")]),s._v(" POST http://127.0.0.1:9093/api/v1/silences -d"),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"matchers":[{"name":"alertname","value":"磁盘读吞 吐过高","isRegex":false},{"name":"instance","value":"47.103.57.124:9182","isRegex":false},{"name":"job","value":"test","isRegex":false},{"name":"name","value":"test库[47.103.57.124]","isRegex":false},{"name":"severity","value":"warning","isRegex":false}],"startsAt":"2022-03-17T07:44:45.446Z","endsAt":"2022-03-17T09:44:45.446Z","createdBy":"guochaoqun","comment":"tmp","id":null}\'')]),s._v(" \n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("V2 方式，就必须要加 -H")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'127.0.0.1:9093/api/v2/silences'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("-H "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--data")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"matchers":[{"name":"alertname","value":"磁盘读吞吐过高","isRegex":false},{"name":"instance","value":"127.0.0.1:9182","isRegex":false},{"name":"job","value":"测试_win","isRegex":false},{"name":"name","value":"测试库[47.103.57.124]","isRegex":false},{"name":"severity","value":"warning","isRegex":false}],"startsAt":"2022-03-17T07:44:45.446Z","endsAt":"2022-03-17T09:44:45.446Z","createdBy":"guochaoqun","comment":"tmp","id":null}\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--compressed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--insecure")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br")])]),t("p",[t("img",{attrs:{src:"https://img2022.cnblogs.com/blog/1302413/202203/1302413-20220317165445176-551648917.png",alt:""}})]),s._v(" "),t("h3",{attrs:{id:"_3-4-自动化脚本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-4-自动化脚本"}},[s._v("#")]),s._v(" （3.4）自动化脚本")]),s._v(" "),t("div",{staticClass:"language-bash line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("now_date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("date")]),s._v(" +%F "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--date")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"-1 day"')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("`")])]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("curl")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'http://127.0.0.1:9093/api/v2/silences'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-H")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'Content-Type: application/json'")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--data")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'{"matchers":[{"name":"alertname","value":"磁盘读吞吐过高","isRegex":false},{"name":"instance","value":"47.103.57.124:9182","isRegex":false},{"name":"job","value":"金游世界_win","isRegex":false},{"name":"name","value":"8833主库_详细对局[47.103.57.124]","isRegex":false},{"name":"severity","value":"warning","isRegex":false}],"startsAt":"\'')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${now_date}")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'T20:10:45.446Z","endsAt":"\'')]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("${now_date}")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('\'T20:40:45.446Z","createdBy":"guochaoqun","comment":"tmp","id":null}\'')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("\\")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--compressed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--insecure")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br")])]),t("p",[s._v("原文链接：")]),s._v(" "),t("p",[s._v("https://www.cnblogs.com/gered/p/15946822.html")])])}),[],!1,null,null,null);t.default=e.exports}}]);